!function(a){function b(a,b,c,d){function e(){f.insertBefore(b,g)}var f=b.parentNode,g=b.nextSibling;if(!f)return void d.call(a,b);f.removeChild(b),"boolean"!=typeof c&&(d=c,c=!1),d&&c?d.call(a,b,e):d&&(d.call(a,b),e())}EdenUI.Highlight=function(a,b){this.ast=void 0,this.outelement=a,this.line=1,this.currentline=-1,this.mode_at_line={},this.heredocend=void 0,this.scrolltop=-1,this.token=void 0,this.prevtoken=void 0,this.modestack=[],this.linestack=void 0,this.outerline=void 0,this.lineelement=void 0,this.startmode=b&&b.start?b.start:"START",this.styles=b&&b.styles?b.styles:EdenUI.Highlight.defaultStyles,this.clearmodes=b&&b.clearmodes?b.clearmodes:EdenUI.Highlight.lineclearmode,this.mode=this.startmode,this.incomment=!1,this.brline=b&&b.brline,this.styleExtensions={},this.metrics={}},EdenUI.Highlight.defaultStyles={comment:"eden-comment","hidden-comment":"eden-comment-hidden",operator:"eden-operator",observable:"eden-observable",storage:"eden-storage",number:"eden-number",string:"eden-string",constant:"eden-constant",parameter:"eden-parameter",keyword:"eden-keyword",javascript:"eden-javascript",selector:"eden-selector",selector2:"eden-selector2",selector3:"eden-selector3",function:"eden-function",type:"eden-type",special:"eden-special",backticks:"eden-backticks",doxycomment:"eden-doxycomment",pathblock:"eden-pathblock","comment-h1":"eden-comment-h1","comment-h2":"eden-comment-h2","comment-h3":"eden-comment-h3","comment-h4":"eden-comment-h4","horizontal-line":"eden-section-line","comment-line":"eden-comment-line","comment-emph":"eden-comment-emph","comment-bold":"eden-comment-bold","script-line":"eden-line-script",doxytag:"eden-doxytag","comment-query":"eden-comment-query","block-comment":"eden-blockcomment","comment-ul":"eden-comment-ul","comment-blockquote":"eden-comment-blockquote",script:"eden-script",notexist:"eden-notexist"},EdenUI.Highlight.prototype.pushLine=function(){this.linestack.push(this.lineelement)},EdenUI.Highlight.prototype.pushMode=function(){this.modestack.push(this.mode)},EdenUI.Highlight.prototype.popLine=function(){this.linestack.length>0&&(this.lineelement=this.linestack.pop())},EdenUI.Highlight.prototype.popMode=function(){this.modestack.length>0&&(this.mode=this.modestack.pop())},EdenUI.Highlight.prototype.setScrollTop=function(a){this.scrolltop=a},EdenUI.Highlight.isType=function(a){return!1},EdenUI.Highlight.lineclearmode={COMMENT:!0,SECTION_TITLE:!0,SECTION_TITLE2:!0,SECTION_TITLE3:!0,SECTION_TITLE4:!0,SECTION_TITLE_H1:!0,SECTION_TITLE_H2:!0,SECTION_TITLE_H3:!0,SECTION_TITLE_H4:!0,COMMENT_BOLD:!0,COMMENT_CODE:!0,COMMENT_ICON:!0,COMMENT_EMPH:!0,COMMENT_ITALIC:!0,COMMENT_BOLD_END:!0,COMMENT_QUERY:!0,END_COMMENT_TAG:!0,COMMENT_TAG:!0,COMMENT_LINK:!0,COMMENT_LINK_END:!0,COMMENT_HTML:!0,COMMENT_HTML_START:!0,COMMENT_HTML_CONTENT:!0,COMMENT_ATTRS:!0},EdenUI.Highlight.prototype.applyClasses=function(a,b){for(var c=b||this.classes,d="",e=0;e<c.length;e++)if(d+=this.styles[c[e]]+" ",this.styleExtensions[c[e]]){var f=this.styleExtensions[c[e]];for(var g in f)this.applyAttribute(a,g,f[g])}a.className=d.trim()},EdenUI.Highlight.prototype.generateClasses=function(){for(var a="",b=0;b<this.classes.length;b++)a+=this.styles[this.classes[b]]+" ";return a.trim()},EdenUI.Highlight.prototype.highlightLine=function(a,b){var c=-1,d=-1,e=!1,f=a.stream;this.stream=f;var g="INVALID",h="INVALID";this.outerline="eden-line",this.linestack=[],this.mode_at_line[this.line-1]?this.mode=this.mode_at_line[this.line-1]:this.mode=this.startmode,this.clearmodes[this.mode]&&(this.incomment=!1,this.mode=this.startmode),a.script&&a.script.errors.length>0&&(c=a.script.errors[0].prevposition,d=a.script.errors[0].position,a.script.errors[0].messageText());var i="",j=document.createElement("div");for(j.className=this.styles["script-line"];;){if(f.position==b){if(""!=i){var k=document.createTextNode(i);j.appendChild(k),i=""}var l=document.createElement("span");l.className="fake-caret",j.appendChild(l);for(var m=j;m&&"DIV"!=m.nodeName;)m=m.parentNode;m&&m.className.startsWith(this.styles["comment-line"])&&(m.className+=" current")}var n=f.peek();if(10==n||13==n){if(""!=i){if(j.lastChild&&j.lastChild.className!=this.styles["hidden-comment"]&&"fake-caret"!=j.lastChild.className)if(j.lastChild.lastChild&&"#text"==j.lastChild.lastChild.nodeName)j.lastChild.lastChild.textContent+=i;else{var k=document.createTextNode(i);j.lastChild.appendChild(k)}else{var k=document.createTextNode(i);j.appendChild(k)}i=""}break}if(9!=n&&13!=n&&32!=n&&160!=n){if(""!=i){if(j.lastChild&&j.lastChild.className!=this.styles["hidden-comment"]&&"fake-caret"!=j.lastChild.className)if(j.lastChild.lastChild&&"#text"==j.lastChild.lastChild.nodeName)j.lastChild.lastChild.textContent+=i;else{var k=document.createTextNode(i);j.lastChild.appendChild(k)}else{var k=document.createTextNode(i);j.appendChild(k)}i=""}if(h=g,g=f.readToken(this.incomment),"string"!=typeof g&&console.error("Token error: line = "+this.line+" position = "+f.position),"EOF"==g){if(""!=i){if(j.lastChild&&j.lastChild.className!=this.styles["hidden-comment"]&&"fake-caret"!=j.lastChild.className)if(j.lastChild.lastChild&&"#text"==j.lastChild.lastChild.nodeName)j.lastChild.lastChild.textContent+=i;else{var k=document.createTextNode(i);j.lastChild.appendChild(k)}else{var k=document.createTextNode(i);j.appendChild(k)}i=""}break}if("INVALID"!=g)if(this.token=g,this.prevtoken=h,this.type=f.tokenType(g),this.classes=[],this.tokentext=f.tokenText(),this.lineelement=j,-1!=c&&(c<=f.prevposition&&!e&&(e=!0),d<=f.prevposition&&e&&(e=!1),e&&!0),e&&"EOF"!=a.script.errors[0].token&&this.classes.push("error"),void 0===this[this.mode]&&console.error("No Mode",this.mode),this[this.mode].call(this),j=this.lineelement,f.prevposition<b&&f.position>b){var l=b-f.prevposition,o=this.tokentext.slice(0,l),p=this.tokentext.slice(l),q=document.createElement("span");this.applyClasses(q);var r=document.createElement("span");r.appendChild(document.createTextNode(o)),q.appendChild(r);var l=document.createElement("span");l.className="fake-caret",q.appendChild(l),r=document.createElement("span"),r.appendChild(document.createTextNode(p)),q.appendChild(r),j.appendChild(q);for(var m=j;m&&"DIV"!=m.nodeName;)m=m.parentNode;m&&m.className.startsWith(this.styles["comment-line"])&&(m.className+=" current")}else if(j.lastChild&&j.lastChild.className==this.generateClasses()){var r=j.lastChild;r.lastChild&&"#text"==r.lastChild.nodeName?r.lastChild.textContent+=this.tokentext:r.appendChild(document.createTextNode(this.tokentext))}else{var r=document.createElement("span");this.applyClasses(r),r.appendChild(document.createTextNode(this.tokentext)),j.appendChild(r)}else console.log("INVALID: "+f.peek()),f.skip()}else f.skip(),32==n||160==n?i+=" ":13!=n&&(i+=String.fromCharCode(n))}return this.linestack.length>0&&(j=this.linestack[0]),this.mode_at_line[this.line]=this.mode,j},EdenUI.Highlight.prototype.updateAST=function(a){this.ast=a,this.errstart=-1,this.errend=-1,this.errmsg="",this.inerror=!1,this.stream=a.stream,this.stream.reset(),this.title="",a.script&&a.script.errors.length>0&&(this.errstart=a.script.errors[0].prevposition,this.errend=a.script.errors[0].position,this.errmsg=a.script.errors[0].messageText())},EdenUI.Highlight.prototype.highlightAll=function(a,c){var d=void 0,e=!1,f=0,g=this.stream;this.metrics={},this.styleExtensions={},b(this,this.outelement,!1,function(){for(;this.outelement.lastChild;)this.outelement.removeChild(this.outelement.lastChild);for(this.mode_at_line={};g.valid();){var b=g.peek();if(10!=b&&13!=b)if(this.disablehl||this.scrolltop>=0&&(this.line<this.scrolltop-105||this.line>this.scrolltop+105)){var h,i=g.code.indexOf("\n",g.position);-1==i?(h=g.code.substring(g.position),g.position=g.code.length):(h=g.code.substring(g.position,i),g.position=i),d=document.createTextNode(h),this.disablehl||"#"!=h.trim().charAt(0)||(this.outerline="eden-line eden-wrapline")}else d=this.highlightLine(this.ast,a);else{e=f<=this.errstart&&g.position>=this.errend;var j=document.createElement("div");j.className=this.outerline,c&&c.spacing&&c.spacing[this.line]&&(j.height=c.spacing[this.line]+"px"),j.setAttribute("data-line",this.line-1),this.line++,void 0===d&&this.brline&&(d=document.createElement("br")),void 0!==d?j.appendChild(d):this.mode_at_line[this.line-1]=this.mode;var k=document.createTextNode("\n");j.appendChild(k),this.outelement.appendChild(j),f=g.position+1,d=void 0,g.skip(),13==b&&g.skip(),this.outerline="eden-line"}}if(e=f<=this.errstart&&g.position>=this.errend,void 0===d&&this.brline&&(d=document.createElement("br")),void 0!==d){var j=document.createElement("div");j.className="eden-line",j.style.height=(c&&c.spacing&&c.spacing[this.line]?c.spacing[this.line]:20)+"px",j.setAttribute("data-line",this.line-1),j.appendChild(d),this.outelement.appendChild(j)}else{var j=document.createElement("div");if(a>=g.position){j.className="eden-line",j.style.height=(c&&c.spacing&&c.spacing[this.line]?c.spacing[this.line]:20)+"px",j.setAttribute("data-line",this.line-1);var l=document.createElement("span");l.className="fake-caret",j.appendChild(l)}else j.className="eden-line";this.outelement.appendChild(j)}})},EdenUI.Highlight.prototype.highlightOpt=function(a,b,c){for(var d=void 0,e=0,f=this.stream;f.valid()&&this.line<a-1;){var g=f.peek();10!=g&&13!=g||this.line++,f.skip(),13==g&&f.skip()}for(var h=2;h>=0;h--){this.line=a-h+1,this.metrics[this.line]&&delete this.metrics[this.line];var i=this.outelement.childNodes[a-h];if(void 0!==i){for(;i.lastChild;)i.removeChild(i.lastChild);if(e=f.position,this.disablehl){var j,k=f.code.indexOf("\n",f.position);if(-1==k?(j=f.code.substring(f.position),f.position=f.code.length):(j=f.code.substring(f.position,k),f.position=k),e<b&&f.position>b){var l=b-e,m=j.slice(0,l),n=j.slice(l),o=document.createElement("span"),p=document.createTextNode(m);o.appendChild(p);var l=document.createElement("span");l.className="fake-caret",o.appendChild(l);var q=document.createTextNode(n);o.appendChild(q),d=o}else d=document.createTextNode(j)}else d=this.highlightLine(this.ast,b);e<=this.errstart&&f.position>=this.errend,i.appendChild(d),i.className=this.outerline;var g=f.peek(),r=document.createTextNode("\n");i.appendChild(r),f.skip(),13==g&&f.skip()}}if(!this.disablehl)for(;void 0!==this.mode_at_line[this.line+1]&&this.mode_at_line[this.line]!=this.mode_at_line[this.line+1];){this.line++,this.metrics[this.line]&&delete this.metrics[this.line];var i=this.outelement.childNodes[this.line-1];if(void 0!==i){for(;i.lastChild;)i.removeChild(i.lastChild);e=f.position,d=this.highlightLine(this.ast,b),e<=this.errstart&&f.position>=this.errend,i.appendChild(d),i.className=this.outerline;var g=f.peek(),r=document.createTextNode("\n");i.appendChild(r),f.skip(),13==g&&f.skip()}}},EdenUI.Highlight.prototype.highlight=function(a,b,c,d){if(this.ast=a,this.updateAST(a),this.line=1,void 0!==this.outelement)return 0==a.stream.code.length?void(this.outelement&&(this.outelement.innerHTML="<div class='eden-line'><span class='fake-caret'></span></div>")):(this.disablehl=!(!d||!d.disabled),-1==b?this.highlightAll(c,d):this.highlightOpt(b,c,d))},EdenUI.Highlight.html=function(a,b,c){var d=document.createElement("div"),e=new EdenUI.Highlight(d);if(e.ast={stream:new EdenStream(a)},e.highlight(e.ast,-1,-1,void 0),b)return d.childNodes[0].innerHTML;for(var f="",g=0;g<d.childNodes.length;g++)f+=d.childNodes[g].innerHTML;return c?'<div style="display: flex; align-items: center;"><div class="eden-hl-play" data-src="'+a+'">&#xf04b;</div><div>'+f+"</div></div>":f}}("undefined"!=typeof window?window:global);var edenFunctions={apply:!0,array:!0,canvasURL:!0,centroid:!0,char:!0,charCode:!0,choose:!0,compose:!0,concat:!0,curry:!0,decodeHTML:!0,definitionOf:!0,definitionRHS:!0,doDefault:!0,edenCode:!0,escapeRE:!0,foldl:!0,foldr:!0,hasProperty:!0,hslColour:!0,htmlBulletList:!0,htmlNumberedList:!0,positionInList:!0,positionOfRE:!0,substringPosition:!0,int:!0,isBoolean:!0,isCallable:!0,isChar:!0,isDefined:!0,isDependency:!0,isDependent:!0,isFunc:!0,isInt:!0,isList:!0,isNaN:!0,isNumber:!0,isObject:!0,isPoint:!0,isPointer:!0,isProc:!0,isString:!0,isValue:!0,distanceMoved:!0,angleTurned:!0,List:!0,listcat:!0,lookup:!0,lowercase:!0,map:!0,mapPartial:!0,max:!0,Menu:!0,MenuItem:!0,min:!0,mod:!0,nameof:!0,partApply:!0,Point:!0,pow:!0,properties:!0,randomBoolean:!0,randomFloat:!0,randomInteger:!0,RE:!0,replaceFirst:!0,reverse:!0,rgbColour:!0,rotatePoint:!0,round:!0,roundMultiple:!0,scalePoint:!0,search:!0,sequenceItoJ:!0,sequenceN:!0,sequenceArithmeticN:!0,sequenceList:!0,sequencePrevious:!0,sort:!0,str:!0,sqrt:!0,strcat:!0,sublist:!0,substitute:!0,substr:!0,sum:!0,tail:!0,trim:!0,type:!0,uppercase:!0,include_css:!0,html:!0,time:!0,execute:!0,Text:!0,textWidth:!0,textHeight:!0,Arc:!0,Curve:!0,FillPattern:!0,Ellipse:!0,Line:!0,LinearGradient:!0,LineSequence:!0,PixelList:!0,GreyPixelList:!0,Rectangle:!0,RotateAboutCentre:!0,RotateAboutPoint:!0,CombinedRotation:!0,Scale:!0,Translate:!0,RoundedRectangle:!0,Polygon:!0,RegularPolygon:!0,Sector:!0,Shadow:!0,Circle:!0,Button:!0,Checkbox:!0,Div:!0,Image:!0,imageWithZones:!0,HTMLImage:!0,RadioButtons:!0,Slider:!0,Textbox:!0,DropDownList:!0,Combobox:!0,BulletSlide:!0,Video:!0,Audio:!0,Slide:!0,TitledSlide:!0,TitleSlide:!0,cos:!0,sin:!0,tan:!0,abs:!0,acos:!0,asin:!0,atan:!0,ceil:!0,roundUp:!0,exp:!0,floor:!0,roundDown:!0,log:!0,random:!0,forget:!0,forgetAll:!0,shapeOnTopAt:!0,zoneOnTopAt:!0,observableOnTopAt:!0,shapeOnBottomAt:!0,zoneOnBottomAt:!0,observableOnBottomAt:!0,shapesAt:!0,zonesAt:!0,observablesAt:!0,observableForShape:!0,alias:!0,arrangeWindows:!0,attemptMouseCapture:!0,bindCSSNumericProperty:!0,bindCSSProperty:!0,bindCSSRule:!0,createCanvas:!0,createHTMLView:!0,createProjectList:!0,createView:!0,destroyView:!0,eager:!0,error:!0,hideView:!0,highlightView:!0,moveView:!0,patch:!0,removeedenclock:!0,resizeView:!0,setedenclock:!0,showObservables:!0,showView:!0,stopHighlightingView:!0,todo:!0,touch:!0,unbind:!0,withAppendedItem:!0,writeln:!0},edenSpecials={autocalc:!0,mouseX:!0,mouseY:!0,mousePosition:!0,screenHeight:!0,screenWidth:!0,PI:!0},edenValues={true:!0,false:!0,green:!0},jskeywords={var:!0,if:!0,while:!0,typeof:!0,this:!0,function:!0,return:!0,else:!0,break:!0,continue:!0,switch:!0,for:!0,prototype:!0};EdenUI.Highlight.prototype.START=function(){switch(this.token){case"##":"INVALID"==this.prevtoken?(this.classes.push("hidden-comment"),this.mode="SECTION_TITLE",this.applyClasses(this.lineelement,["comment-line"]),32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):(this.classes.push("comment"),this.mode="COMMENT");break;case"#":if("INVALID"==this.prevtoken||";"==this.prevtoken){var a=33==this.stream.peek();a&&(this.tokentext+="!",this.stream.position++),this.classes.push("hidden-comment"),this.mode="COMMENT",this.incomment=!0,"INVALID"==this.prevtoken&&(this.lineelement.style.marginLeft="0");var b=document.createElement("div");this.applyClasses(b,a?["comment-line","doxycomment"]:["comment-line"]),this.pushLine(),this.lineelement.appendChild(b),this.lineelement=b,32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)}else this.classes.push("operator");break;case"local":case"para":case"handle":case"oracle":case"auto":this.classes.push("storage");break;case"NUMBER":this.classes.push("number");break;case"STRING":this.classes.push("string");break;case"BOOLEAN":this.classes.push("constant");break;case"CHARACTER":this.classes.push("string");break;case"import":case"do":this.classes.push("keyword"),this.pushMode(),this.mode="SELECTOR";break;case"${{":this.classes.push("javascript"),this.mode="JAVASCRIPT";break;case"?":this.classes.push("selector"),this.pushMode(),this.mode="SELECTOR";break;case"<<":var c=(this.stream.readToken(),this.stream.tokenText());this.tokentext+=c,this.heredocend=c,this.classes.push("storage"),this.mode="HEREDOC";break;case"OBSERVABLE":edenFunctions[this.stream.data.value]?this.classes.push("function"):EdenUI.Highlight.isType(this.stream.data.value)?this.classes.push("type"):edenValues[this.stream.data.value]?this.classes.push("constant"):edenSpecials[this.stream.data.value]?this.classes.push("special"):"$"==this.stream.data.value.charAt(0)?this.classes.push("parameter"):(this.classes.push("observable"),Eden.Index.name_index.hasOwnProperty(this.stream.data.value)||eden.root.symbols.hasOwnProperty(this.stream.data.value)||this.classes.push("notexist"));break;case"`":this.pushMode(),this.mode="BACKTICK",this.pushLine();var b=document.createElement("span");this.applyClasses(b,["backticks"]),this.lineelement.appendChild(b),this.lineelement=b;break;default:"keyword"==this.type?this.classes.push("keyword"):"-"==this.token&&this.stream.isNumeric(this.stream.peek())?(this.token=this.stream.readToken(),this.tokentext="-"+this.stream.tokenText(),this.classes.push("number")):"/*"==this.token?42==this.stream.peek()?(this.mode="DOXY_COMMENT",this.classes.push("block-comment")):(this.mode="BLOCK_COMMENT",this.classes.push("block-comment")):this.classes.push("operator")}},EdenUI.Highlight.prototype.BACKTICK=function(){"`"==this.token?this.mode="ENDBACKTICK":"}"==this.token?(this.popMode(),this.classes.push("operator")):this.START()},EdenUI.Highlight.prototype.ENDBACKTICK=function(){this.popLine(),this.popMode(),this.START()},EdenUI.Highlight.prototype.SELECTOR=function(){this.pushLine();var a=document.createElement("span");this.applyClasses(a,["pathblock"]),this.lineelement.appendChild(a),this.lineelement=a,this.mode="SELECTOR2",this.SELECTOR2()},EdenUI.Highlight.prototype.SELECTOR2=function(){"{"==this.token?(this.classes.push("operator"),this.pushMode(),this.mode=this.startmode):"["==this.token?(this.classes.push("selector"),this.mode="SELECTOR_TYPES"):";"==this.token||"="==this.token||"+="==this.token||"//="==this.token?(this.popLine(),this.classes.push("operator"),this.popMode()):"::"==this.token||"with"==this.token?(this.popLine(),this.classes.push("keyword"),this.popMode()):"OBSERVABLE"!=this.token||"."!=this.prevtoken&&":"!=this.prevtoken||!Eden.Selectors.PropertyNode.attributes[this.tokentext]&&!Eden.Selectors.PropertyNode.pseudo[this.tokentext]?this.classes.push("selector"):this.classes.push("selector2")},EdenUI.Highlight.prototype.SELECTOR_TYPES=function(){"OBSERVABLE"==this.token&&Eden.Selectors.resultTypes[this.tokentext]?this.classes.push("selector3"):"]"==this.token?(this.classes.push("selector"),this.mode="SELECTOR2"):this.classes.push("selector")},EdenUI.Highlight.prototype.JAVASCRIPT=function(){this.classes.push("javascript"),"}}$"==this.token&&(this.mode=this.startmode)},EdenUI.Highlight.prototype.HEREDOC=function(){"INVALID"==this.prevtoken&&this.tokentext==this.heredocend?(this.classes.push("storage"),this.mode=this.startmode):this.classes.push("string")},EdenUI.Highlight.prototype.SECTION_TITLE=function(){"#"==this.token?(this.classes.push("hidden-comment"),this.applyClasses(this.lineelement,["comment-line","comment-h2"]),this.mode="COMMENT",32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):"##"==this.token?(this.classes.push("hidden-comment"),this.mode="SECTION_TITLE3",32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):(this.applyClasses(this.lineelement,["comment-line","comment-h1"]),this.mode="COMMENT",this.COMMENT())},EdenUI.Highlight.prototype.SECTION_TITLE2=function(){"#"==this.token?(this.classes.push("hidden-comment"),this.mode="SECTION_TITLE3",32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):(this.classes.push("comment-h2"),this.mode="SECTION_TITLE_H2")},EdenUI.Highlight.prototype.SECTION_TITLE3=function(){"#"==this.token?(this.classes.push("hidden-comment"),this.applyClasses(this.lineelement,["comment-line","comment-h4"]),this.mode="COMMENT",32==this.stream.peek()&&(this.tokentext+=" ",this.stream.position++)):(this.applyClasses(this.lineelement,["comment-line","comment-h3"]),this.mode="COMMENT",this.COMMENT())},EdenUI.Highlight.prototype.SECTION_TITLE4=function(){this.classes.push("comment-h4"),this.mode="SECTION_TITLE_H4"},EdenUI.Highlight.prototype.SECTION_TITLE_H1=function(){this.classes.push("comment-h1")},EdenUI.Highlight.prototype.SECTION_TITLE_H2=function(){this.classes.push("comment-h2")},EdenUI.Highlight.prototype.SECTION_TITLE_H3=function(){this.classes.push("comment-h3")},EdenUI.Highlight.prototype.SECTION_TITLE_H4=function(){this.classes.push("comment-h4")},EdenUI.Highlight.prototype.BLOCK_COMMENT=function(){switch(this.token){case"*/":this.mode=this.startmode,this.classes.push("block-comment");break;default:this.classes.push("block-comment")}},EdenUI.Highlight.prototype.COMMENT=function(){switch(this.token){case"@":case"#":this.mode="COMMENT_TAG",this.pushLine();var a=document.createElement("span");this.applyClasses(a,["doxytag"]),this.lineelement.appendChild(a),this.lineelement=a;break;case"-":case"*":if("##"!=this.prevtoken&&"#"!=this.prevtoken&&"INVALID"!=this.prevtoken||32!=this.stream.peek()&&9!=this.stream.peek())"-"!=this.token?(this.pushMode(),this.mode="COMMENT_EMPH",this.classes.push("hidden-comment")):this.classes.push("comment");else{this.pushLine();var a=document.createElement("span");this.applyClasses(a,["comment-ul"]),this.lineelement.appendChild(a),this.lineelement=a,this.classes.push("hidden-comment")}break;case"--":if(45==this.stream.peek()){for(this.outerline="eden-line eden-section-line";45==this.stream.peek();)this.tokentext+="-",this.stream.position++;this.classes.push("hidden-comment")}else this.classes.push("comment");break;case"[":if(32!=this.stream.peek()){this.pushMode(),this.mode="COMMENT_LINK",this.pushLine();var a=document.createElement("span");this.lineelement.appendChild(a),this.lineelement=a,this.classes.push("hidden-comment")}else this.classes.push("comment");break;case"!":91==this.stream.peek()?(this.mode="COMMENT_IMAGE",this.tokentext+="[",this.stream.position++,this.classes.push("hidden-comment")):this.classes.push("comment");break;case"$":91==this.stream.peek()?(this.pushMode(),this.mode="COMMENT_BUTTON",this.tokentext+="[",this.stream.position++,this.classes.push("hidden-comment")):this.classes.push("comment");break;case">":"##"!=this.prevtoken&&"#"!=this.prevtoken&&"INVALID"!=this.prevtoken||32!=this.stream.peek()&&9!=this.stream.peek()?this.classes.push("comment"):(this.outerline+=" "+this.styles["comment-blockquote"],this.classes.push("hidden-comment"));break;case"`":this.pushMode(),this.mode="COMMENT_CODE",this.classes.push("hidden-comment");break;case":":32!=this.stream.peek()?(this.pushMode(),this.mode="COMMENT_ICON",this.classes.push("hidden-comment")):this.classes.push("comment");break;case"<":32!=this.stream.peek()?(this.mode="COMMENT_HTML",this.classes.push("hidden-comment")):this.classes.push("comment");break;case'"':this.pushMode(),this.mode="COMMENT_ESCAPE",this.classes.push("hidden-comment");break;case"?":this.pushMode(),this.mode="COMMENT_QUERY",this.cacheddata=void 0,void 0==this.metrics[this.line]&&(this.metrics[this.line]={}),this.metrics[this.line].query=!0,void 0===this.metrics[this.line].qelements&&(this.metrics[this.line].qelements=[]),this.classes.push("hidden-comment");break;case"{":this.pushMode(),this.mode="COMMENT_ATTRS",this.classes.push("hidden-comment");break;default:this.classes.push("comment")}};var css_color_names={aliceblue:!0,antiquewhite:!0,aqua:!0,aquamarine:!0,azure:!0,beige:!0,bisque:!0,black:!0,blanchedalmond:!0,blue:!0,blueviolet:!0,brown:!0,burlywood:!0,cadetblue:!0,chartreuse:!0,chocolate:!0,coral:!0,cornflowerblue:!0,cornsilk:!0,crimson:!0,cyan:!0,darkblue:!0,darkcyan:!0,darkgoldenrod:!0,darkgray:!0,darkgrey:!0,darkgreen:!0,darkkhaki:!0,darkmagenta:!0,darkolivegreen:!0,darkorange:!0,darkorchid:!0,darkred:!0,darksalmon:!0,darkseagreen:!0,darkslateblue:!0,darkslategray:!0,darkslategrey:!0,darkturquoise:!0,darkviolet:!0,deeppink:!0,deepskyblue:!0,dimgray:!0,dimgrey:!0,dodgerblue:!0,firebrick:!0,floralwhite:!0,forestgreen:!0,fuchsia:!0,gainsboro:!0,ghostwhite:!0,gold:!0,goldenrod:!0,gray:!0,grey:!0,green:!0,greenyellow:!0,honeydew:!0,hotpink:!0,indianred:!0,indigo:!0,ivory:!0,khaki:!0,lavender:!0,lavenderblush:!0,lawngreen:!0,lemonchiffon:!0,lightblue:!0,lightcoral:!0,lightcyan:!0,lightgoldenrodyellow:!0,lightgray:!0,lightgrey:!0,lightgreen:!0,lightpink:!0,lightsalmon:!0,lightseagreen:!0,lightskyblue:!0,lightslategray:!0,lightslategrey:!0,lightsteelblue:!0,lightyellow:!0,lime:!0,limegreen:!0,linen:!0,magenta:!0,maroon:!0,mediumaquamarine:!0,mediumblue:!0,mediumorchid:!0,mediumpurple:!0,mediumseagreen:!0,mediumslateblue:!0,mediumspringgreen:!0,mediumturquoise:!0,mediumvioletred:!0,midnightblue:!0,mintcream:!0,mistyrose:!0,moccasin:!0,navajowhite:!0,navy:!0,oldlace:!0,olive:!0,olivedrab:!0,orange:!0,orangered:!0,orchid:!0,palegoldenrod:!0,palegreen:!0,paleturquoise:!0,palevioletred:!0,papayawhip:!0,peachpuff:!0,peru:!0,pink:!0,plum:!0,powderblue:!0,purple:!0,red:!0,rosybrown:!0,royalblue:!0,saddlebrown:!0,salmon:!0,sandybrown:!0,seagreen:!0,seashell:!0,sienna:!0,silver:!0,skyblue:!0,slateblue:!0,slategray:!0,slategrey:!0,snow:!0,springgreen:!0,steelblue:!0,tan:!0,teal:!0,thistle:!0,tomato:!0,turquoise:!0,violet:!0,wheat:!0,white:!0,whitesmoke:!0,yellow:!0,yellowgreen:!0};EdenUI.Highlight.prototype.applyAttribute=function(a,b,c){if(a.style)switch(b){case"color":case"font-size":case"font-family":case"font-weight":case"font-style":case"text-decoration":case"margin-left":case"margin-right":a.style[b]=c;break;case"editable":"true"!=c&&"false"!=c||(a.contentEditable=c);break;case"script":a.setAttribute("data-jseden",c),a.contentEditable=!1,a.style.cursor="pointer",changeClass(a,"executable",!0);break;case"width":case"height":a.setAttribute(b,c);break;case"background":a.style.background=c;break;case"title":a.title=c;break;case"cursor":a.style.cursor=c;break;case"class":this.applyClasses(a,c.split(" "));break;default:a.style[b]=c}},EdenUI.Highlight.prototype.parseAttrs=function(a,b){b||(b=this.lineelement.lastChild),(b=b?b.previousSibling:this.lineelement)||(b=this.lineelement);var c;if(a=a.trim(),"."==a.charAt(0)){var d=a.substring(1).match(/[a-z0-9\-]+/);if(null===d)return;c=d[0],a=a.substring(c.length+1).trim(),void 0===this.styleExtensions[c]&&(this.styleExtensions[c]={})}for(;a&&a.length>0;){var e,f=a.indexOf("=");-1==f?(e=a,a=""):(e=a.substring(0,f),a=a.substring(f+1));var g="";if("?"==a.charAt(0));else if('"'==a.charAt(0)||"'"==a.charAt(0)){f=-1;for(var h=a.charAt(0),i=1;i<a.length;i++){if(a.charAt(i)==h){f=i;break}"\\"==a.charAt(i)&&i++}if(-1==f)break;g=a.substring(1,f),a=a.substring(f+1)}else if(a.length>0){f=-1;for(var i=0;i<a.length;i++)if(" "==a.charAt(i)){f=i;break}-1==f?(g=a,a=""):(g=a.substring(0,f),a=a.substring(f+1))}switch(a=a.trim(),e){case"colour":e="color";break;case"size":e="font-size";break;case"font":case"family":e="font-family";break;case"decoration":e="text-decoration";break;case"left":e="margin-left";break;case"right":e="margin-right";break;case"underline":e="text-decoration",g="underline";break;case"highlight":e="background",g="yellow";break;case"bold":e="font-weight",g="bold";break;case"italic":e="font-style",g="italic"}css_color_names[e]||"#"==e.charAt(0)?(g=e,e="color"):""==e&&(e="class"),c?this.styleExtensions[c][e]=g:this.applyAttribute(b,e,g)}return b},EdenUI.Highlight.prototype.COMMENT_ATTRS=function(){for(var a=this.stream.peekLine(),b=0,c=-1,d=0;d<a.length;d++)if("{"==a.charAt(d))b++;else if("}"==a.charAt(d)&&--b<0){c=d;break}if(-1==c)this.classes.push("hidden-comment"),this.popMode();else{var e=a.substring(0,c),f=this.tokentext+e;if(this.tokentext+=e+"}",this.stream.position+=c+1,this.classes.push("hidden-comment"),"?"==f.charAt(0)){void 0==this.metrics[this.line]&&(this.metrics[this.line]={}),this.metrics[this.line].squery=!0;var g=this.parseQuery(f);g&&(g=g.join(" "),this.parseAttrs(g))}else this.parseAttrs(f);this.popMode()}},EdenUI.Highlight.prototype.parseQuery=function(a){for(var b=a.substring(2),c=0,d=-1,e=0;e<b.length;e++)if("("==b.charAt(e))c++;else if(")"==b.charAt(e)&&--c<0){d=e;break}if(-1!=d){var f=b.substring(0,d);return Eden.Selectors.query(f,"value")}},EdenUI.Highlight.prototype.COMMENT_QUERY=function(){if("["==this.token){for(var a=this.stream.peekLine(),b=-1,c=0;c<a.length;c++)if("]"==a.charAt(c)){b=c;break}if(-1==b)return void this.classes.push("hidden-comment");this.classes.push("hidden-comment"),this.cacheddata=a.substring(0,b),console.log("Q RES TYPE",this.cacheddata),this.stream.position+=b+1,this.tokentext+=this.cacheddata+"]"}else if("("==this.token){for(var a=this.stream.peekLine(),d=0,b=-1,c=0;c<a.length;c++)if("("==a.charAt(c))d++;else if(")"==a.charAt(c)&&--d<0){b=c;break}if(-1==b)this.popMode(),this.classes.push("hidden-comment");else{var e=a.substring(0,b);this.tokentext+=e+")",this.stream.position+=e.length+1,this.popMode(),this.classes.push("hidden-comment");var f=document.createElement("span");this.applyClasses(f,["comment-query"]),this.lineelement.appendChild(f);var g=Eden.Selectors.query(e,this.cacheddata?this.cacheddata:"value");g=1==g.length?g[0]:g.length>1?g.join(", "):"",f.setAttribute("data-result",g),this.cacheddata&&f.setAttribute("data-attribs",this.cacheddata),f.setAttribute("data-query",e),this.metrics[this.line].qelements.push(f)}}else this.popMode(),this.classes.push("hidden-comment")},EdenUI.Highlight.prototype.COMMENT_LINK=function(){if("]"!=this.token)this.COMMENT();else if(this.classes.push("hidden-comment"),40==this.stream.peek()){var a=this.lineelement,b=a.parentNode,c=document.createElement("a");c.setAttribute("target","_blank"),c.contentEditable=!1,b&&(b.removeChild(a),c.appendChild(a),b.appendChild(c),this.lineelement=c),this.mode="COMMENT_LINK_END"}else this.popMode(),this.popLine()},EdenUI.Highlight.prototype.COMMENT_LINK_END=function(){console.log("LINKEND",this.token);var a=this.stream.peekLine();if("("==this.token){var b=a.indexOf(")");if(-1==b)this.classes.push("hidden-comment"),this.popMode(),this.popLine();else{var c=a.substring(0,b);this.tokentext+=c+")",this.stream.position+=b+1,this.classes.push("hidden-comment"),this.popMode(),c.startsWith("http://")?this.lineelement.setAttribute("href",c):this.lineelement.setAttribute("href","javascript: Eden.Selectors.goto('"+c+"');"),this.popLine()}}},EdenUI.Highlight.prototype.COMMENT_IMAGE=function(){var a=this.stream.peekLine(),b=a.indexOf("]");if(-1==b)this.classes.push("comment"),this.mode="COMMENT";else{var c=a.substring(0,b);console.log("IMG",this.tokentext),this.classes.push("comment"),this.mode="COMMENT_IMAGE_END",this.pushLine();var d=document.createElement("img");d.title=c,d.style.verticalAlign="top",this.lineelement.appendChild(d),this.lineelement=d}},EdenUI.Highlight.prototype.COMMENT_BUTTON=function(){this.pushLine();var a=document.createElement("button");this.lineelement.appendChild(a),this.lineelement=a,a.contentEditable=!1,this.mode="COMMENT_BUTTON_CONTENT"},EdenUI.Highlight.prototype.COMMENT_BUTTON_CONTENT=function(){"]"==this.token?(this.classes.push("hidden-comment"),this.popLine(),this.popMode()):this.COMMENT()},EdenUI.Highlight.prototype.COMMENT_IMAGE_END=function(){var a=this.stream.peekLine(),b=a.indexOf(")");if(-1==b)this.classes.push("hidden-comment"),this.mode="COMMENT",this.popLine();else{var c=a.substring(0,b);this.tokentext+=c+")",this.stream.position+=b+1,this.classes.push("hidden-comment"),this.mode="COMMENT",this.lineelement.setAttribute("src",c.substring(1)),this.popLine()}},EdenUI.Highlight.prototype.COMMENT_ESCAPE=function(){this.popMode(),this.classes.push("comment")},EdenUI.Highlight.prototype.validHTMLTags={button:!0,span:!0,a:!0,img:!0,input:!0,table:!0,textarea:!0},EdenUI.Highlight.prototype.COMMENT_HTML=function(){var a=this.tokentext;if(!EdenUI.Highlight.prototype.validHTMLTags[a])return this.mode="COMMENT",void this.COMMENT();for(var b=this.stream.peekLine(),c=-1,d=!1,e=0,f=0;f<b.length;f++)if(b.charCodeAt(f)==e)d=!d,e=0;else if(0!=e||34!=b.charCodeAt(f)&&39!=b.charCodeAt(f)){if(d&&"\\"==b.charAt(f))f++;else if(!d&&">"==b.charAt(f)){c=f;break}}else d=!d,e=b.charCodeAt(f);if(c>=0){
var g="<"+a+b.substring(0,c+1);this.tokentext=g.substring(1),this.cacheddata={opentag:g,tagname:a},this.classes.push("hidden-comment"),this.mode="COMMENT_HTML_START",this.stream.position+=c+1}else this.classes.push("hidden-comment"),this.tokentext+=b.substring(0,b.length-1),this.stream.position+=b.length-1,this.mode="COMMENT"},EdenUI.Highlight.prototype.COMMENT_HTML_CONTENT=function(){if("<"!=this.token)this.COMMENT();else if(this.cacheddata){var a=this.stream.peekLine(),b="/"+this.cacheddata.tagname+">",c=a.indexOf(b);-1==c?this.classes.push("hidden-comment"):(this.cacheddata&&this.popLine(),this.tokentext+=b,this.stream.position+=c+b.length,this.classes.push("hidden-comment")),this.mode="COMMENT"}else this.mode="COMMENT"},EdenUI.Highlight.prototype.COMMENT_HTML_START=function(){if("<"!=this.token){var a=this.cacheddata.opentag+d;this.mode="COMMENT_HTML_CONTENT",this.pushLine();var b=$(a).get(0);"button"!=this.cacheddata.tagname&&"a"!=this.cacheddata.tagname||(b.contentEditable=!1),this.lineelement.appendChild(b),this.lineelement=b,this.COMMENT()}else{var c=this.stream.peekLine(),d="/"+this.cacheddata.tagname+">",e=c.indexOf(d);-1==e?this.classes.push("hidden-comment"):(this.cacheddata&&this.popLine(),this.tokentext+=d,this.stream.position+=e+d.length,this.classes.push("hidden-comment")),this.mode="COMMENT"}},EdenUI.Highlight.prototype.COMMENT_CODE=function(){"`"==this.token?(this.classes.push("hidden-comment"),this.popMode()):(this.classes.push("script"),this.START())},EdenUI.Highlight.prototype.COMMENT_ICON=function(){if("OBSERVABLE"==this.token){if("-"==this.stream.code.charAt(this.stream.position)){var a=this.stream.peekLine(),b=a.indexOf(":");if(-1==b)return this.classes.push("comment"),void this.popMode();var c=a.substring(0,b);this.tokentext+=c,this.stream.position+=c.length}var d=document.createElement("span");d.className="eden-comment-icon fa fa-"+this.tokentext,this.lineelement.appendChild(d),this.classes.push("hidden-comment")}else":"==this.token&&(this.classes.push("hidden-comment"),this.popMode())},EdenUI.Highlight.prototype.COMMENT_EMPH=function(){if("*"==this.token)this.mode="COMMENT_BOLD",this.classes.push("hidden-comment");else{var a=document.createElement("span");this.applyClasses(a,["comment-emph"]),this.lineelement.appendChild(a),this.pushLine(),this.lineelement=a,this.mode="COMMENT_ITALIC",this.COMMENT()}},EdenUI.Highlight.prototype.COMMENT_ITALIC=function(){"*"==this.token?(this.classes.push("hidden-comment"),this.popLine(),this.popMode()):this.COMMENT()},EdenUI.Highlight.prototype.COMMENT_BOLD=function(){if("*"==this.token)this.classes.push("hidden-comment"),this.popLine(),this.mode="COMMENT_BOLD_END";else{var a=document.createElement("span");this.applyClasses(a,["comment-bold"]),this.lineelement.appendChild(a),this.pushLine(),this.lineelement=a,this.mode="COMMENT_BOLD_END",this.COMMENT()}},EdenUI.Highlight.prototype.COMMENT_BOLD_END=function(){"*"==this.token?("*"==this.stream.code.charAt(this.stream.position)&&(this.classes.push("hidden-comment"),this.stream.position++,this.tokentext+="*"),this.popLine(),this.popMode()):this.COMMENT()},EdenUI.Highlight.prototype.COMMENT_TAG=function(){this.mode="END_COMMENT_TAG"},EdenUI.Highlight.prototype.END_COMMENT_TAG=function(){this.popLine(),this.mode="COMMENT",this.COMMENT()},EdenUI.Highlight.prototype.DOXY_COMMENT=function(){this.BLOCK_COMMENT()},EdenUI.ContextMenu=function(a){this.element=$('<div class="eden-contextmenu"></div>'),this.origin=a,this.target=void 0,this.items=[],$(document.body).append(this.element);var b=this;this.element.on("mousedown",".eden-contextmenu-item",function(a){var c=parseInt(a.currentTarget.getAttribute("data-index"));b.items[c].action&&b.items[c].action(b.target)}),this.origin.oncontextmenu=function(a){b.target=a.target,"SPAN"==b.target.nodeName&&(b.target=b.target.parentNode);var c=document.body.scrollLeft+a.clientX;c+150>=screen.width&&(c-=c+150-screen.width),b.element.css("top",document.body.scrollTop+a.clientY+10+"px"),b.element.css("left",c+"px");for(var d=0;d<b.items.length;d++){var e;e="function"==typeof b.items[d].status?b.items[d].status(b.target):b.items[d].status,changeClass(b.items[d].element,"disabled",!e)}b.element.slideDown(100),a.preventDefault()},document.addEventListener("mousedown",function(){b.element.hide()},!0)},EdenUI.ContextMenu.prototype.addItem=function(a,b,c,d){var e=$('<div class="eden-contextmenu-item"><span class="eden-contextmenu-icon">'+a+"</span><span>"+b+"</span></div>");e.get(0).setAttribute("data-index",""+this.items.length),this.element.append(e),this.items.push({status:c,action:d,element:e.get(0)})},EdenUI.ContextMenu.prototype.addSeparator=function(){var a=$('<div class="eden-contextmenu-sep"></div>');this.element.append(a)},EdenUI.ButtonBar=function(a){this.container=a,this.bar=$('<div class="control-bar noselect"><div class="buttonsDiv"></div></div>'),this.buttons={},this.container.appendChild(this.bar.get(0))},EdenUI.ButtonBar.prototype.addButton=function(a,b,c,d){var e=$('<button class="control-button control-enabled '+a+'" title="'+c+'">'+b+"</button>");this.bar.find(".buttonsDiv").append(e),e.get(0).onclick=d,this.buttons[a]=e},EdenUI.ButtonBar.prototype.enableButton=function(a){this.buttons[a]&&this.buttons[a].addClass("control-enabled")},EdenUI.ButtonBar.prototype.disableButton=function(a){this.buttons[a]&&this.buttons[a].removeClass("control-enabled")},EdenUI.Tabs=function(a){this.tabs=a,this.scrollix=0,this.maxtabs=3},EdenUI.Tabs.prototype.build=function(a,b){for(;this.tabs.firstChild;)this.tabs.removeChild(this.tabs.firstChild);var c=document.createElement("div");c.className="agent-tableft noselect",this.tabs.appendChild(c);var d=document.createElement("div");if(d.className="agent-tab-container",this.tabs.appendChild(d),a&&a instanceof Array){var e=-1;b&&(e=a.indexOf(b)),e>this.scrollix+(this.maxtabs-1)&&(this.scrollix=e-(this.maxtabs-1)),e<this.scrollix&&(this.scrollix=e);for(var f=0;f<a.length;f++){var g=a[f];Eden.Agent.agents[a[f]]&&(g=Eden.Agent.agents[a[f]].title),this.scrollix<=f&&this.add(d,a[f],g,b&&a[f]==b,f)}}var h=document.createElement("div");h.className="agent-newtab noselect",h.style.left=160*a.length+20+"px",d.appendChild(h);var i=document.createElement("div");i.className="agent-tabright noselect",this.tabs.appendChild(i)},EdenUI.Tabs.prototype.add=function(a,b,c,d,e){var f=document.createElement("div");f.style.left=160*e+"px";var g="agent-tab noselect";g+=d?" agent-tab-current":" agent-tab-notcurrent";var h=b.split("/").pop();h.length>18&&(h="..."+h.slice(-15));var i;i=Eden.Agent.agents[b]?Eden.Agent.agents[b].hasErrors()?"tab-icon errored":Eden.Agent.agents[b].executed?"tab-icon executed":"tab-icon":"tab-icon noagent",f.className=g,f.innerHTML="<span class='"+i+"'>&#xf007;</span>"+h,f.draggable=!0,f.setAttribute("data-name",b),a.appendChild(f)},EdenUI.MenuBar=function(){function a(){$(".menubar-menu").hide(),s=!1,$("#menubar-mainitem-views").children().css("display","")}function b(a){$("#menubar-mainitem-"+a).show(),t=a,s=!0,"sharebox"==a&&o.sharebox.show()}function c(){var a=$("#menubar-mainitem-existing-views");Object.keys&&0===Object.keys(edenUI.activeDialogs).length&&a.html('<div class="menubar-item-fullwidth">Use the "New Window" menu to create windows.</div>')}function d(b){a();var c=edenUI.eden.root,d=c.lookup("mouseFollow").value(),e=c.lookup("views_number_created"),f=e.value()+1;e.assign(f,c.scope,Symbol.hciAgent,!0);var g=this.view,h=g.toLowerCase()+f;d?edenUI.eden.execute('createView("'+h+'", "'+g+'");'):edenUI.createView(h,g),o.updateViewsMenu()}function e(b){var d=this.parentNode.viewname;edenUI.viewInstances[d].confirmClose&&a(),edenUI.destroyView(d),c()}function f(a){var b=a.currentTarget.children[0],c=this.parentNode.viewname;edenUI.viewInstances[c].pinned?(edenUI.unpinView(c),b.src=n):(edenUI.pinView(c),b.src=m)}function g(a){for(var b=$("<div class='menubar-item'></div>"),c=0;c<a.length;++c)b.append(a[c]);return b}function h(a,b){return $('<div class="'+a+' menubar-item-clickable">'+b+"</div>")}function i(a){return $("<div class='menubar-item menubar-nonselectable'><div class='menubar-item-fullwidth menubar-item-separator'>"+a+"</div></div>")}function j(b){return{mouseover:function(a){edenUI.highlightView(b,!0)},mouseout:function(a){edenUI.stopHighlightingView(b,!0,!1)},click:function(c){edenUI.stopHighlightingView(b,!0,!0),a()}}}function k(a){return a&&"false"!=a?'checked="checked"':""}function l(a,b,c,d){var e=edenUI.getOptionValue(a);null===e&&(e=c);var f=h("menubar-item-input",'<input id="menu-'+a+'" type="checkbox"'+k(e)+" />"),i=f.get(0).children[0],j=h("menubar-item-label",b),l=g([f,j]);l.click(function(b){b.target!=i&&(i.checked=!i.checked),edenUI.setOptionValue(a,i.checked)}),edenUI.listenTo("optionChange",void 0,function(b,c){if(b==a){var e="true"===c;i.checked=e,d&&d(a,e)}}),l.appendTo(u)}var m="images/pin.png",n="images/pin-greyed.png",o=this;this.itemViews={};var p=mobilecheck(),q=$('<div id="menubar-obscurer" class="login-subdialog modal" style="display: block;"></div>');q.html(`<div class="modal-content" style="width: 550px; height: 400px;"><div class="menubar-sharebox-title"><span class="menubar-shareicon">&#xf090;</span>${Language.ui.menu_bar.signin}</div><iframe frameborder="0" name="logintarget" width="540px" height="300px" class="menubar-login-iframe"></iframe><button class="jseden button-cancel">${Language.ui.menu_bar.cancel}</button></div>`),q.hide(),Eden.AST&&eden.execute2("views_number_created = 0;",Symbol.defaultAgent),this.element=p?$('<div id="menubar-main" class="no-print">\t\t\t<div class="menubar-buttons">\t\t\t\t<a id="eden-logo" href="'+window.location.pathname+'" target="_blank" style="display: block"></a>\t\t\t\t<div class="menubar-button enabled main share" data-obs="sharebox" title="Save or share" style="display: none;">&#xf1e0;<div id="menubar-mainitem-sharebox" class="menubar-menu"></div></div>\t\t\t\t<div class="menubar-button enabled main notifications" data-obs="notifications" title="Notifications">&#xf0f3;<span class="menubar-notification-jewel"></span><div id="menubar-mainitem-notifications" class="menubar-menu"></div></div>\t\t\t\t<div class="menubar-button enabled main more" data-obs="more" title="More Options">&#xf0c9;</div></div>\t\t\t<div class="searchouter menusearch" style="display: none;"><input type="text" class="search menusearch" placeholder="Search..." spellcheck="false"></input>\t\t\t\t<div id="menubar-searchresults"></div>\t\t\t</div></div>'):$(`<div id="menubar-main" class="no-print">\n\t\t\t<a id="eden-logo" title="${Language.ui.tooltips.home_logo}" href="'+window.location.pathname+'" target="_blank" style="display: block"></a>\n\t\t\t<div class="jseden-title" title="${Language.ui.tooltips.rename}"></div>\n\t\t\t<div id="menubar-login"><span class="icon">&#xf05e;</span>${Language.ui.menu_bar.notconnected}</div>\n\t\t\t<div class="menubar-buttons">\n\t\t\t\t<div class="menubar-button enabled main share" data-obs="sharebox" title="${Language.ui.tooltips.save}" style="display: none;">&#xf1e0;<div id="menubar-mainitem-sharebox" class="menubar-menu"></div></div>\n\t\t\t\t<div class="menubar-button enabled main create" data-obs="views" title="${Language.ui.tooltips.create}" style="display: none;">&#xf067;<div id="menubar-mainitem-views" class="menubar-menu"></div></div>\n\t\t\t\t<div class="menubar-button enabled main existing" data-obs="existing" title="${Language.ui.tooltips.existing}" style="display: none;">&#xf2d2;<div id="menubar-mainitem-existing" class="menubar-menu"></div></div>\n\t\t\t\t<div class="menubar-button enabled main settings" data-obs="options" title="${Language.ui.tooltips.options}" style="display: none;">&#xf013;<div id="menubar-mainitem-options" class="menubar-menu"></div></div>\n\t\t\t\t<div class="menubar-button enabled main help" data-obs="help" title="${Language.ui.tooltips.help}" style="display: none;">&#xf128;<div id="menubar-mainitem-help" class="menubar-menu"></div></div>\n\t\t\t\t<div class="menubar-button enabled main notifications" data-obs="notifications" title="${Language.ui.tooltips.notifications}">&#xf0f3;<span class="menubar-notification-jewel"></span><div id="menubar-mainitem-notifications" class="menubar-menu"></div></div>\n\t\t\t\t<div class="menubar-button enabled main maker" data-obs="maker" title="${Language.ui.tooltips.maker}">&#xf0ad;</div></div>\n\t\t\t<div class="searchouter menusearch" style="display: none;"><input type="text" class="search menusearch" placeholder="${Language.ui.menu_bar.search}" spellcheck="false"></input>\n\t\t\t\t<div id="menubar-searchresults"></div>\n\t\t\t</div></div>`),$(document.body).append(this.element);var r=this.element.find("#menubar-login");if(!p){new EdenUI.ContextMenu(r.get(0)).addItem("&#xf08b;","Log out",function(){return Eden.DB.isLoggedIn()},function(){Eden.DB.logOut(function(){$("#menubar-login").html('<span class="icon">&#xf090;</span>Sign-in')})})}edenUI.listenTo("loadPlugin",this,function(a,b){p||this.updateViewsMenu()}),edenUI.listenTo("createView",this,function(a,b){p||this.updateViewsMenu()}),edenUI.listenTo("destroyView",this,function(a){p||($(this.itemViews[a]).remove(),delete this.itemViews[a],c())}),Eden.DB.listenTo("connected",this,function(a){p||$("#menubar-login").html(`<span class="icon">&#xf090;</span>${Language.ui.menu_bar.signin}`)}),Eden.DB.listenTo("disconnected",this,function(){p||$("#menubar-login").html(`<span class="icon">&#xf05e;</span>${Language.ui.menu_bar.notconnected}`)}),Eden.DB.listenTo("login",this,function(a){p||a&&(setTimeout(function(){$("#menubar-obscurer").remove()},1e3),$("#menubar-login").html('<a href="'+Eden.DB.remoteURL+'/#" target="_blank"><span class="icon">&#xf2be;</span>'+a+"</a>"))});var o=this;p||$("#menubar-login").click(function(){o.showLogin()}),this.showLogin=function(){Eden.DB.isConnected()&&!Eden.DB.isLoggedIn()?(q.show(),$(document.body).append(q),q.find("iframe").attr("src",Eden.DB.remoteURL+"/login"),q.on("click",".button-cancel",function(){q.remove()})):Eden.DB.isConnected()&&Eden.DB.isLoggedIn()},Eden.AST&&(this.sharebox=new EdenUI.Sharebox(this.element.find("#menubar-mainitem-sharebox")),this.element.on("click",".menubar-button.share",function(a){a.currentTarget===a.target&&o.sharebox.update()}),this.searchbox=new EdenUI.SearchBox(this.element.find("#menubar-searchresults")),this.element.on("keyup",".search",function(a){o.searchbox.updateSearch(a.currentTarget.value)}),this.element.on("focus",".search",function(a){o.searchbox.updateSearch(a.currentTarget.value)}));var s=!1,t=void 0;$(document.body).on("mousedown",function(){a(),o.searchbox&&o.searchbox.element.hide()}),this.element.on("mousedown",".menubar-search-outer",function(a){a.stopPropagation()}),this.element.on("mousedown",".menubar-button.main",function(c){var d=c.currentTarget.getAttribute("data-obs");s&&c.target===this?d==t?a():(a(),b(d)):b(d),o.searchbox&&o.searchbox.element.hide(),c.stopPropagation()}),this.element.on("mouseenter",".menubar-button.main",function(a){}),this.updateViewsMenu=function(){var a=$("#menubar-mainitem-views"),b=$("#menubar-mainitem-existing");a.html("");var k=$('<input id="menubar-view-type-search" class="menubar-search-box" type="text" placeholder="search"/>'),l=k[0],p=$('<div class="menubar-item-fullwidth"></div>');p.append(k);var q=$("<div class='menubar-item-search'></div>");q.append(p),l.search=function(){var b,c=l.value,d=new RegExp("(^|\\s)"+c,"i"),e=!1;a.children().each(function(a,f){if(!f.classList.contains("menubar-item-search")){var g=f.children[0],h=g.innerHTML;g.classList.contains("menubar-item-separator")?(c.length>1&&(e=d.test(h)),b=f,f.style.display=e?"":"none"):e?f.style.display="":d.test(h)?(f.style.display="",b.style.display=""):f.style.display="none"}})},k.on("input",l.search);var r,s,t,u,v,w,x=[];for(s in edenUI.views){var y=edenUI.views[s],z=y.title,A=y.category.getLabel(),B=y.category.getMenuPriority(),C=y.menuPriority;u=h("menubar-item-fullwidth menubar-view",z),t=g([u]),t[0].view=s,t.click(d),x.push({title:z,viewEntry:t,categoryLabel:A,categoryPriority:B,itemPriority:C})}x=x.sort(function(a,b){if(a.categoryPriority!=b.categoryPriority)return a.categoryPriority-b.categoryPriority;if(void 0!==a.itemPriority){if(void 0===b.itemPriority)return-1;if(a.itemPriority!=b.itemPriority)return a.itemPriority-b.itemPriority}else if(void 0!==b.itemPriority)return 1;return a.title>b.title?1:a.title<b.title?-1:0});for(var D,E=0;E<x.length;++E){var F=x[E],G=F.categoryLabel;if(D!=G){i(G).appendTo(a),D=G}F.viewEntry.appendTo(a)}a.append(q),b.html(""),o.itemViews={},c();for(r in edenUI.activeDialogs){var H=j(r),z=edenUI.eden.root.lookup("view_"+r+"_title").value();u=h("menubar-item-label",z+' <span class="menubar-view-name">['+r+"]</span>"),u.click(H.click);var I;I=edenUI.viewInstances[r].pinned?m:n,v=h("menubar-item-pin",'<img src="'+I+'" width="18" height="18" class="menubar-item-pin-icon"/>'),v.click(f),w=h("menubar-item-close",'<div class="menubar-item-close-icon">X</div>'),w.click(e),t=g([u,v,w]),t.bind("mouseover",H.mouseover),t.bind("mouseout",H.mouseout),t[0].viewname=r,t.appendTo(b),o.itemViews[r]=t[0]}},this.updateViewsMenu();var u=$("#menubar-mainitem-options");l("optConfirmUnload",Language.ui.menu_bar.opt_confirm,!0,function(a,b){b?window.addEventListener("beforeunload",confirmUnload):window.removeEventListener("beforeunload",confirmUnload)}),l("optSimpleWildcards",Language.ui.menu_bar.opt_simple_search,!0),l("optHideOnMinimize",Language.ui.menu_bar.opt_hide,!1),l("optCollapseToTitleBar",Language.ui.menu_bar.opt_collapse,!1,function(a,b){var c;c=b?"collapse":"maximize",$(".ui-dialog-content").each(function(){$(this).dialogExtend("option","dblclick",c)})}),l("developer",Language.ui.menu_bar.opt_debug,!1,function(b,c){var d;d=c?"/index-dev.html":"/index.html";var e=document.location.pathname;d=e.slice(0,e.lastIndexOf("/"))+d,d!=document.location.pathname?(a(),edenUI.modalDialog("Restart Required","<p>JS-EDEN must be restarted for this change to fully take effect.  Would you like to restart JS-EDEN now?</p>",["Restart Now","Restart Later"],1,function(a){if(0==a)window.onbeforeunload=void 0,document.location.pathname=d;else if(1==a)root.lookup("debug").mutate(root.scope,function(a){a.cache.value.jsExceptions=c},Symbol.hciAgent);else{var b=document.getElementById("menu-developer");b.checked=!b.checked,edenUI.setOptionValue("developer",b.checked)}})):root.lookup("debug").mutate(root.scope,function(a){a.cache.value.jsExceptions=c},Symbol.hciAgent)}),this.element.on("keyup",".jseden-title",function(a){try{window.localStorage&&window.localStorage.setItem("title",a.currentTarget.textContent)}catch(a){}}),eden.root.lookup("jseden_project_title").addJSObserver("menubar",function(a,b){if(!p){if(a.origin&&a.origin!==Symbol.hciAgent){var c=$(".jseden-title").get(0);c.contentEditable=!0,c.textContent=b,document.title=b}try{window.localStorage&&window.localStorage.setItem("title",b)}catch(a){}}}),eden.root.lookup("jseden_maker").addJSObserver("menubar",function(a,b){b?o.element.find(".maker").addClass("active"):o.element.find(".maker").removeClass("active")}),eden.root.lookup("jseden_menu_showsearch").addJSObserver("menubar",function(a,b){b?(o.element.find(".menusearch").show(),p&&o.element.find("#eden-logo").hide()):(o.element.find(".menusearch").hide(),p&&o.element.find("#eden-logo").show())}),eden.root.lookup("jseden_menu_showshare").addJSObserver("menubar",function(a,b){b?o.element.find(".menubar-button.share").show():o.element.find(".menubar-button.share").hide()}),eden.root.lookup("jseden_menu_showcreate").addJSObserver("menubar",function(a,b){b?o.element.find(".menubar-button.create").show():o.element.find(".menubar-button.create").hide()}),eden.root.lookup("jseden_menu_showexisting").addJSObserver("menubar",function(a,b){b?o.element.find(".menubar-button.existing").show():o.element.find(".menubar-button.existing").hide()}),eden.root.lookup("jseden_menu_showsettings").addJSObserver("menubar",function(a,b){b?o.element.find(".menubar-button.settings").show():o.element.find(".menubar-button.settings").hide()}),eden.root.lookup("jseden_menu_showhelp").addJSObserver("menubar",function(a,b){b?o.element.find(".menubar-button.help").show():o.element.find(".menubar-button.help").hide()}),eden.root.lookup("jseden_project_subtitle").addJSObserver("menubar",function(a,b){}),this.notifications=new EdenUI.Notifications(this.element.find("#menubar-mainitem-notifications"),this.element.find(".menubar-notification-jewel")),this.element.on("click",".notifications",function(a){o.notifications.clearCount()}),this.element.on("click",".maker",function(a){var b=eden.root.lookup("jseden_maker");if(!b.eden_definition){var c=b.value();void 0===c&&(c=!1),b.assign(!c,eden.root.scope,Symbol.localJSAgent)}}),this.element.on("keyup",".jseden-title",function(a){var b=eden.root.lookup("jseden_project_title");b.definition||b.assign(a.currentTarget.textContent,eden.root.scope,Symbol.hciAgent)})},EdenUI.MenuBar.prototype.hide=function(){this.element.hide()},EdenUI.MenuBar.prototype.show=function(){this.element.show()},EdenUI.MenuBar.reset=function(){$(".jseden-title").html("CONSTRUIT")},EdenUI.MenuBar.saveTitle=function(a){eden.root.lookup("jseden_project_title").assign(a,eden.root.scope,Symbol.jsAgent)},EdenUI.Dialogs={},EdenUI.Dialogs.MergeError=function(a,b,c){var d=new diff_match_patch,e=d.diff_main(a,b);d.diff_cleanupSemantic(e);var f=d.diff_prettyHtml(e);$('<div title="Import Merge Conflict">'+f+"</div>").dialog({resizable:!0,height:"auto",width:600,modal:!0,buttons:{"Use Mine":function(){c&&c("old"),$(this).dialog("close")},"Use New":function(){c&&c("new"),$(this).dialog("close")},Merge:function(){c&&c("merge"),$(this).dialog("close")}}})},EdenUI.Notifications=function(a,b){function c(a,b){if(b){var c=("runtime"==b.type?"Runtime error":"Syntax error")+" in "+a.name+":"+(-1!=b.line?b.line:"")+" -> "+b.messageText(),e="<a href=\"javascript:edenUI.gotoCode('"+a.name+"',"+b.line+');">'+a.name+":"+(-1!=b.line?b.line+1:"")+"</a> "+b.messageText();if(!a.owned||"syntax"!=b.type){console.error(c);var f=$('<pre class="error-item">'+e+"</pre>\n\n");f.on("click",function(){var a="";if(!b.statement||"definition"!=b.statement.type&&"assignment"!=b.statement.type||(a+="    <b>Symbol:</b> "+b.statement.lvalue.name+"\n"),b.lastsymbol&&(a+="    <b>Related Symbol:</b> "+b.lastsymbol+"\n"),String(b.extra).search("SyntaxError")>=0)a+="    <b>JavaScript:</b> "+b.javascriptSource()+"\n",f.html(e+"\n"+a);else if(a+="    <b>Source:</b> <div class='error-source'</div>\n",f.html(e+"\n"+a),b.statement){var c=new Eden.AST(b.edenSource(),void 0,Symbol.jsAgent),d=new EdenUI.Highlight(f.find(".error-source").get(0));d.highlight(c,-1,-1)}}),d.notification("error",f)}}}var d=this;this.notificationCount=0,this.notificationCountElement=b,this.notificationCountElement.hide(),this.notificationPanel=a,this.notificationPanel.html('<button class="control-button close-button control-enabled">&#xf00d;</button><button class="control-button clear-button control-enabled">&#xf05e;</button><div id="errors-dialog"></div>'),this.notificationPanel.on("click",".close-button",function(){d.notificationPanel.hide()}).on("click",".clear-button",function(){d.notificationPanel.find("#errors-dialog").html("")}),this.notificationPanel.hide(),this.notificationContent=this.notificationPanel.find("#errors-dialog"),Eden.Peer.listenTo("user",void 0,function(a,b){d.notification("net",$('<div class="notification-content">User \'<a href="javascript:eden.peer.showConnection(\''+a+"');\">"+b+"</a>' connected to you.<br/><a href=\"javascript: eden.peer.requestShare('"+a+"');\">Watch</a> <a href=\"javascript: eden.peer.requestObserve('"+a+"');\">Broadcast</a> <a href=\"javascript: eden.peer.requestCollaborate('"+a+"');\">Collaborate</a></div>"))}),Eden.Peer.listenTo("share",void 0,function(a,b){d.notification("net",$('<div class="notification-content">Your model is being shared...</div>'))}),Eden.Peer.listenTo("disconnect",void 0,function(a,b){b?d.notification("net",$('<div class="notification-content">User \''+b+"' disconnected.</div>")):d.notification("net",$('<div class="notification-content">P2P User disconnected.</div>'))}),Eden.Peer.listenTo("error",void 0,function(a){d.notification("error",$('<div class="notification-content">P2P: '+a+"</div>"))}),Eden.Fragment&&(Eden.Fragment.listenTo("error",void 0,c),eden.listenTo("error",void 0,c),Eden.Fragment.listenTo("warning",void 0,function(a,b){if(b){var c=(b.type,a.name,-1!=b.line&&b.line,b.messageText(),"<a href=\"javascript:edenUI.gotoCode('"+a.name+"',"+b.line+');">'+a.name+":"+(-1!=b.line?b.line+1:"")+"</a> "+b.messageText());if(!a.owned||"syntax"!=b.type){var e=$('<pre class="error-item">'+c+"</pre>\n\n");e.on("click",function(){var a="";if(!b.statement||"definition"!=b.statement.type&&"assignment"!=b.statement.type||(a+="    <b>Symbol:</b> "+b.statement.lvalue.name+"\n"),b.lastsymbol&&(a+="    <b>Related Symbol:</b> "+b.lastsymbol+"\n"),String(b.extra).search("SyntaxError")>=0)a+="    <b>JavaScript:</b> "+b.javascriptSource()+"\n",e.html(c+"\n"+a);else if(a+="    <b>Source:</b> <div class='error-source'</div>\n",e.html(c+"\n"+a),b.statement){var d=new Eden.AST(b.edenSource(),void 0,Symbol.jsAgent),f=new EdenUI.Highlight(e.find(".error-source").get(0));f.highlight(d,-1,-1)}}),d.notification("warning",e)}}})),Eden.DB.listenTo("disconnected",this,function(){d.notification("info",$('<div class="notification-content">Disconnected from project server</div>'))}),Eden.DB.listenTo("error",this,function(a){d.notification("error",$('<div class="notification-content">'+a+"</div>"))})},EdenUI.Notifications.prototype.notification=function(a,b){this.notificationCount++,this.notificationCountElement.html(this.notificationCount),this.notificationCountElement.show();var c;if("error"==a)c=$('<div class="notification-item error"></div>'),c.append($('<div class="notification-icon"><span style="color: red;">&#xf06a;</span></div>'));else{var d,e="#777";switch(a){case"net":d="&#xf0c1;";break;case"comment":d="&#xf075;";break;case"log":d="&#xf120;";break;case"warning":d="&#xf071;",e="#f57900";break;case"info":default:d="&#xf129;",e="#29454B"}c=$('<div class="notification-item"></div>'),c.append($('<div class="notification-icon"><span style="color: '+e+'">'+d+"</span></div>"))}"string"==typeof b?c.append($('<div class="notification-content">'+b+"</div>")):c.append(b),this.notificationContent.prepend(c),this.notificationContent.prop("scrollTop",0)},EdenUI.Notifications.prototype.clearCount=function(){this.notificationCountElement.hide(),this.notificationCount=0},EdenUI.Sharebox=function(a){var b=this;this.title=void 0,this.visible=!1,this.sharebox=a,this.sharebox.html('<div class="menubar-sharebox-title"><span class="menubar-shareicon">&#xf1e0;</span>Save and Share</div><div class="menubar-sharebox-content"><div id="projectoptions"></div><div id="projectuploadbox"></div></div>');var c=this.sharebox.find("#projectoptions");this.markdown=new EdenUI.Markdown(""),c.get(0).appendChild(this.markdown.contents),this.sharebox.on("change","#thumbfile",function(a){var c=b.sharebox.find("#projectthumb"),d=$("#thumbfile");c.html("<img></img>");var e=d.get(0),f=e.files[0],g=new FileReader;g.onload=function(a){var d=document.createElement("canvas");d.setAttribute("width","200"),d.setAttribute("height","112");var e=d.getContext("2d"),f=new Image;f.onload=function(){var a,g,h,i,j=f.width,k=f.height,l=j/k;l<200/112?(a=112,g=j*(a/k),h=(200-g)/2,i=0):l>200/112?(g=200,a=k*(g/j),h=0,i=(112-a)/2):(a=112,g=200,h=0,i=0),e.drawImage(f,h,i,g,a);var m=d.toDataURL("image/png");b.thumbdata=m,c.get(0).childNodes[0].src=m},f.src=a.target.result},g.readAsDataURL(f)}),this.sharebox.on("click",".upload",function(a){var c=b.title.textContent,d=b.markdown.intextarea.value,e=$("#listpublic").get(0).checked;if("New Project"==c)return void b.sharebox.find("#projectuploadbox").html('Please give your project a name by editing the "New Project" title in the top left.');b.sharebox.find("#projectuploadbox").html('Saved to your projects and shared at:<div class="projecturl">Saving...</div>'),eden.project.thumb=b.thumbdata,eden.project.setDescription(d),console.log("SAVE",e,d),eden.project.save(e,function(a){if(a){var c="?load="+eden.project.id+"&vid="+eden.project.vid+"&r="+eden.project.readPassword;window.history.replaceState({id:eden.project.id,vid:eden.project.vid},"",c),b.sharebox.find(".projecturl").html('<div class="sharebox-url">'+window.location.href+'</div><iframe src="https://www.facebook.com/plugins/share_button.php?href='+encodeURIComponent(window.location.href)+'&layout=button&size=small&mobile_iframe=true&appId=1447073055317881&width=59&height=20" width="59" height="20" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true"></iframe>');var d=document.createRange();d.selectNodeContents(b.sharebox.find(".projecturl").get(0));var e=window.getSelection();e.removeAllRanges(),e.addRange(d)}else b.sharebox.find(".projecturl").html("<b>Save failed</b>, not logged in.")})}),this.sharebox.on("click",".fork",function(a){var c=b.title.textContent,d=b.markdown.intextarea.value,e=$("#listpublic").get(0).checked;if("New Project"==c)return void b.sharebox.find("#projectuploadbox").html('Please give your project a name by editing the "New Project" title in the top left.');b.sharebox.find("#projectuploadbox").html('Saved to your projects and shared at:<div class="projecturl">Saving...</div>'),eden.project.thumb=b.thumbdata,eden.project.id&&(eden.project.parentid=eden.project.id),eden.project.id=void 0,eden.project.vid=void 0,eden.project.setDescription(d),console.log("FORK",e,d),eden.project.save(e,function(a){if(a){var c="?load="+eden.project.id+"&vid="+eden.project.vid;window.history.replaceState({id:eden.project.id,vid:eden.project.vid},"",c),b.sharebox.find(".projecturl").html('<div class="sharebox-url">'+window.location.href+'</div><iframe src="https://www.facebook.com/plugins/share_button.php?href='+encodeURIComponent(window.location.href)+'&layout=button&size=small&mobile_iframe=true&appId=1447073055317881&width=59&height=20" width="59" height="20" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true"></iframe>');var d=document.createRange();d.selectNodeContents(b.sharebox.find(".projecturl").get(0));var e=window.getSelection();e.removeAllRanges(),e.addRange(d)}else b.sharebox.find(".projecturl").html("<b>Save failed</b>, not logged in.")})})},EdenUI.Sharebox.prototype.show=function(){this.visible||this.update(),this.visible=!0},EdenUI.Sharebox.prototype.hide=function(){this.visible=!1},EdenUI.Sharebox.prototype.update=function(){var a=this;void 0===a.title&&(a.title=$(document).find(".jseden-title").get(0));var b=a.title?a.title.textContent:eden.root.lookup("jseden_project_title").value();Eden.DB.isLoggedIn()?(eden.project.authorid!=Eden.DB.userid&&-1!=eden.project.authorid?a.sharebox.find("#projectuploadbox").html('<div id="projectthumb"></div><div style="margin-top: 40px; float: left"><input id="listpublic" type="checkbox">List publically</input></div>Thumbnail: <input id="thumbfile" type="file"></input><div class="sharebox-save-buttons"><button class="sharebox-button fork">Fork</button><span class="downloadurl"></span></div>'):a.sharebox.find("#projectuploadbox").html('<div id="projectthumb"></div><div style="margin-top: 40px; float: left"><input id="listpublic" type="checkbox">List publically</input></div><input id="thumbfile" type="file"></input><div class="sharebox-save-buttons"><button class="sharebox-button upload">Save</button><button class="sharebox-button fork">Fork</button><span class="downloadurl"></span></div>'),a.sharebox.find("#projectoptions").show()):(a.sharebox.find("#projectuploadbox").html('<div class="sharebox-save-buttons"><span class="downloadurl"></span></div>'),a.sharebox.find("#projectoptions").hide());var c=this.sharebox.find("#projectthumb");this.thumbdata=void 0,this.thumbimg=$("<img></img>"),
this.thumbimg.get(0).style.border="1px solid #aaa",this.thumbimg.get(0).style.marginRight="10px",c.append(this.thumbimg),eden.project.thumb?(a.thumbdata=eden.project.thumb,a.thumbimg.get(0).src=eden.project.thumb):a.thumbdata=void 0,void 0===eden.project.id&&(eden.project.tags=(eden.project.title.toLowerCase()+" "+(Eden.DB.isLoggedIn()?Eden.DB.username.toLowerCase():"")).split(" ")),a.markdown.setValue(eden.project.getDescription()),a.projectsource=eden.project.generate();var d="data:application/octet-stream,"+encodeURIComponent(a.projectsource);a.sharebox.find(".downloadurl").html('<a class="sharebox-button download" href="'+d+'" download="'+b+'.js-e">File</a>')},EdenUI.SearchBox=function(a){var b=this;this.element=a,a.on("click",".menubar-search-result",function(a){var c=a.currentTarget.getAttribute("data-id");c&&""!=c?b.updateSymbolDetails(a.currentTarget,c):script&&script}),a.on("click",".edit-result",function(a){}),a.on("click",".script-goto",function(a){var c=a.currentTarget.parentNode.parentNode.parentNode.getAttribute("data-id");b.element.hide(),Eden.Selectors.goto("@external "+c)}),a.on("click",".script-import",function(a){var c=a.currentTarget.parentNode.parentNode.parentNode.getAttribute("data-id");Eden.Selectors.query(c,void 0,{minimum:1,options:{external:!0,index:!0}},function(d){c&&""!=c&&(a.currentTarget.parentNode.parentNode.parentNode.setAttribute("data-imported","true"),b.updateSymbolDetails(a.currentTarget.parentNode.parentNode.parentNode,c))})})},EdenUI.SearchBox.prototype.updateSymbolDetails=function(a,b){console.log("Update details",b);var c=(a.getAttribute("data-imported"),a.getAttribute("data-remote"));Eden.Selectors.query("@history "+b,"id,path,source,type,value,active,tags,rawcomment,historic",{minimum:1,options:{external:!0}},function(b){if(0==b.length)return void console.log("No result");b=b[0];var d=(b[0],b[1]),e=b[2],f=b[3],g=b[4],h=b[5],i=(b[6],b[7]),j=b[8];i&&(i=new Eden.AST.DoxyComment(i));var k=$(a).find(".doxy-search-details");null!==k&&0!=k.length||(k=$('<div class="doxy-search-details"></div>'),a.appendChild(k.get(0))),k=k.get(0),"assignment"!=f&&"definition"!=f||(symstr=e,""==a.firstChild.className?a.firstChild.innerHTML=EdenUI.Highlight.html(symstr):a.childNodes[1].innerHTML=EdenUI.Highlight.html(symstr));var l="";if(j?l="":"true"==c?(l+="<p>",l+='<button class="script-button script-goto">View</button></p>'):l='<p><button class="script-button script-goto">View</button>',i){var m=i.pretty();m&&m.length>0&&(l+=m)}h?(l+="<p>",l+="<span style='color: #666;'><b>Path:</b> "+d+"</span><br>",l+="<b>Current Value:</b> "+Eden.edenCodeForValue(g),l+="</p>"):(l+="<p>",l+="<span style='color: #666;'><b>Path:</b> "+d+"</span>",l+="</p>"),k.innerHTML=l})},EdenUI.SearchBox.prototype.makeStatementResult=function(a){var b,c="",d="",e="";-1==a.executed&&(d=" historic");var f=a.getOrigin();"script"==a.type?(f&&f.remote?(e+=' data-remote="true"',a.indexed&&(e+=' data-imported="true"'),c='<span class="search-scriptres">&#xf08e;</span>'):c='<span class="search-scriptres">&#xf15c;</span>',b=a.doxyComment&&a.doxyComment.getProperty("title")?a.doxyComment.getProperty("title")[0]:a.name?"action "+a.name:a.getInnerSource()):"when"==a.type?(a.enabled&&(c='<span class="search-scriptres">&#xf00c;</span>'),b=a.prefix.trim()):(a.lvalue&&eden.root.symbols[a.lvalue.name]&&eden.root.symbols[a.lvalue.name].origin&&eden.root.symbols[a.lvalue.name].origin.id==a.id&&(c='<span class="search-scriptres">&#xf00c;</span>'),a.getSource()||console.error("NO SOURCE",a),b=a.getSource().split("\n")[0]),b.length>55&&(b=b.substr(0,55)+"..."),b=EdenUI.Highlight.html(b);var g="";if(a.doxyComment){var h=a.doxyComment.brief();h&&h.length>0&&(g='<div class="doxy-search-details"><p>'+h+"</p></div>")}return $('<div class="menubar-search-result'+d+'" data-id="'+Eden.Selectors.getID(a)+'"'+e+">"+c+b+g+"</div>")},EdenUI.SearchBox.prototype.makeScriptResult=function(a){},EdenUI.SearchBox.prototype.updateSearch=function(a){if(a&&""!=a){this.element.show();var b=this;Eden.Selectors.query(a,void 0,{minimum:1,options:{external:!0}},function(a){function c(){var d=$('<div class="menubar-search-more">&#xf078;</div>');e.append(d),d.on("click",function(){e.html("");for(var d=0;f<a.length&&!(d>g);f++){d++;var h;h=a[f]instanceof Symbol?b.makeSymbolResult(a[f]):b.makeStatementResult(a[f]),e.append(h)}f<a.length&&c()})}b.element.html("");var d=$('<div class="menubar-search-outer"></div>'),e=$('<div class="menubar-search-results"></div>');d.append(e),b.element.append(d);var f=0,g=8,h=0;for(f=0;f<a.length;f++)if(void 0!==a[f].parent||0!=a[f].executed){if(h>=g)break;h++;var i;i=b.makeStatementResult(a[f]),e.append(i)}f<a.length&&c()})}else this.element.hide()},EdenUI.ScriptBox=function(a,b){function c(a){q.dirty=!0,q.rebuild()}function d(a){if(q.ast&&q.ast.script&&!q.ast.hasErrors()&&13==a.keyCode&&"EOF"==q.ast.token&&q.intextarea.selectionStart>=q.ast.script.end)return q.history.push(q.ast.stream.code),q.historyindex=q.history.length,window.localStorage&&window.localStorage.setItem("console_history",JSON.stringify(q.history)),$(q.outdiv).find(".fake-caret").remove(),q.$codearea.append($('<div class="scriptbox-historic">'+q.outdiv.innerHTML+"</div>")),q.ast.execute(EdenUI.ScriptBox.consoleAgent,function(){void 0!==q.ast.lastresult&&(console.log("Result",q.ast.lastresult),q.$codearea.append($('<div class="scriptbox-value">'+EdenUI.Highlight.html(Eden.edenCodeForValue(q.ast.lastresult))+"</div>")))}),q.inputhider.scrollTop=q.inputhider.scrollHeight,q.setSource(""),void a.preventDefault();if(a.altKey)187==a.keyCode||61==a.keyCode?a.preventDefault():189==a.keyCode||173==a.keyCode?a.preventDefault():48==a.keyCode&&a.preventDefault();else if(a.ctrlKey||17==a.keyCode||16==a.keyCode){if(a.ctrlKey)if(a.shiftKey){if(37==a.keyCode||38==a.keyCode||39==a.keyCode||40==a.keyCode||36==a.keyCode||35==a.keyCode)return q.setCaretToFakeCaret(),void q.outdiv.focus()}else 38===a.keyCode?onPrevious():40===a.keyCode?onNext():86===a.keyCode||65===a.keyCode&&(a.preventDefault(),q.outdiv.focus())}else if(9==a.keyCode){a.preventDefault();var b=q.intextarea.selectionStart,c=q.intextarea.selectionEnd;q.intextarea.value=q.intextarea.value.substring(0,b)+"\t"+q.intextarea.value.substring(c),q.intextarea.selectionStart=q.intextarea.selectionEnd=b+1,q.rebuild()}else if(37==a.keyCode||38==a.keyCode||39==a.keyCode||40==a.keyCode||36==a.keyCode||35==a.keyCode){if(a.shiftKey)return q.setCaretToFakeCaret(),void q.outdiv.focus();38==a.keyCode?q.historyindex>0&&(q.historyindex--,q.setSource(q.history[q.historyindex]),a.preventDefault()):40==a.keyCode&&(q.historyindex<q.history.length-1?(q.historyindex++,q.setSource(q.history[q.historyindex]),a.preventDefault()):(q.historyindex=q.history.length,q.setSource(""))),q.updateLineCachedHighlight()}else(13==a.keyCode||8==a.keyCode&&10==q.intextarea.value.charCodeAt(q.intextarea.selectionStart-1))&&(q.refreshentire=!0)}function e(a){q.refreshentire=!0}function f(a){a.altKey||(a.ctrlKey||37!=a.keyCode&&38!=a.keyCode&&39!=a.keyCode&&40!=a.keyCode&&36!=a.keyCode&&35!=a.keyCode?(a.ctrlKey||8!=a.keyCode||""!=q.intextarea.value)&&q.rebuild():(q.updateLineCachedHighlight(),36==a.keyCode||a.keyCode))}function g(a){if(!a.altKey)if("pointer"==q.outdiv.style.cursor&&(q.outdiv.style.cursor="initial"),16==a.keyCode||17==a.keyCode||a.ctrlKey&&67==a.keyCode);else if(!a.shiftKey||37!=a.keyCode&&38!=a.keyCode&&39!=a.keyCode&&40!=a.keyCode&&35!=a.keyCode&&36!=a.keyCode){var b=getCaretCharacterOffsetWithin(q.outdiv,q.shadow),c=getStartCaretCharacterOffsetWithin(q.outdiv,q.shadow);q.intextarea.focus(),q.intextarea.selectionEnd=b,q.intextarea.selectionStart=c,c!=b&&(q.refreshentire=!0)}}function h(a){q.intextarea.focus(),setTimeout(function(){q.updateEntireHighlight()},0)}function i(a){}function j(a){$(q.outdiv).find(".fake-caret").remove(),q.hideInfoBox()}function k(a){}function l(a){if(q.hideInfoBox(),document.activeElement===q.outdiv){var b=getCaretCharacterOffsetWithin(q.outdiv,q.shadow);if(getStartCaretCharacterOffsetWithin(q.outdiv,q.shadow)!=b)q.refreshentire=!0;else{var c=q.currentlineno;q.intextarea.focus(),q.intextarea.selectionEnd=b,q.intextarea.selectionStart=b,q.ast&&(q.highlighter.highlight(q.ast,c,b),q.updateLineCachedHighlight())}}}function m(a){var b=parseInt(a.currentTarget.getAttribute("data-statement")),c=Eden.Statement.statements[b];if(c.statement&&0==c.statement.errors.length)c.statement.execute(eden.root,c.ast,c.ast,eden.root.scope),"when"==c.statement.type&&(Eden.Statement.active[c.id]=!Eden.Statement.active[c.id],changeClass(a.currentTarget,"active",Eden.Statement.active[c.id]));else if(c.ast&&c.ast.script){var d=c.ast.script.errors[0];q.showInfoBox(a.target.offsetLeft+20,a.target.offsetTop-q.codearea.scrollTop+25,"error",d.messageText())}q.updateLineCachedHighlight()}function n(a){a.currentTarget.className.indexOf("stuck")>=0?changeClass(a.currentTarget,"stuck",!1):changeClass(a.currentTarget,"stuck",!0)}function o(a){if(-1==q.dragline&&(void 0===q.outdiv||a.currentTarget!==q.outdiv.parentNode)){var b=parseInt(a.currentTarget.getAttribute("data-statement"));q.moveTo(b)}}function p(a){var b=a.currentTarget.parentNode.parentNode,c=parseInt(b.getAttribute("data-statement"));b.removeChild(q.valuedivs[c][0]),delete q.valuedivs[c]}this.changeCB=void 0,this.outer=a,this.savecb=void 0,this.contents=$(this.outer),this.contents.html('<div class="scriptbox-inputhider"><textarea autofocus tabindex="1" class="hidden-textarea" style="height: 5px;"></textarea><div class="scriptbox-codearea"></div></div><div class="scriptbox-outputbox"><div class="scriptbox-statement"><div class="scriptbox-output" contenteditable="true" spellcheck="false"></div></div></div><div class="info-bar"></div></div>'),this.currentstatement=void 0,this.statements={},this.$codearea=this.contents.find(".scriptbox-codearea"),this.codearea=this.$codearea.get(0),this.intextarea=this.contents.find(".hidden-textarea").get(0),this.inputhider=this.contents.find(".scriptbox-inputhider").get(0),this.outdiv=this.contents.find(".scriptbox-output").get(0),this.$codearea.sortable({revert:100,handle:".grippy",distance:10,axis:"y",scroll:!1}),this.infobox=this.contents.find(".info-bar").get(0),this.outputbox=this.contents.find(".scriptbox-outputbox").get(0),this.suggestions=this.contents.find(".eden_suggestions"),this.suggestions.hide(),$(this.infobox).hide(),this.highlighter=new EdenUI.Highlight(this.outdiv),this.enable(),this.ast=void 0,this.refreshentire=!0,this.dirty=!0,this.rebuildtimer=void 0,this.rebuildtimeout=10,this.currentlineno=1,this.currentcharno=0,this.dragint=!1,this.dragline=-1,this.dragvalue=0,this.draglast=0,this.history=void 0,window.localStorage?this.history=JSON.parse(window.localStorage.getItem("console_history"))||[]:this.history=[],this.historyindex=this.history.length;var q=this;this.contents.on("input",".hidden-textarea",c).on("keydown",".hidden-textarea",d).on("keyup",".hidden-textarea",f).on("paste",".hidden-textarea",e).on("keydown",".scriptbox-output",g).on("keyup",".scriptbox-output",i).on("paste",".scriptbox-output",h).on("blur",".hidden-textarea",j).on("focus",".hidden-textarea",k).on("mouseup",".scriptbox-output",l).on("click",".scriptbox-gutter",m).on("click",".scriptbox-sticky",n).on("click",".scriptbox-valueclose",p).on("mousedown",".scriptbox-statement",o),this.setSource(""),setInterval(function(){for(var a in q.valuedivs){var b=Eden.Statement.statements[a];if(b){var c=EdenUI.htmlForStatement(b,30,30);b.isActive();q.valuedivs[a].innerHTML='<div class="eden-line">'+c+"</div>"}}},200)},EdenUI.ScriptBox.consoleAgent={local:!1,name:"*Console"},EdenUI.ScriptBox.prototype.focus=function(){if(this.outdiv.focus(),document.activeElement===this.outdiv){var a=this.intextarea.value.length,b=this.currentlineno;this.intextarea.focus(),this.intextarea.selectionEnd=a,this.intextarea.selectionStart=a,this.ast&&(this.highlighter.highlight(this.ast,b,a),this.updateLineCachedHighlight())}},EdenUI.ScriptBox.prototype.setCaretToFakeCaret=function(){var a=$(this.outdiv).find(".fake-caret").get(0),b=document.createRange(),c=window.getSelection();a.nextSibling&&(a=a.nextSibling),b.setStart(a,0),b.collapse(!0),c.removeAllRanges(),c.addRange(b),$(this.outdiv).remove(".fake-caret")},EdenUI.ScriptBox.prototype.setChangeCB=function(a){this.savecb=a},EdenUI.ScriptBox.prototype.hideInfoBox=function(){$(this.infobox).hide("fast")},EdenUI.ScriptBox.prototype.showInfoBox=function(a,b,c,d){console.log("SHOW INFO BOX "+d),"warning"==c?this.infobox.innerHTML="<div class='info-warnitem'><span>"+d+"</span></div>":"error"==c&&(this.infobox.innerHTML="<div class='info-erroritem'><span>"+d+"</span></div>");var e=$(this.infobox);e.css("top",b+"px"),e.css("left",a+"px"),$(this.infobox).show()},EdenUI.ScriptBox.prototype.disable=function(){if(this.outdiv){changeClass(this.outdiv,"goto",!1),this.valuedivs[this.currentstatement]=this.outdiv;var a=EdenUI.htmlForStatement(Eden.Statement.statements[this.currentstatement],30,30);this.valuedivs[this.currentstatement].innerHTML='<div class="eden-line">'+a+"</div>",changeClass(this.outdiv.parentNode,"readonly",!0),this.ast}},EdenUI.ScriptBox.prototype.enable=function(){this.outdiv&&(this.outdiv.contentEditable=!0,changeClass(this.outdiv.parentNode,"readonly",!1),this.ast&&this.highlighter.highlight(this.ast,-1,-1))},EdenUI.ScriptBox.prototype.setSource=function(a){this.intextarea.value=a,this.ast=new Eden.AST(a,void 0,EdenUI.ScriptBox.consoleAgent,{noindex:!0}),this.highlightContent(this.ast,-1,0),this.intextarea.focus(),this.ast.script&&0==this.ast.script.errors.length?changeClass(this.outdiv.parentNode,"error",!1):""==a?changeClass(this.outdiv.parentNode,"error",!1):changeClass(this.outdiv.parentNode,"error",!0),this.outdiv.contentEditable=!0},EdenUI.ScriptBox.prototype.updateLineHighlight=function(){var a=-1,b=-1;document.activeElement===this.intextarea&&(b=this.intextarea.selectionEnd,a=this.getLineNumber(this.intextarea)),this.ast=new Eden.AST(this.intextarea.value,void 0,EdenUI.ScriptBox.consoleAgent,{noindex:!0}),this.highlighter.ast=this.ast,this.runScript(a),this.highlightContent(this.ast,a,b),this.ast.script&&0==this.ast.script.errors.length?changeClass(this.outdiv.parentNode,"error",!1):changeClass(this.outdiv.parentNode,"error",!0)},EdenUI.ScriptBox.prototype.updateLineCachedHighlight=function(){var a=-1,b=-1;document.activeElement===this.intextarea&&(b=this.intextarea.selectionEnd,a=this.getLineNumber(this.intextarea)),this.highlightContent(this.ast,a,b)},EdenUI.ScriptBox.prototype.updateEntireHighlight=function(a){this.ast=new Eden.AST(this.intextarea.value,void 0,EdenUI.ScriptBox.consoleAgent,{noindex:!0}),this.highlighter.ast=this.ast;var b=-1;document.activeElement===this.intextarea&&(b=this.intextarea.selectionEnd),a&&this.runScript(0),this.highlightContent(this.ast,-1,b),this.ast.script&&0==this.ast.script.errors.length||console.log("indicated error")},EdenUI.ScriptBox.prototype.highlightContent=function(a,b,c){if(this.highlighter.highlight(a,b,c),a.mainDoxyComment&&(-1==b||b>=1&&b<=a.mainDoxyComment.endline)){var d=a.mainDoxyComment.content.match(/@[a-z]+.*\n/gi);if(d)for(var e=0;e<d.length;e++){var f=d[e].search(/\s/);if(f>=0){d[e].substring(0,f),d[e].substr(f).trim()}}}document.activeElement!==this.intextarea&&$(this.outdiv).find(".fake-caret").addClass("fake-blur-caret");var g=this;$(this.outdiv).find(".eden-number").draggable({helper:function(a){return $("<div class='eden-drag-helper'></div>")},axis:"x",distance:5,drag:function(a,b){var c;if(g.dragint?c=Math.round(g.dragvalue+(b.position.left-g.dragstart)/2):(c=g.dragvalue+.005*(b.position.left-g.dragstart),c=c.toFixed(4)),c!=g.draglast){g.draglast=c,a.target.innerHTML=""+c;var d=a.target.parentNode.textContent;"\n"==d.charAt(d.length-1)&&(d=d.slice(0,-1)),g.replaceLine(g.dragline,d),g.ast=new Eden.AST(g.intextarea.value,void 0,EdenUI.ScriptBox.consoleAgent,{noindex:!0}),g.highlighter.ast=g.ast,g.highlightContent(g.ast,g.dragline,-1),Eden.Statement.statements[g.currentstatement].setSource(g.intextarea.value,g.ast)}},start:function(a,b){g.edited=!0,g.dragline=g.findElementLineNumber(a.target),g.dragstart=b.position.left;var c=a.target.textContent;-1==c.indexOf(".")?(g.dragvalue=parseInt(c),g.dragint=!0):(g.dragvalue=parseFloat(c),g.dragint=!1),g.draglast=g.dragvalue,$(a.target).addClass("eden-select"),$(g.outdiv).css("cursor","ew-resize")},stop:function(a,b){$(a.target).removeClass("eden-select"),$(g.outdiv).css("cursor","text"),g.dragline=-1},cursor:"move",cursorAt:{top:-5,left:-5}}).click(function(){$(this).draggable({disabled:!0})}).blur(function(){$(this).draggable({disabled:!1})})},EdenUI.ScriptBox.prototype.clear=function(){this.$codearea.html(""),this.setSource("")},EdenUI.ScriptBox.prototype.getLineNumber=function(a){var b=a.value.substr(0,a.selectionStart).split("\n");return this.currentlineno=b.length,this.currentcharno=b[b.length-1].length,this.currentlineno},EdenUI.ScriptBox.prototype.doRebuild=function(){this.refreshentire?(this.updateEntireHighlight(),this.refreshentire=!1):this.updateLineHighlight()},EdenUI.ScriptBox.prototype.runScript=function(a){},EdenUI.ScriptBox.prototype.rebuild=function(){clearTimeout(this.rebuildtimer);var a=this;this.rebuildtimer=setTimeout(function(){a.doRebuild()},this.rebuildinterval)},EdenUI.ScriptBox.prototype.findElementLineNumber=function(a){for(var b=a;b.parentNode!==this.outdiv;)b=b.parentNode;for(var c=0;c<this.outdiv.childNodes.length;c++)if(this.outdiv.childNodes[c]===b)return c;return-1},EdenUI.ScriptBox.prototype.replaceLine=function(a,b){var c=this.intextarea.value.split("\n");c[a]=b,this.intextarea.value=c.join("\n")},EdenUI.Explorer=function(){var a=this;this.element=$(`<div class="explore-main">\n<div class="explore-tabs">\n\t<div class="explore-tab-container">\n\t\t<div class="explore-tab explore-tab-current" data-name="state">${Language.ui.explorer.state}</div>\n\t\t`+`\t</div>\n</div>\n<div class="explore-state">\n</div>\n<div class="explore-script" style="display: none">\n</div>\n<div class="explore-console">\n\t<div class="explore-console-buttons">\n\t\t<div style="margin-top: 4px; float: left;">${Language.ui.explorer.input}</div>\n\t\t<button class="control-button clear-button control-enabled" title="${Language.ui.tooltips.clear}" style="float: right;">&#xf05e;</button>\n\t</div>\n\t<div class="explore-console-code"></div>\n</div>\n</div>`),$("#jseden-main").append(this.element),this.consoleele=this.element.find(".explore-console-code"),this.expscripts=this.element.find(".explore-script"),this.expstate=this.element.find(".explore-state"),this.element.resizable({handles:"w",stop:function(a,b){eden.root.lookup("jseden_explorer_width").assign(b.element[0].clientWidth+2,eden.root.scope,Symbol.localJSAgent)}}),eden.root.lookup("jseden_explorer_width").assign(this.element.get(0).clientWidth+2,eden.root.scope,Symbol.localJSAgent),this.console=new EdenUI.ScriptBox(this.consoleele.get(0),{nobuttons:!0}),this.state=new EdenUI.ExplorerState(this.expstate),this.element.on("click",".clear-button",function(b){a.console.clear()}),this.element.on("click",".explore-tab",function(b){var c=b.currentTarget.getAttribute("data-name"),d=a.element.find(".explore-tab-current");d.removeClass("explore-tab-current"),d.addClass("explore-tab-notcurrent"),changeClass(b.currentTarget,"explore-tab-current",!0),changeClass(b.currentTarget,"explore-tab-notcurrent",!1),"state"==c?(a.expstate.css("display","flex"),a.expscripts.css("display","none")):"scripts"==c&&(a.expstate.css("display","none"),a.expscripts.css("display","flex"))});var b=eden.root.lookup("jseden_explorer_enabled");b.value()?a.state.show():(this.enabled=!1,this.element.hide(),a.state.hide()),b.addJSObserver("explorer",function(b,c){a.enabled=c,c?eden.root.lookup("jseden_explorer_visible").value()&&(a.element.show(),a.state.show()):(a.element.hide(),a.state.hide(),a.capture=!1)});var c=eden.root.lookup("jseden_explorer_visible");c.value()?a.state.show():(this.element.hide(),a.state.hide()),c.addJSObserver("explorer",function(b,c){c&&a.enabled?(a.element.show(),a.state.show(),eden.root.lookup("jseden_explorer_width").assign(a.element.get(0).clientWidth+2,eden.root.scope,Symbol.localJSAgent)):(a.element.hide(),a.state.capture=!1,a.state.clear(),a.state.hide(),eden.root.lookup("jseden_explorer_width").assign(0,eden.root.scope,Symbol.localJSAgent))});var d=eden.root.lookup("jseden_explorer_zoom"),e=d.value();d.addJSObserver("explorer",function(b,c){if("number"==typeof c&&c>0){var d=10*c;a.state.results.css("font-size",d+"pt")}}),void 0===e&&d.assign(1,eden.root.scope,Symbol.defaultAgent)},EdenUI.Explorer.MAXHIGHLIGHTLENGTH=1e3,EdenUI.Explorer.prototype.showConsole=function(){},EdenUI.Explorer.prototype.hideConsole=function(){},EdenUI.ExplorerState=function(a){var b=this;this.outer=a,this.controls=$(`<div class="explore-controls">\n\t\t<button class="explorer-control capture"><span class="explorer-control-icon">&#xf111;</span>${Language.ui.explorer.capture}</button>\n\t\t<button class="explorer-control clear"><span class="explorer-control-icon">&#xf05e;</span>${Language.ui.explorer.clear}</button>\n\t\t<span class="explorerfilter"><input type="text" class="explorerfilter" placeholder="${Language.ui.explorer.filter}"></input></span>\n\t</div>`),this.results=$('<div class="explore-symbols"></div>'),this.outer.append(this.controls),this.outer.append(this.results),this.searchbox=this.controls.find(".explorerfilter"),this.watchobs={},this.capture=!1,this.delay=100,this.delay2=20,this.timeout=void 0,this.timeout2=void 0,this.mode="tree",this.index={},this.todo={},this.filter=void 0,this.listener=function(a,c){var d=a.name;!b.capture||c==Symbol.EXPIRED&&void 0!==b.watchobs[d]||void 0!==b.filter&&!b.filter[d]?(b.todo[d]=!0,void 0===b.timeout2&&(b.timeout2=setTimeout(function(){b.timeout2=void 0;var a=b.todo;b.todo={};for(var c in b.index)if(a[c]){var d=eden.root.symbols[c];if(void 0===d){for(var e=0;e<b.index[c].length;e++)b.removeEntry(c,b.index[c][e]);delete b.index[c]}else for(var e=0;e<b.index[c].length;e++)b.updateEntry(d,b.index[c][e])}},b.delay2))):(void 0===b.watchobs[d]?b.watchobs[a.name]=1:b.watchobs[d].lastupdate=1,b.triggerUpdate())},this.controls.on("click",".clear",function(a){var b=eden.root.lookup("jseden_explorer_clear");b.eden_definition||b.assign(!0,eden.root.scope,Symbol.localJSAgent)}),this.controls.on("click",".capture",function(a){var b=eden.root.lookup("jseden_explorer_capture");b.eden_definition||b.assign(!b.value(),eden.root.scope,Symbol.localJSAgent)}),this.results.on("click",".explore-observable",function(a){var b=a.currentTarget.parentNode.parentNode.parentNode.getAttribute("data-obs");Eden.Selectors.goto(b+":active"),a.stopPropagation()}),this.results.on("click",".explore-expand-value",function(a){var c=a.currentTarget.parentNode.parentNode.parentNode,d=c.getAttribute("data-obs");b.updateEntry(eden.root.lookup(d),a.currentTarget.parentNode,!0)}),this.results.on("click",".eden-path",function(a){var b=a.currentTarget.textContent;edenUI.gotoCode(b,-1)}),this.results.on("click",".symvalue",function(a){}),this.results.on("click",".explore-entry-icon",function(a){var c=a.currentTarget.parentNode.parentNode.parentNode,d=c.getAttribute("data-obs");if("true"==c.getAttribute("data-expanded")){a.currentTarget.innerHTML="&#xf067;",c.setAttribute("data-expanded","false");for(var e=c.firstChild;e;){var f=e.nextSibling;"DIV"==e.nodeName&&"explore-entry-inner"!=e.className&&0==e.className.includes("active")&&c.removeChild(e),e=f}}else{a.currentTarget.innerHTML="&#xf068;",c.setAttribute("data-expanded","true");for(var g=eden.root.symbols[d],h={},e=c.firstChild;e;)"DIV"==e.nodeName&&(h[e.getAttribute("data-obs")]=!0),e=e.nextSibling;for(var i in g.dependencies)if(!h[i]){var j=g.dependencies[i],k=!j,l=j&&j.definition,d=i,m=$('<div class="explore-entry'+(k?" missing":"")+(l?" defined":"")+'" data-obs="'+d+'"><div class="explore-entry-inner"><span><span class="explore-entry-icon">'+(l?"&#xf067;":" ")+'</span><span class="explore-observable">'+d+'</span> </span><div class="symvalue"></div></div></div>'),n=m.find(".symvalue").get(0);b.updateEntry(j,n),void 0===b.index[d]&&(b.index[d]=[]),b.index[d].push(n),c.appendChild(m.get(0))}}});var c=eden.root.lookup("jseden_explorer_search");c.value()&&this.searchbox.val(searchval),c.addJSObserver("explorer",function(a,c){void 0!==c&&"*JavaScript"!=a.origin.name&&b.searchbox.val(c)}),this.searchbox.on("keyup",function(a){void 0===c.definition&&c.assign(a.target.value,eden.root.scope,Symbol.localJSAgent)});var d=eden.root.lookup("jseden_explorer_watch"),e=d.value();Array.isArray(e)&&(this.clear(),this.watch(e)),d.addJSObserver("explorer",function(a,c){Array.isArray(c)&&(b.capture?b.filter=void 0:b.clear(),b.watch(c))});var f=eden.root.lookup("jseden_explorer_capture");f.addJSObserver("explorer",function(a,c){c?(b.record(),b.controls.find(".capture").addClass("active")):(b.capture=!1,b.controls.find(".capture").removeClass("active"))}),f.value()&&b.record(),eden.root.lookup("jseden_explorer_clear").addJSObserver("explorer",function(a,c){c&&b.clear()})},EdenUI.ExplorerState.prototype.show=function(){eden.root.addGlobal(this.listener)},EdenUI.ExplorerState.prototype.hide=function(){eden.root.removeGlobal(this.listener)},EdenUI.ExplorerState.prototype.triggerUpdate=function(){if(void 0===this.timeout){var a=this;this.timeout=setTimeout(function(){a.index={},a.timeout=void 0,"list"==a.mode?a.updateList():"tree"==a.mode?a.updateTree():"graph"==a.mode&&a.updateGraph()},this.delay)}},EdenUI.ExplorerState.prototype.updateList=function(){},EdenUI.ExplorerState.prototype.makeAgentEntry=function(a){var b=a.name;if(b.startsWith("*Console"))return $('<div class="explore-entry"><span class="explore-entry-icon">&#xf108;</span> <b>console</b></div>');if(b.startsWith("*When")){var c=b.split(":"),d=c[1].split("/");return d=d[d.length-1],c=d+":"+c[2],$('<div class="explore-entry"><span class="explore-entry-icon">&#xf183;</span><span class="eden-keyword">when</span> <span class="eden-path">'+c+"</span></div>")}if(b.startsWith("*Action")){var c=b.split(":"),d=c[1].split("/");return d=d[d.length-1],c=d+":"+c[2],$('<div class="explore-entry"><span class="explore-entry-icon">&#xf183;</span><span class="eden-keyword">action</span> <span class="eden-path">'+c+"</span></div>")}if("/"==b.charAt(0)){if(a.eden_definition&&a.eden_definition.startsWith("proc"))return $('<div class="explore-entry"><span class="explore-entry-icon">&#xf183;</span><span class="eden-keyword">proc</span> <span class="eden-path">'+b+"</span></div>")}else if("*"!=b.charAt(0))return $('<div class="explore-entry"><span class="explore-entry-icon">&#xf15c;</span><span class="eden-path">'+b+"</span></div>")},EdenUI.ExplorerState.prototype.removeEntry=function(a,b){b.innerHTML='<span style="font-weight: bold; color: red">DELETED</span>',delete this.watchobs[a],this.triggerUpdate()},EdenUI.ExplorerState.prototype.updateEntry=function(a,b,c){if(a){var d,e,f=a.value();if("function"==typeof f)e='<span class="eden-keyword">func</span>';else{if(c){var g=Eden.edenCodeForValue(f,void 0,2);d=g.length<EdenUI.Explorer.MAXHIGHLIGHTLENGTH?EdenUI.Highlight.html(g,!0):g}else if(Array.isArray(f)&&f.length>2)d='[.. <span class="explore-expand-value">&#xf0fe;</span> ..]';else{var g=Eden.edenCodeForValue(f,void 0,2);d=g.length<EdenUI.Explorer.MAXHIGHLIGHTLENGTH?EdenUI.Highlight.html(g,!0):g}e=(a.eden_definition?'<span class="eden-keyword">is</span>':"<b>=</b>")+" "+d}b.innerHTML=e}},EdenUI.ExplorerState.prototype.makeEntry=function(a,b,c){var d=eden.root.symbols[a],e=!1,f=!1;d&&d.definition&&(f=!0),d||(e=!0);var g=$('<div class="explore-entry'+(c?" active":"")+(e?" missing":"")+(f?" defined":"")+'" data-obs="'+a+'"><div class="explore-entry-inner"><span><span class="explore-entry-icon">'+(f?"&#xf067;":" ")+'</span><span class="explore-observable">'+a+'</span> </span><div class="symvalue"></div></div></div>'),h=g.find(".symvalue").get(0);f&&d.origin&&(g.get(0).title=d.origin.getSource()),this.updateEntry(d,h),void 0===this.index[a]&&(this.index[a]=[]),this.index[a].push(h);var i=0;if(b)for(var j in b)i++,g.append(this.makeEntry(j,b[j],c));return g},EdenUI.ExplorerState.prototype.updateTree=function(){var a=this.capture?Eden.Query.dependencyTree(this.watchobs):this.watchobs;this.results.html("");for(var b in a)this.results.append(this.makeEntry(b,this.capture?a[b]:void 0,this.capture))},EdenUI.ExplorerState.prototype.watch=function(a){this.capture,void 0===this.filter&&a.length>0&&(this.filter={});for(var b=0;b<a.length;b++)void 0!==a[b]&&(this.filter[a[b]]=!0,this.capture||(this.watchobs[a[b]]={elements:[],lastupdate:1}));this.triggerUpdate()},EdenUI.ExplorerState.prototype.record=function(){this.watchobs={},this.triggerUpdate(),this.capture=!0},EdenUI.ExplorerState.prototype.clear=function(){this.watchobs={},this.filter=void 0,this.triggerUpdate()},EdenUI.ExplorerState.prototype.displayAsTree=function(){},EdenUI.ExplorerState.prototype.displayAsList=function(){},EdenUI.ExplorerState.prototype.displayAsGraph=function(){},EdenUI.ExplorerState.prototype.search=function(a){},EdenUI.ExplorerScripts=function(a){this.outer=a,this.controls=$('<div class="explore-controls">\t\t<span class="explorerfilter"><input type="text" class="explorerfilter" placeholder="Filter..."></input></span>\t</div>'),this.scripts=$('<div class="explore-scripts"></div>'),this.outer.append(this.controls),this.outer.append(this.scripts)},EdenUI.ExplorerScripts.prototype.buildScriptTree=function(a){for(var b={},c=0;c<a.length;c++)for(var d=a[c].split(/[\.\:]+/),e=b,f=0;f<d.length;f++)void 0===e[d[f]]&&(e[d[f]]={}),e=e[d[f]];return b},EdenUI.ExplorerScripts.prototype.makeEntry=function(a,b){for(var c in b){var d=$('<div class="explore-sentry"><div class="explore-script-inner"><span class="explore-entry-icon">&#xf067;</span>'+c+"</div></div>");this.makeEntry(d,b[c]),a.append(d)}},EdenUI.ExplorerScripts.prototype.update=function(){this.scripts.html("");var a=Eden.Selectors.query(">> script:has-name","id"),b=this.buildScriptTree(a),c=[],d=[];for(var e in Eden.Selectors.cache)d.push(e),c.push(Eden.Selectors.cache[e]);a=Eden.Selectors.queryWithin(c,">> script:has-name","id"),a.push.apply(a,d);var f={External:this.buildScriptTree(a)};this.makeEntry(this.scripts,b),this.makeEntry(this.scripts,f)},EdenUI.Markdown=function(a){this.contents=document.createElement("div"),this.contents.className="markdown-inputhider",this.intextarea=document.createElement("textarea"),this.intextarea.autofocus=!0,this.intextarea.tabIndex=1,this.intextarea.className="hidden-textarea2",this.intextarea.value=a,this.contents.appendChild(this.intextarea),this.codearea=document.createElement("div"),this.codearea.className="markdown-inputCodeArea",this.contents.appendChild(this.codearea),this.outdiv=document.createElement("div"),this.outdiv.contentEditable=!0,this.outdiv.className="markdown-outputcontent",this.outdiv.spellcheck=!1,this.outdiv.tabIndex=2,this.codearea.appendChild(this.outdiv),this.highlighter=new EdenUI.Highlight(this.outdiv,{start:"MARKDOWN",styles:EdenUI.Markdown.styles,clearmodes:{SECTION_TITLE:!0,SECTION_TITLE2:!0,SECTION_TITLE_H1:!0,SECTION_TITLE_H2:!0,COMMENT_BOLD:!0,COMMENT_CODE:!0,COMMENT_ICON:!0,COMMENT_EMPH:!0,COMMENT_ITALIC:!0,END_COMMENT_TAG:!0,COMMENT_TAG:!0,COMMENT_LINK:!0,COMMENT_LINK_END:!0},brline:!0});new EdenUI.ScriptArea.Keyboard(this),new EdenUI.ScriptArea.Mouse(this);this.updateLineCachedHighlight()},EdenUI.Highlight.prototype.MARKDOWN=function(){"#"==this.token&&(this.stream.position-2<=0||"\n"==this.stream.code.charAt(this.stream.position-2))?(this.classes.push("hidden-comment"),this.mode="SECTION_TITLE",this.lineelement.className=this.styles["comment-line"]):"##"==this.token&&(this.stream.position-3<=0||"\n"==this.stream.code.charAt(this.stream.position-3))?(this.classes.push("hidden-comment"),this.mode="SECTION_TITLE2",this.lineelement.className=this.styles["comment-line"]):this.COMMENT()},EdenUI.Markdown.styles={comment:"",
"hidden-comment":"markdown-comment-hidden",operator:"eden-operator",observable:"eden-observable",storage:"eden-storage",number:"eden-number",string:"eden-string",constant:"eden-constant",string:"eden-string",keyword:"eden-keyword",javascript:"eden-javascript",selector:"eden-selector",selector2:"eden-selector2",selector3:"eden-selector3",function:"eden-function",type:"eden-type",special:"eden-special",backticks:"eden-backticks",doxycomment:"eden-doxycomment",pathblock:"eden-pathblock","comment-h1":"markdown-comment-h1","comment-h2":"markdown-comment-h2","comment-h3":"eden-comment-h3","horizontal-line":"eden-section-line","comment-line":"eden-comment-line","comment-emph":"eden-comment-emph","comment-bold":"eden-comment-bold","script-line":"markdown-comment-line",doxytag:"markdown-tag","comment-query":"eden-comment-query","block-comment":"eden-blockcomment","comment-ul":"eden-comment-ul","comment-blockquote":"eden-comment-blockquote",script:"eden-script"},EdenUI.Markdown.prototype.getLineNumber=function(){var a=this.intextarea.value.substr(0,this.intextarea.selectionStart).split("\n");return this.currentlineno=a.length,this.currentcharno=a[a.length-1].length,this.currentlineno},EdenUI.Markdown.prototype.hideInfoBox=function(){},EdenUI.Markdown.prototype.disableGotoMode=function(){},EdenUI.Markdown.prototype.rebuild=function(){this.updateLineCachedHighlight()},EdenUI.Markdown.prototype.updateLineCachedHighlight=function(){var a=new Eden.AST(this.intextarea.value,void 0,{},{noparse:!0,noindex:!0}),b=-1;document.activeElement===this.intextarea&&(b=this.intextarea.selectionEnd,this.getLineNumber(this.intextarea)),this.highlighter.highlight(a,-1,b)},EdenUI.Markdown.prototype.setValue=function(a){this.intextarea.value=a,this.updateLineCachedHighlight()},EdenUI.Markdown.prototype.moveCaret=function(){this.updateLineCachedHighlight()},EdenUI.Markdown.prototype.checkScroll=function(){},EdenUI.Markdown.prototype.enableGotoMode=function(){},EdenUI.Markdown.prototype.focusText=function(){var a=getCaretCharacterOffsetWithin(this.outdiv),b=getStartCaretCharacterOffsetWithin(this.outdiv);this.intextarea.focus(),this.intextarea.selectionEnd=a,this.intextarea.selectionStart=b},EdenUI.Markdown.prototype.focusOutput=function(){this.setCaretToFakeCaret(),this.outdiv.focus()},EdenUI.Markdown.prototype.setCaretToFakeCaret=function(){var a=$(this.outdiv).find(".fake-caret").get(0);if(a){var b=document.createRange(),c=window.getSelection();a.nextSibling&&(a=a.nextSibling),b.setStart(a,0),b.collapse(!0),c.removeAllRanges(),c.addRange(b),$(this.outdiv).remove(".fake-caret")}},EdenUI.Markdown.html=function(a,b,c){var d=document.createElement("div"),e=new EdenUI.Highlight(d,{start:"MARKDOWN",styles:EdenUI.Markdown.styles,clearmodes:{SECTION_TITLE:!0,SECTION_TITLE2:!0,SECTION_TITLE_H1:!0,SECTION_TITLE_H2:!0,COMMENT_BOLD:!0,COMMENT_CODE:!0,COMMENT_ICON:!0,COMMENT_EMPH:!0,COMMENT_ITALIC:!0,END_COMMENT_TAG:!0,COMMENT_TAG:!0,COMMENT_LINK:!0,COMMENT_LINK_END:!0},brline:!0});if(EdenUI.Markdown.styles["hidden-comment"]="eden-comment-hidden",EdenUI.Markdown.styles["script-line"]="markdown-comment-line2",e.ast={stream:new EdenStream(a)},e.highlight(e.ast,-1,-1,void 0),EdenUI.Markdown.styles["hidden-comment"]="markdown-comment-hidden",EdenUI.Markdown.styles["script-line"]="markdown-comment-line",b)return d.childNodes[0].innerHTML;for(var f="",g=0;g<d.childNodes.length;g++)f+=d.childNodes[g].innerHTML;return c?'<div style="display: flex; align-items: center;"><div class="eden-hl-play" data-src="'+a+'">&#xf04b;</div><div>'+f+"</div></div>":f},EdenUI.ProjectDetails=function(a,b){var c=this;this.projectid=a,this.meta=void 0,this.newtab=b;var d=mobilecheck();this.obscurer=$('<div class="modal" style="display: block;"></div>'),this.obscurer.on("click",function(a){a.target===a.currentTarget&&c.remove()}),this.dialog=d?$('<div class="modal-content"></div>'):$('<div class="modal-content" style="width: 600px"></div>'),this.obscurer.append(this.dialog),document.body.appendChild(this.obscurer.get(0)),Eden.DB.getMeta(a,function(b){if(console.log("DETAILS META",b),null!==b[0].image){var d=$('<img class="projectdetails-thumb" src="'+b[0].image+'"></img>');c.dialog.append(d)}console.log(b[0].projectMetaData);var e=null!==b[0].projectMetaData?JSON.parse(b[0].projectMetaData):{},f=document.createElement("div");f.className="markdown";var g=new showdown.Converter,h=e&&e.description?e.description.replace(/\@author[^\n]*/g,"").replace(/\s(#[a-zA-Z0-9]+)/g,' <span class="markdown-hashtag">$1</span>'):"",i=b[0].ownername;if(e&&e.description){var j=new Eden.AST.DoxyComment(e.description,0,0),k=j.getProperty("author");if(k&&k.length>0){if(i=k[0]+(k.length>1?" et al.":""),k.length>1){h+="\n\n__Authors:__";for(var l=0;l<k.length;l++)h+=" "+k[l],l<k.length-1&&(h+=",")}k[0]!=b[0].ownername&&(h+="\n\n__Published by:__ "+b[0].ownername)}else i=b[0].ownername}var m=g.makeHtml(h);f.innerHTML=m,c.dialog.get(0).appendChild(f);var n=b[0].date.split(/[- :]/),o=null!==b[0].overallRating?b[0].overallRating/b[0].numRatings:0,p=$('<div class="projectdetails">\t\t\t<span class="projectdetails-rateavg">'+o.toFixed(1)+'</span><span><span class="projectdetails-label">by:</span><span class="projectdetails-value">'+i+'</span></span>\t\t\t<span>, <span class="projectdetails-value">'+get_time_diff(new Date(n[0],n[1]-1,n[2],n[3],n[4],n[5]).getTime()/1e3)+"</span></span>\t\t</div>"),q=$('<div class="projectdetails-rating"><span class="projectdetails-star">&#xf005;</span><span class="projectdetails-star">&#xf005;</span><span class="projectdetails-star">&#xf005;</span><span class="projectdetails-star">&#xf005;</span><span class="projectdetails-star">&#xf005;</span></div>');c.dialog.append(q),c.dialog.append(p),q.on("click",".projectdetails-star",function(b){if(0!=Eden.DB.isLoggedIn()){for(var c=b.currentTarget.parentNode,d=0,e=0;e<5;e++)c.childNodes[e].className="projectdetails-star"+(d>0?"":" selected"),c.childNodes[e].innerHTML="&#xf005;",c.childNodes[e]===b.currentTarget&&(d=e+1);Eden.DB.rate(a,d)}});var r=q[0];if(o)for(var s=Math.floor(o),l=0;l<5;l++)r.childNodes[l].className="projectdetails-star"+(l>=s?"":" average"),r.childNodes[l].innerHTML="&#xf005;";var t=b[0].myrating;if(t)for(var l=0;l<5;l++)r.childNodes[l].className="projectdetails-star"+(l>=t?"":" selected"),r.childNodes[l].innerHTML="&#xf005;";var u;u=b[0].owner==Eden.DB.userid?$('<div class="projectdetails-buttons"><button class="openproject script-button"><span class="explorer-control-icon">&#xf04b;</span>Open</button><button class="restoreproject script-button"><span class="explorer-control-icon">&#xf040;</span>Maker</button><button class="deleteproject script-button"><span class="explorer-control-icon">&#xf00d;</span>Delete</button><br></div>'):$('<div class="projectdetails-buttons"><button class="openproject script-button"><span class="explorer-control-icon">&#xf04b;</span>Open</button><button class="restoreproject script-button"><span class="explorer-control-icon">&#xf040;</span>Maker</button><button class="followproject script-button" style="float: right"><span class="explorer-control-icon">&#xf09e;</span>Follow</button><br></div>'),u.on("click",".openproject",function(){c.remove(),c.newtab?window.open(window.location.origin+window.location.pathname+"?load="+a):($(".loadmodal").show(),Eden.Project.load(a))}),u.on("click",".deleteproject",function(){confirm("Are you sure you want to delete this project?")&&(c.remove(),Eden.DB.remove(a))}),u.on("click",".restoreproject",function(){c.remove(),eden.root.lookup("jseden_project_mode").assign("restore",eden.root.scope,Symbol.defaultAgent),Eden.Project.load(a)}),u.on("click",".followproject",function(b){Eden.DB.follow(a,function(a){a&&b.currentTarget.parentNode.removeChild(b.currentTarget)})}),u.append($('<iframe src="https://www.facebook.com/plugins/like.php?href='+encodeURIComponent(window.location.href+"?load="+a)+'&width=350&layout=standard&action=like&size=small&show_faces=false&share=true&height=80&appId=1447073055317881" width="300" height="20" style="border:none;overflow:hidden;margin-left:5px;margin-top:5px;" scrolling="no" frameborder="0" allowTransparency="true"></iframe>')),c.dialog.append(u),Eden.DB.search(":parent("+a+")",1,1,void 0,function(b){if(b.length>0){var d=document.createElement("div");d.className="projectdetails-forks";for(var e=0;e<b.length;e++){var g=document.createElement("div");g.className="projectdetails-fork";var h=b[e].date.split(/[- :]/);g.innerHTML='Forked as "'+b[e].title+'" by '+b[e].ownername+" "+get_time_diff(new Date(h[0],h[1]-1,h[2],h[3],h[4],h[5]).getTime()/1e3),d.appendChild(g)}c.dialog.get(0).insertBefore(d,f.nextSibling)}Eden.DB.searchComments({id:a},"",1,3,void 0,function(a){var b=new showdown.Converter;if(a.length>0){var d=document.createElement("div");d.style.borderTop="1px solid #aaa",d.style.height="10px",c.dialog.get(0).appendChild(d)}for(var e=0;e<a.length;e++){var f=document.createElement("div"),g=document.createElement("div"),h=a[e].date.split(/[- :]/);g.className="feedback-header",g.innerHTML='<span class="feedback-author">'+a[e].name+'</span><span class="feedback-date" data-date="'+a[e].date+'">'+get_time_diff(new Date(h[0],h[1]-1,h[2],h[3],h[4],h[5]).getTime()/1e3)+"</span>",f.appendChild(g);var i=document.createElement("div");i.style.padding="0",i.style.marginBottom="3px",i.className="markdown",f.appendChild(i),f.className="feedback-result",i.innerHTML=b.makeHtml(a[e].comment),c.dialog.get(0).appendChild(f)}})})})},EdenUI.ProjectDetails.prototype.remove=function(){document.body.removeChild(this.obscurer.get(0))},EdenUI.ProjectDetails.searchProjects=function(a,b,c,d,e,f){var g=c||7,h=1;a.on("click",".more",function(c){a.find(".more").remove(),h++,Eden.DB.search(b,h,g,f,function(c){EdenUI.ProjectDetails._searchProjects(b,a,!b.startsWith(":me"),c,g,h,e)}),c.stopPropagation()}),b||(b=""),Eden.DB.search(b,1,g,f,function(c){EdenUI.ProjectDetails._searchProjects(b,a,!b.startsWith(":me"),c,g,h,e),d&&d(c)})},EdenUI.ProjectDetails._searchProjects=function(a,b,c,d,e,f,g){var h=e||7;if(void 0!==d){for(var i=mobilecheck()?120:200,j=0;j<d.length;j++){var k,l=d[j],m=l.date.split(/[- :]/),n=l.title,o=l.image,p=!1,q=null!==l.projectMetaData?JSON.parse(l.projectMetaData):void 0;if(c)if(q&&q.description){var r=new Eden.AST.DoxyComment(q.description,0,0),s=r.getProperty("author");k=s&&s.length>0?s[0]:l.ownername}else k=l.ownername;else k=get_time_diff(new Date(m[0],m[1]-1,m[2],m[3],m[4],m[5]).getTime()/1e3),null===l.publicVersion&&(p=!0);var t;t=null!==o?$('<div class="cadence-plisting-entry project noselect'+(p?" locked":"")+'" data-pid="'+l.projectID+'"><div class="cadence-plisting-img"><img width="'+i+'" src="'+o+'"></img></div><div class="cadence-plisting-title">'+n+'</div><div class="cadence-plisting-subtitle">'+k+"</div></div>"):$('<div class="cadence-plisting-entry project noselect'+(p?" locked":"")+'" data-pid="'+l.projectID+'"><div class="cadence-plisting-icon">&#xf0c3;</div><div class="cadence-plisting-title">'+n+'</div><div class="cadence-plisting-subtitle">'+k+"</div></div>"),b.append(t),t.click(function(a){var b=a.currentTarget.getAttribute("data-pid");console.log("Load project: "+b),new EdenUI.ProjectDetails(b,g)});var u=null!==l.overallRating?l.overallRating/l.numRatings:0,v=$('<div class="projectdetails-ratingsmall"><span class="projectdetails-star">&#xf005;</span><span class="projectdetails-star">&#xf005;</span><span class="projectdetails-star">&#xf005;</span><span class="projectdetails-star">&#xf005;</span><span class="projectdetails-star">&#xf005;</span></div>');t.append(v);var w=v.get(0);if(u)for(var x=Math.floor(u),y=0;y<5;y++)w.childNodes[y].className="projectdetails-star"+(y>=x?"":" average")}d.length==h&&b.append($('<div class="cadence-plisting-entry more noselect"><div class="cadence-plisting-icon more">&#xf103;</div></div>'))}},EdenUI.ProjectDetails.localProjects=function(a,b,c){if(void 0!==b)for(var d=0;d<b.length;d++){var e,f=b[d],g=f.title,h=f.image;if(f.description){var i=new Eden.AST.DoxyComment(f.description,0,0),j=i.getProperty("author");e=j&&j.length>0?j[0]:f.author}else e=f.author;var k;k=null!==h?$('<div class="cadence-plisting-entry project noselect" data-path="'+f.name+'"><div class="cadence-plisting-img"><img src="'+h+'"></img></div><div class="cadence-plisting-title">'+g+'</div><div class="cadence-plisting-subtitle">'+e+"</div></div>"):$('<div class="cadence-plisting-entry project noselect" data-path="'+f.name+'"><div class="cadence-plisting-icon">&#xf0c3;</div><div class="cadence-plisting-title">'+g+'</div><div class="cadence-plisting-subtitle">'+e+"</div></div>"),a.append(k),k.click(function(a){var b=a.currentTarget.getAttribute("data-path");console.log("Load project: "+b),Eden.Project.newFromExisting(b,function(){})});var l=f.rating;if(l){var m=$('<div class="projectdetails-ratingsmall">\t<span class="projectdetails-star">&#xf005;</span>\t<span class="projectdetails-star">&#xf005;</span>\t<span class="projectdetails-star">&#xf005;</span>\t<span class="projectdetails-star">&#xf005;</span>\t<span class="projectdetails-star">&#xf005;</span>\t</div>');k.append(m);var n=m.get(0);if(l)for(var o=Math.floor(l),p=0;p<5;p++)n.childNodes[p].className="projectdetails-star"+(p>=o?"":" average")}}},EdenUI.Feedback=function(){function a(a,b){if(b)f.odialog.style.display="initial",f.clear(),f.updateComments(""),clearInterval(f.interval),f.interval=setInterval(function(){f.updateComments("")},5e3);else{f.odialog.style.display="none",clearInterval(f.interval);var c;f.interval=setInterval(function(){Eden.DB.searchComments(eden.project,"",1,10,c,function(a){if(void 0===c&&a.length>0)return void(c=a[0].commentID);for(var b=0;b<a.length;b++)edenUI.menu.notifications.notification("comment","New comment by "+a[b].name);a.length>0&&(c=a[0].commentID)})},1e4)}}var b=document.createElement("div");b.className="feedback-icon noselect",b.innerHTML="&#xf0e6;",b.title="Comments",document.getElementById("jseden-views").appendChild(b),this.odialog=document.createElement("div"),this.odialog.className="feedback-dialog",this.odialog.style.display="none",document.getElementById("jseden-views").appendChild(this.odialog),this.dialog=document.createElement("div"),this.dialog.className="feedback-scroller",this.odialog.appendChild(this.dialog);var c=document.createElement("div");c.className="feedback-title",c.innerHTML='<span class="feedback-icon2">&#xf0e6;</span><span class="feedback-title-text">Comments</span><span class="feedback-close">&#xf00d;</span>',this.dialog.appendChild(c);var d=eden.root.lookup("jseden_feedback_visible"),e=eden.root.lookup("jseden_feedback_width"),f=this;b.addEventListener("click",function(a){void 0===d.definition&&d.assign(!0,eden.root.scope,Symbol.hciAgent)}),c.childNodes[2].addEventListener("click",function(a){void 0===d.definition&&d.assign(!1,eden.root.scope,Symbol.hciAgent)}),e.assign(420,eden.root.scope,Symbol.defaultAgent),d.addJSObserver("feedback",a),a(d,d.value());var g=new EdenUI.Markdown(""),h=document.createElement("div");h.className="feedback-input",h.appendChild(g.contents);var i=document.createElement("div");i.className="feedback-buttons";var j=document.createElement("div");j.textContent="Sign-in to post a comment...",j.style.display="none",j.className="feedback-signinmsg",this.dialog.appendChild(j),Eden.DB.isLoggedIn()||(h.style.display="none",i.style.display="none",j.style.display="block"),this.dialog.appendChild(h),this.dialog.appendChild(i),this.results=document.createElement("div"),this.dialog.appendChild(this.results),this.results.addEventListener("click",function(a){"feedback-delete"==a.srcElement.className?(console.log("delete",a.srcElement.getAttribute("data-id")),Eden.DB.removeComment(a.srcElement.getAttribute("data-id")),f.results.removeChild(a.srcElement.parentNode.parentNode)):"eden-hl-play"==a.srcElement.className&&(console.log("PLAY COMMENT",a.srcElement.getAttribute("data-src")),eden.execute2(a.srcElement.getAttribute("data-src")))});var k=document.createElement("button");k.className="script-button",k.textContent="Comment",i.appendChild(k),k.addEventListener("click",function(){Eden.DB.postComment(eden.project,g.intextarea.value),g.setValue(""),f.updateComments("")}),this.cache=[],setInterval(function(){f.updateTimes()},2e4),Eden.DB.listenTo("login",this,function(a){a&&(h.style.display="block",i.style.display="block",j.style.display="none")})},EdenUI.Feedback.prototype.clear=function(){for(this.cache=[];this.results.lastChild;)this.results.removeChild(this.results.lastChild)},EdenUI.Feedback.prototype.updateTimes=function(){for(var a=0;a<this.results.childNodes.length;a++){var b=this.results.childNodes[a].childNodes[0].childNodes[1],c=b.getAttribute("data-date"),d=c.split(/[- :]/);b.textContent=get_time_diff(new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5]).getTime()/1e3)}},EdenUI.Feedback.prototype.updateComments=function(a){var b=this,c=new showdown.Converter,d=this.cache.length>0?this.cache[0].commentID:void 0,e=this.results.firstChild;Eden.DB.searchComments(eden.project,a,1,100,d,function(a){if(a)for(var f=0;f<a.length;f++){var g=document.createElement("div"),h=document.createElement("div"),i=a[f].date.split(/[- :]/);h.className="feedback-header",h.innerHTML='<span class="feedback-author">'+a[f].name+'</span><span class="feedback-date" data-date="'+a[f].date+'">'+get_time_diff(new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]).getTime()/1e3)+(a[f].author==Eden.DB.userid?'</span><span class="feedback-delete" data-id="'+a[f].commentID+'">&#xf00d;</span>':""),g.appendChild(h);var j=document.createElement("div");j.style.padding="0",j.style.marginBottom="3px",j.className="markdown",g.appendChild(j),g.className="feedback-result"+(d?" newitem":""),j.innerHTML=c.makeHtml(a[f].comment),e?b.results.insertBefore(g,e):b.results.appendChild(g),$(j).find("code").each(function(a,b){"PRE"==b.parentNode.nodeName&&(b.innerHTML=EdenUI.Highlight.html(b.textContent,!1,!0))})}b.cache=a.concat(b.cache)})};