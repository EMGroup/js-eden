function getCaretCharacterOffsetWithin(a){var b,c=0,d=a.ownerDocument||a.document,e=d.defaultView||d.parentWindow;if("undefined"!=typeof e.getSelection){if(b=e.getSelection(),b.rangeCount>0){var f=e.getSelection().getRangeAt(0),g=f.cloneRange();g.selectNodeContents(a),g.setEnd(f.endContainer,f.endOffset),c=g.toString().length}}else if((b=d.selection)&&"Control"!=b.type){var h=b.createRange(),i=d.body.createTextRange();i.moveToElementText(a),i.setEndPoint("EndToEnd",h),c=i.text.length}return c}function getStartCaretCharacterOffsetWithin(a){var b,c=0,d=a.ownerDocument||a.document,e=d.defaultView||d.parentWindow;if("undefined"!=typeof e.getSelection){if(b=e.getSelection(),b.rangeCount>0){var f=e.getSelection().getRangeAt(0),g=f.cloneRange();g.selectNodeContents(a),g.setEnd(f.startContainer,f.startOffset),c=g.toString().length}}else if((b=d.selection)&&"Control"!=b.type){var h=b.createRange(),i=d.body.createTextRange();i.moveToElementText(a),i.setEndPoint("EndToEnd",h),c=i.text.length}return c}function EdenHighlight(a){this.ast=void 0,this.outelement=a,this.line=1,this.currentline=-1}function _formatVal(a){var b=Eden.prettyPrintValue("",a,200,!1,!1);switch(typeof a){case"boolean":return"<span class='special_text'>"+b+"</span>";case"undefined":return"<span class='error_text'>@</span>";case"string":return"<span class='string_text'>"+b+"</span>";case"number":return"<span class='numeric_text'>"+b+"</span>";default:return b}}function _formatFramerVal(a){var b=Eden.prettyPrintValue("",a,200,!1,!1);switch(typeof a){case"boolean":return"<span class='special_text'>"+b+"</span>";case"undefined":return"<span class='error_text'>@</span>";case"string":return"<span class='string_text'>"+b+"</span>";case"number":return"<span class='numeric_text'>"+b+"</span>";default:return b}}"time"in console||(console.time=function(a){},console.endTime=function(a){}),EdenUI.plugins.ScriptInput=function(a,b){function c(a,b,c){var g=typeof a;switch(g){case"number":return e(a,b,c);case"string":return f(a,b,c);case"object":return h(a,b,c);case"function":return d(a,b,c)}}function d(a,b,c){var d=c.name.substr(1);if(edenfunctions.functions[d]){var e=Object.keys(edenfunctions.functions[d].parameters||{});d+="("+e.join(", ")+")";var f=$("<div class='eden-representative'></div>");return f.css("font-size",""+Math.round(.2*b)+"px"),f.text(d),f}}function e(a,b,c){var d=$("<span class='eden-representative'></span>");return a%1===0?d.text(""+a):d.text(""+a.toFixed(2)),d}function f(a,b,c){if(i[a])return g(a,b,c);var d=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a);if(d)return g(a,b,c);if(d=/^rgb\(.*/i.test(a))return g(a,b,c);var e=$("<span class='eden-representative'></span>");return e.css("font-weight","normal"),e.css("color","red"),e.text('"'+a+'"'),e}function g(a,b,c){var d=$("<span class='eden-representative'></span>");return d.css("width",""+Math.round(b)),d.css("height",""+Math.round(b)),d.css("background-color",a),d}function h(a,b,d){if(a instanceof Rectangle){var e=$("<canvas width='"+b+"' height='"+b+"'></canvas>"),f=e.get(0),g=f.getContext("2d"),h=Math.max(a.width,a.height),i=b/h;g.scale(i,i);var j=a.x,k=a.y;return a.x=0,a.y=0,a.draw(g),a.x=j,a.y=k,e}if(a instanceof Line){var e=$("<canvas width='"+b+"' height='"+b+"'></canvas>"),f=e.get(0),g=f.getContext("2d"),l=a.x2-a.x1,m=a.y2-a.y1;if(m>l){var i=b/m;m=b,l*=i}else{var i=b/l;l=b,m*=i}var j=a.x1,k=a.y1,n=a.x2,o=a.y2;return a.x1=b/2-l/2,a.y1=b/2-m/2,a.x2=b/2+l/2,a.y2=b/2+m/2,a.draw(g),a.x1=j,a.y1=k,a.x2=n,a.y2=o,e}if(a instanceof HTMLImage){var h=Math.max(a.width,a.height),i=b/h,p=$("<img src='"+a.url+"' width='"+Math.round(a.width*i)+"' height='"+Math.round(a.height*i)+"'></img>");return p}if(a instanceof Array){var q=$("<span class='eden-representative'><span>[</span></span>"),r=a.length;r>10&&(r=10);for(var s=0;r>s;s++){var t=c(a[s],b,d);t&&t.appendTo(q),s<a.length-1&&$("<span>,</span>").appendTo(q)}return r<a.length&&$("<span>...</span>").appendTo(q),$("<span>]</span>").appendTo(q),q}}EdenUI.plugins.ScriptInput.title=Language.ui.input_window.title,EdenUI.plugins.ScriptInput.description=Language.ui.input_window.description;var i={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},j=this,k={name:Symbol.getInputAgentName()};this.history=[],this.index=0,this.autoexec=!0,this.history=JSON.parse(a.getOptionValue("history"))||[],this.index=this.history.length,this.addHistory=function(b){this.history.push(b),this.index=this.history.length,a.setOptionValue("history",JSON.stringify(this.history.slice(-50)))},this.getHistory=function(a){return 0==j.history.length?"":j.history[this.index]},this.previousHistory=function(){return this.index<=0&&(this.index=1),this.index>j.history.length&&(this.index=j.history.length),this.getHistory(--this.index)},this.nextHistory=function(){return this.index<0&&(this.index=0),this.index>=j.history.length-1?(this.index++,""):this.getHistory(++this.index)};var l=void 0;this.submitEdenCode=function(b){this.addHistory(b),console.time("submitEdenCode"),a.eden.execute(b,"input","",k),console.timeEnd("submitEdenCode"),void 0!==l&&l.html(this.generateHistory())};this.generateHistory=function(){result="";for(var a=0;a<j.history.length;a++){var b="input-history-line";result=result+'<div class="'+b+'"><p style="word-wrap: break-word;">'+Eden.htmlEscape(j.history[a])+"</p></div>"}return result},this.createHistory=function(b,c){l=$('<div id="'+b+'"></div>').html('<div class="history">'+a.plugins.ScriptInput.generateHistory()+"</div>").dialog({title:c,width:500,height:500,minHeight:300,minWidth:300}).find(".history")},this.createDialog=function(b,d){function e(a,b){var c="";if(b instanceof Array)for(var d=0;d<b.length;d++)"string"==typeof b[d]?c+=b[d]+"\n":"object"==typeof b[d]&&(c+=b[d].eden_definition+";\n");x.value=c,h()}function f(){var a=new EdenAST(x.value),b=u(x);t(a,b,x.selectionEnd),n()}function g(){var a=u(x);t(K.ast,a,x.selectionEnd)}function h(){var a=new EdenAST(x.value);t(a,-1,x.selectionEnd),n()}function i(a){var b=[];for(var c in a)void 0===eden.root.lookup(c).value()&&b.push(c);return b}function k(a,b){if(a.lines[b]){for(var c=a.lines[b];void 0!==c.parent;)c=c.parent;j.submit(c)}}function l(a,b){"warning"==a?z.innerHTML="<div class='info-warnitem'><span>"+b+"</span></div>":"error"==a&&(z.innerHTML="<div class='info-erroritem'><span>"+b+"</span></div>"),$(z).show("fast")}function m(){$(z).hide("fast")}function n(){for(var a=0;a<K.ast.lines.length;a++)K.ast.lines[a]&&K.ast.lines[a].lvalue&&eden.root.lookup(K.ast.lines[a].lvalue.observable).addJSObserver("scriptLines",p)}function o(a){$(y.childNodes[a-1]).addClass("eden-warnline")}function p(a,b){for(var c=0,d=a.name.slice(1),e=0;e<K.ast.lines.length;e++){var f=K.ast.lines[e];f&&f.lvalue&&f.lvalue.observable==d&&("definition"==f.type||e!=J-1&&(console.log("MARK LINE OUT_OF_DATE: "+e),o(e+1)),c++)}}function q(){if(H=!1,j.autoexec&&0==K.ast.script.errors.length){A.innerHTML="";var a=u(x)-1;if(K.ast.lines[a]){var b=K.ast.lines[a];if("definition"==b.type||"assignment"==b.type){var d=K.ast.lines[a].lvalue.observable,e=eden.root.lookup(d),f=e.value();if(void 0===f){var g=i(b.dependencies);if(g.length>0){for(var h="",k=0;k<g.length;k++)h+="<b>"+g[k]+"</b>",k!=g.length-1&&(h+=",");1==g.length?(o(J),l("warning","<b>"+d+"</b> "+Language.ui.input_window.is_undef_because+" "+h+" "+Language.ui.input_window.is_undef)):(o(J),l("warning","<b>"+d+"</b> "+Language.ui.input_window.is_undef_because+" "+h+" "+Language.ui.input_window.are_undef))}else o(J),l("warning",d+" "+Language.ui.input_window.is_undef)}else{var g=i(b.dependencies);if(g.length>0){for(var h="",k=0;k<g.length;k++)h+=g[k],k!=g.length-1&&(h+=",");1==g.length?(o(J),l("warning","<b>"+d+"</b> "+Language.ui.input_window.uses+" "+h+" "+Language.ui.input_window.which_undef)):(o(J),l("warning","<b>"+d+"</b> "+Language.ui.input_window.uses_undef+" "+h))}else{var n=c(f,15,e);m(),A.innerHTML="<div class='info-validitem'><span>"+d+"<span class='valueof'>&#xf178;</span></span></div>",n.appendTo($(A).find("div"))}}}else m()}}else j.autoexec?l("error",K.ast.script.errors[0].messageText()):m()}function r(a,b){var c=x.value.split("\n");c[a]=b,x.value=c.join("\n")}function s(a){for(var b=a;b.parentNode!==y;)b=b.parentNode;console.log(y.childNodes);for(var c=0;c<y.childNodes.length;c++)if(y.childNodes[c]===b)return c;return-1}function t(a,b,c){K.highlight(a,b,c),$(y).find(".eden-number").draggable({helper:function(a){return $("<div class='eden-drag-helper'></div>")},axis:"x",drag:function(a,b){var c=Math.round(E+(b.position.left-D)/2);if(c!=F){F=c,a.target.innerHTML=""+c,r(G,a.target.parentNode.textContent);var d=new EdenAST(x.value);j.autoexec&&0==d.script.errors.length&&d.lines[G]&&j.submit(d.lines[G])}},start:function(a,b){G=s(a.target),D=b.position.left,E=parseInt(a.target.textContent),F=E,console.log(a),console.log("Drag: "+G),$(a.target).addClass("eden-select"),$(y).css("cursor","ew-resize")},stop:function(a,b){$(a.target).removeClass("eden-select"),$(y).css("cursor","text"),h()},cursor:"move",cursorAt:{top:-5,left:-5}})}function u(a){return J=a.value.substr(0,a.selectionStart).split("\n").length}var v=$('<div class="inputdialogcontent"><div class="inputCodeArea"><div class="eden_suggestions"></div><div spellcheck="false" contenteditable tabindex="1" class="outputcontent"></div></div><textarea class="hidden-textarea"></textarea><div class="info-bar"></div><div class="control-bar"><div class="subButtonsDiv"></div><div class="outputbox"></div></div></div>'),w=v.find(".inputCodeArea"),x=v.find(".hidden-textarea").get(0),y=v.find(".outputcontent").get(0),z=v.find(".info-bar").get(0),A=v.find(".outputbox").get(0),B=v.find(".eden_suggestions");B.hide(),$(z).hide();var C,D=0,E=0,F=0,G=0,H=!1,I=1500,J=0,K=new EdenHighlight(y);eden.root.lookup("_view_input_dialog_script").addJSObserver("setScript",e),v.on("input",".hidden-textarea",function(a){clearTimeout(C),0==H&&(A.innerHTML="<div class='loader'></div>",H=!0),C=setTimeout(q,I);var b=w.get(0).scrollTop;f(),w.scrollTop(b),j.autoexec&&0==K.ast.script.errors.length?(v.find(".submitButton").removeClass("submitError"),k(K.ast,J-1)):j.autoexec&&v.find(".submitButton").addClass("submitError")}).on("keyup",".hidden-textarea",function(a){if(a.ctrlKey||17==a.keyCode)a.ctrlKey&&(console.log(a),38===a.keyCode?j.prev(x):40===a.keyCode?j.next(x):86===a.keyCode&&(v.find(".submitButton").get(0).checked=!1,j.autoexec=!1));else if(37==a.keyCode||38==a.keyCode||39==a.keyCode||40==a.keyCode){var b=w.get(0).scrollTop;g(),w.scrollTop(b)}}).on("keydown",".outputcontent",function(a){if(a.ctrlKey);else{var b=getCaretCharacterOffsetWithin(y),c=getStartCaretCharacterOffsetWithin(y);x.selectionEnd=b,x.selectionStart=c,$(x).focus(),8==a.keyCode&&(x.value=x.value.slice(0,c)+x.value.slice(b))}}).on("blur",".hidden-textarea",function(a){$(y).find(".fake-caret").remove()}).on("mouseup",".outputcontent",function(a){var b=getCaretCharacterOffsetWithin(y),c=getStartCaretCharacterOffsetWithin(y);if(c!=b);else{x.selectionEnd=b,x.selectionStart=b;var d=w.get(0).scrollTop;$(x).focus(),h(),w.scrollTop(d)}}).on("change",".submitButton",function(a){$(this).is(":checked")?(j.autoexec=!0,h(),j.submit(K.ast.script)):j.autoexec=!1}).on("click",".previousButton",function(a){B.hide("fast"),v.find(".submitButton").get(0).checked=!1,j.autoexec=!1,h()}).on("click",".nextButton",function(a){B.hide("fast"),v.find(".submitButton").get(0).checked=!1,j.autoexec=!1,h()}),$dialog=$('<div id="'+b+'"></div>').html(v).dialog({title:d,width:500,height:224,minHeight:203,minWidth:500,dialogClass:"input-dialog"}),input_dialog=$dialog,$dialog.parent().find(".ui-dialog-titlebar").append($('<div class="scriptswitch" title="Live Coding">&#xF011;</div>'));var L=!("MenuBar"in a.plugins);return{confirmClose:L,setValue:function(a){textarea.value=a}}},this.next=function(b){b.value=a.plugins.ScriptInput.nextHistory()},this.prev=function(b){b.value=a.plugins.ScriptInput.previousHistory()},this.submit=function(a){a.execute(eden.root,void 0)},this.getRidOfInstructions=function(){var a=el.innerText;"Ctrl+Enter = Submit\nCtrl+Up = Previous\nCtrl+Down = Next"===a&&(el.innerText="")},this.putBackInstructions=function(){var a=document.getElementById("inputCodeArea").value;""===a&&(el.innerText="Ctrl+Enter = Submit\nCtrl+Up = Previous\nCtrl+Down = Next")},a.views.ScriptInput={dialog:this.createDialog,embed:this.createEmbedded,title:Language.ui.input_window.title,category:a.viewCategories.interpretation,menuPriority:0},a.views.History={dialog:this.createHistory,title:"Input History",category:a.viewCategories.history},a.history=this.history,b()},$(document).delegate(".inputCodeArea textarea","keydown",function(a){var b=a.keyCode||a.which;if(9==b){a.preventDefault();var c=$(this).get(0).selectionStart,d=$(this).get(0).selectionEnd;$(this).val($(this).val().substring(0,c)+"	"+$(this).val().substring(d)),$(this).get(0).selectionStart=$(this).get(0).selectionEnd=c+1}});var edenFunctions={"int":!0,str:!0,round:!0,min:!0,max:!0,random:!0,floor:!0,ceil:!0,abs:!0,acos:!0,asin:!0,atan:!0,cos:!0,exp:!0,ln:!0,log:!0,mod:!0,randomInteger:!0,randomFloat:!0,sin:!0,sqrt:!0,sum:!0,tan:!0,length:!0,error:!0,substr:!0,type:!0,createView:!0,createCanvas:!0,zonesAt:!0,execute:!0,indexOf:!0,forget:!0,eager:!0,time:!0,writeln:!0,apply:!0,todo:!0,"char":!0,isBoolean:!0,isCallable:!0,isChar:!0,isDefined:!0,isValue:!0,isFunc:!0,isInt:!0,isNaN:!0,isNumber:!0,isObject:!0,isPoint:!0,isProc:!0,showView:!0,array:!0,sublist:!0,reverse:!0,search:!0,sort:!0,tail:!0,concat:!0,decodeHTML:!0},edenTypes={HTMLImage:!0,Text:!0,Rectangle:!0,Button:!0,Div:!0,Arc:!0,Button:!0,Checkbox:!0,Circle:!0,Combobox:!0,Ellipse:!0,Image:!0,Line:!0,Polygon:!0,Slider:!0,Point:!0},edenSpecials={autocalc:!0,mouseX:!0,mouseY:!0,mousePosition:!0,screenHeight:!0,screenWidth:!0,PI:!0},edenValues={"true":!0,"false":!0,green:!0};EdenHighlight.prototype.highlight=function(a,b,c){this.ast=a;var d="",e=-1,f=-1,g="",h=!1,i=a.stream,j="";if(0==a.stream.code.length)return void(this.outelement.innerHTML="<div class='eden-currentline'><span><span class='fake-caret'></span>&nbsp;</span></div>");a.script.errors.length>0&&(e=a.script.errors[0].prevposition,f=a.script.errors[0].position,g=a.script.errors[0].messageText()),i.reset();for(var k="",l=!1,m=0,n="INVALID",o="INVALID";;){i.position==c&&(k+="<span class='fake-caret'></span>");var p=i.peek();if(10!=p)if(9!=p&&13!=p&&32!=p&&160!=p){o=n,n=i.readToken();var q=i.tokenType(n),r="",s=i.tokenText();if("EOF"==n)break;if("INVALID"!=n){if(-1!=e&&(e<=i.prevposition&&!h&&(h=!0),f<=i.prevposition&&h&&(h=!1),h&&(l=!0)),h&&"EOF"!=a.script.errors[0].token?(j=g.replace(">","&gt;").replace("<","&lt;"),r+="eden-error "):j="","##"==n){r+="eden-comment";for(var t="";i.valid()&&10!=i.peek();)t+=String.fromCharCode(i.get());s="##"+t.replace(">","&gt;").replace("<","&lt;")}else"local"==n||"auto"==n||"para"==n?r+="eden-storage":"keyword"==q?r+="eden-keyword":"NUMBER"==n?r+="eden-number":"STRING"==n?(r+="eden-string",s=s.replace("<","&lt;"),s=s.replace(">","&gt;")):"CHARACTER"==n?(r+="eden-string",s=s.replace("<","&lt;"),s=s.replace(">","&gt;")):"BOOLEAN"==n?r+="eden-constant":"OBSERVABLE"==n?r+=edenFunctions[i.data.value]?"eden-function":edenTypes[i.data.value]?"eden-type":edenValues[i.data.value]?"eden-constant":edenSpecials[i.data.value]?"eden-special":"eden-observable":"JAVASCRIPT"==n?(r+="eden-javascript",s=s.replace("<","&lt;"),s=s.replace(">","&gt;")):(r+="eden-operator",s=s.replace("<","&lt;"),s=s.replace(">","&gt;"));if(i.prevposition<c&&i.position>c){console.log("CARET");var u=c-i.prevposition;s=s.slice(0,u)+"<span class='fake-caret'></span>"+s.slice(u)}k+="<span class='"+r+"' title=\""+j+'">'+s+"</span>"}else console.log("INVALID: "+i.peek()),i.skip()}else i.skip(),32==p||160==p?k+="&nbsp;":10!=p&&13!=p&&(k+=String.fromCharCode(p));else this.line++,l?(d+=c>=m&&c<=i.position?"<div class='eden-currentline eden-errorline'><span>":"<div class='eden-errorline'><span>",l=!1):c>=m&&c<=i.position?(this.currentline=this.line-1,d+="<div class='eden-currentline'><span>"):d+="#"==i.code.charAt(m)?"<div class='eden-commentline'><span>":"<div class='eden-line'><span>",m=i.position+1,d+=k+"</span>\n</div>",k="",i.skip()}""!=k&&(l?d+=c>=m&&c<=i.position?"<div class='eden-currentline eden-errorline'>"+k+"</span></div>":"<div class='eden-errorline'>"+k+"</span></div>":c>=m&&c<=i.position?(this.currentline=this.line,d+="<div class='eden-currentline'>"+k+"</span></div>"):d+="<div class='eden-line'>"+k+"</span></div>"),-1==this.currentline&&(this.currentline=this.line-1),this.outelement.innerHTML=d},EdenUI.plugins.ProjectList=function(a,b){function c(){this.json={projects:[]},this.rootURL=void 0,this.atRoot=!0}function d(b){EdenUI.plugins.ScriptGenerator.loadBaseConstrual(b),a.plugins.ScriptInput&&a.plugins.ScriptInput.addHistory('include("'+b+'");')}var e=Date.UTC(2015,8,5),f=getParameterByName("projects"),g="";"projectList"in a.branding&&("prologue"in a.branding.projectList&&(g='<div class="projectlist-prologue">'+a.branding.projectList.prologue.html+"</div>","href"in a.branding.projectList.prologue&&(g='<a href="'+a.branding.projectList.prologue.href+'" target="project-listing-link" style="text-decoration: none">'+g+"</a>")),""==f&&"data"in a.branding.projectList&&(f=a.branding.projectList.data)),""==f&&(f="models/projects.json");var h,i,j;this.loadCrossDomain=function(a){if(a.success){var b=JSON.parse(a.success);h.populateProjectData(b,i,j)}},c.prototype.loadProjectData=function(a,b){var c=this;/^[a-zA-Z][a-zA-Z\d+.-]*:\/\//.test(a)?(h=this,i=a,j=b,$.ajax({url:rt.config.proxyBaseURL+"?url="+a+"&callback=edenUI.plugins.ProjectList.loadCrossDomain",dataType:"script"})):$.ajax({url:a,dataType:"json",success:function(d){c.populateProjectData(d,a,b)},cache:!1})},c.prototype.populateProjectData=function(a,b,c){if(this.json=a,c)this.rootURL=b,this.atRoot=!0;else if(this.atRoot=b==this.rootURL,!this.atRoot){var d={name:"Return to main list",projects:this.rootURL};this.json.projects.push(d)}this.updateCollection("")},c.prototype.projectClick=function(b){var c=b.runfile;void 0!==c&&(a.eden.isInInitialState()?(a.newProject(),d(c)):a.modalDialog("Open Project Action","<p>The work space contains an existing construal.</p>					<p>You can either abandon the existing construal or choose to merge the project with the existing definitions.</p>					<p>Which would you like to do?</p>",["Open Project","Merge"],0,function(b){2!=b&&(0==b&&a.newProject(),d(c))}));var e=b.projects;void 0!==e&&this.loadProjectData(e,!1)},c.prototype.makeProject=function(a){var b=this,c=$('<div class="projectlist-result-element"></div>'),d='<div class="projectlist-result-name">'+a.name+"</div>";return void 0!==a.description&&(d=d+'<div class="projectlist-result-metadata">'+a.description+"</div>"),(void 0!==a.author||void 0!==a.year)&&(d+='<div class="projectlist-result-metadata">',void 0!==a.author&&(d=d+"By "+a.author),void 0!==a.year&&(d=d+" ("+a.year+")"),d+="</div>"),c.html(d),c.click(function(){b.projectClick(a)}),c},c.prototype.updateCollection=function(b){this.element.parentElement.scrollTop=0;var c=$(this.element).find(".projectlist-results");if(c.html(""),void 0!==this.json.projects)for(var d=new RegExp("(^|\\s)"+b,"im"),g=!1,h=0;h<this.json.projects.length;h++)if(d.test(this.json.projects[h].name)||d.test(this.json.projects[h].description)||d.test(this.json.projects[h].author)||d.test(this.json.projects[h].year)){g=!0;var i=this.json.projects[h],j=this.makeProject(i);c.append(j)}if(this.rootURL==f&&this.atRoot&&(""==b||d.test("Feature of The Day"))){var k,l=a.getOptionValue("fotdLastVisited");k=null===l||parseInt(l)<e?'<img id="fotd-sticker" src="images/new-sticker.png" width="24" height="14" style="vertical-align: 5%" />':"";var j=this.makeProject({name:"Feature of The Day "+k,description:"Learn about the latest features added to JS-EDEN.",author:"JS-EDEN Development Team",runfile:"models/guides/feature-of-the-day.js-e"});c.prepend(j)}if(!g||d.test("New Project")){var m=$('<div class="projectlist-result-element"><div class="projectlist-result-name">New Project</div><div class="projectlist-result-metadata">An empty work space.</div><div class="projectlist-result-metadata">By JS-EDEN Development Team</div></div>').click(function(){eden.isInInitialState()?a.newProject():a.modalDialog("Reset Work Space","<p>This action will discard the current script. Your work will not be saved.</p>						<p>Are you sure you wish to continue?</p>",["Reset Work Space"],1,function(b){0==b&&a.newProject()})});c.prepend(m)}},this.createDialog=function(a,b,d){void 0===d&&(d=f);var e=new c,h=$('<div class="projectlist-listing"></div>');h.append(g);var i=$('<div class="projectlist-search-box-outer"></div>'),j=$('<input type="text" class="projectlist-search" placeholder="search" />').on("keyup",function(a){e.updateCollection(a.target.value)});return i.append(j),h.append(i),h.append('<div class="projectlist-results noselect"></div>'),$('<div id="'+a+'"></div>').html(h).dialog({title:b,width:310,height:400,minHeight:120,minWidth:230,dialogClass:"unpadded-dialog"}),e.element=h.get(0),e.loadProjectData(d,!0),{data:e}},a.views.ProjectList={dialog:this.createDialog,title:"Project List",category:a.viewCategories.interpretation},a.eden.include("plugins/project-listing/project-listing.js-e",b)},EdenUI.plugins.ProjectList.title="Project List",EdenUI.plugins.ProjectList.description="Displays a list of construals.",EdenUI.plugins.PluginManager=function(a,b){this.createDialog=function(b,c){var d,e,f,g=$('<div class="projectlist-results noselect"></div>'),h=function(b){return a.plugins[b]?"(loaded)":"(not loaded)"};pluginNames=Object.keys(EdenUI.plugins).sort(function(b,c){var d=a.plugins[b],e=a.plugins[c];return d&&!e?1:e&&!d?-1:c>b?-1:b==c?0:1});for(var i=0;i<pluginNames.length;i++){e=pluginNames[i],d=EdenUI.plugins[e];var j=e in a.plugins?" pluginmanager-loaded":"",k='<div class="projectlist-result-element'+j+'"><div class="projectlist-result-name">'+d.title+"</div><div class='projectlist-result-metadata'>"+d.description+"</div>";void 0!==d.originalAuthor&&(k=k+"<div class='projectlist-result-metadata'>Original version by "+d.originalAuthor+"</div>"),void 0!==d.author&&(f=void 0===d.originalAuthor?"By ":"Built on by ",k=k+"<div class='projectlist-result-metadata'>"+f+d.author+"</div>"),k=k+'<div class="pluginlist-loaded projectlist-result-metadata">'+h(e)+"</div></div>",$(k).click(function(b){return function(){var c=$(this);a.loadPlugin(b,function(){a.plugins[b]&&(c.find(".pluginlist-loaded").html(h(b)),c.addClass("pluginmanager-loaded",100)),a.plugins.MenuBar.updateViewsMenu()})}}(e)).appendTo(g)}var l=$('<div class="projectlist-listing"></div>');l.append(g),$dialog=$('<div id="'+b+'"></div>').html(l).dialog({title:c,width:310,height:400,minHeight:120,minWidth:230,dialogClass:"unpadded-dialog"})},a.views.PluginManager={dialog:this.createDialog,title:"Plug-in Manager",category:a.viewCategories.environment,name:"plugins"},b()},EdenUI.plugins.PluginManager.title="Plug-in Manager",EdenUI.plugins.PluginManager.description="Provides the ability to load plug-ins.",EdenUI.plugins.MenuBar=function(a,b){function c(){$(".menubar-menu").hide(),v=!1}function d(a){$("#menubar-mainitem-"+a).show(),v=!0}function e(){var a=$("<div></div>");return a.appendTo(t),a.menuGroupWidth=0,a}function f(a,b,e){var f=$('<div class="menubar-mainitem"></div>');f.html(b),f.appendTo(e);var g=f[0].clientWidth+10;e.menuGroupWidth=e.menuGroupWidth+g+10,f[0].style.width=g+"px",f.html(b+'<div id="menubar-mainitem-'+a+'" class="menubar-menu"></div>'),$("#menubar-mainitem-"+a).hide();var h=function(b){v?b.target===this&&c():(c(),d(a)),b.stopPropagation(),b.preventDefault()};f.on("mousedown",h),f.on("mouseover",function(){v&&(c(),d(a))})}function g(){var b=$("#menubar-mainitem-existing-views");Object.keys&&0===Object.keys(a.activeDialogs).length&&b.html('<div class="menubar-item-fullwidth">Use the "New Window" menu to create windows.</div>')}function h(b){c();var d=a.eden.root,e=d.lookup("mouseFollow").value(),f=d.lookup("_views_number_created"),g=f.value()+1;f.assign(g,d.scope,Symbol.hciAgent,!0),e?a.eden.execute('createView("view_'+g+'", "'+this.view+'");'):a.createView("view_"+g,this.view),q.updateViewsMenu(),b.stopPropagation(),b.preventDefault()}function i(b){b.preventDefault();var d=this.parentNode.viewname;a.viewInstances[d].confirmClose&&c(),a.closeView(d),g()}function j(b){b.preventDefault();var c=b.currentTarget.children[0],d=this.parentNode.viewname;a.viewInstances[d].pinned?(a.unpinView(d),c.src=s):(a.pinView(d),c.src=r)}function k(a){for(var b=$("<div class='menubar-item'></div>"),c=0;c<a.length;++c)b.append(a[c]);return b}function l(a,b){return $('<div class="'+a+' menubar-item-clickable">'+b+"</div>")}function m(a){return $("<div class='menubar-item menubar-nonselectable'><div class='menubar-item-fullwidth menubar-item-separator'>"+a+"</div></div>")}function n(b){return{mouseover:function(c){a.highlightView(b,!0)},mouseout:function(c){a.stopHighlightingView(b,!0,!1)},click:function(d){d.preventDefault(),a.stopHighlightingView(b,!0,!0),c()}}}function o(a){return a&&"false"!=a?'checked="checked"':""}function p(){function b(b,c,e,f){var g=a.getOptionValue(b);null===g&&(g=e);var h=l("menubar-item-input",'<input id="menu-'+b+'" type="checkbox"'+o(g)+" />"),i=h.get(0).children[0],j=l("menubar-item-label",c),m=k([h,j]);m.click(function(c){c.target!=i&&(i.checked=!i.checked),a.setOptionValue(b,i.checked),f&&f(b,i.checked)}),m.appendTo(d)}f("views",Language.ui.menu_bar.main_views,w),f("existing-views",Language.ui.menu_bar.main_existing,w),q.updateViewsMenu(),f("options",Language.ui.menu_bar.main_options,w);var d=$("#menubar-mainitem-options");b("optConfirmUnload",Language.ui.menu_bar.opt_confirm,!0),b("optHideOnMinimize",Language.ui.menu_bar.opt_hide,!1),b("optCollapseToTitleBar",Language.ui.menu_bar.opt_collapse,!1,function(a,b){var c;c=b?"collapse":"maximize",$(".ui-dialog-content").each(function(){$(this).dialogExtend("option","dblclick",c)})}),b("developer",Language.ui.menu_bar.opt_debug,!1,function(b,d){var e;e=d?"/index-dev.html":"/index.html",e!=document.location.pathname?(c(),a.modalDialog("Restart Required","<p>JS-EDEN must be restarted for this change to fully take effect.  Would you like to restart JS-EDEN now?</p>",["Restart Now","Restart Later"],1,function(b){if(0==b)window.onbeforeunload=void 0,document.location.pathname=e;else if(1==b)root.lookup("debug").mutate(function(a){a.cached_value.jsExceptions=d},Symbol.hciAgent);else{var c=document.getElementById("menu-developer");c.checked=!c.checked,a.setOptionValue("developer",c.checked)}})):root.lookup("debug").mutate(function(a){a.cached_value.jsExceptions=d},Symbol.hciAgent)})}EdenUI.plugins.MenuBar.title=Language.ui.menu_bar.title,EdenUI.plugins.MenuBar.description=Language.ui.menu_bar.description;var q=this;this.itemViews={},a.listenTo("createView",this,function(a,b){this.updateViewsMenu()}),a.listenTo("destroyView",this,function(a){$(this.itemViews[a]).remove(),delete this.itemViews[a],g()}),a.listenTo("loadPlugin",this,function(a,b){this.updateViewsMenu()});var r="images/pin.png",s="images/pin-greyed.png",t=$('<div id="menubar-main"></div>'),u=$('<div id="menubar-status"></div>');u.appendTo(t),t.appendTo("body"),$('<div id="menubar-bottom"></div>').appendTo("body"),this.updateStatus=function(a){u.html(Eden.htmlEscape(a,!0,!0))},this.appendStatus=function(a){u.html(u.html()+Eden.htmlEscape(a,!0,!0))};var v=!1;$(document.body).on("mousedown",function(){c()}),this.updateViewsMenu=function(){var b=$("#menubar-mainitem-views"),c=$("#menubar-mainitem-existing-views");b.html("");var d,e,f,o,p,t,u=[];for(e in a.views){var v=a.views[e],w=v.title,x=v.category.getLabel(),y=v.category.getMenuPriority(),z=v.menuPriority;o=l("menubar-item-fullwidth menubar-view",w),f=k([o]),f[0].view=e,f.click(h),u.push({title:w,viewEntry:f,categoryLabel:x,categoryPriority:y,itemPriority:z})}u=u.sort(function(a,b){if(a.categoryPriority!=b.categoryPriority)return a.categoryPriority-b.categoryPriority;if(void 0!==a.itemPriority){if(void 0===b.itemPriority)return-1;if(a.itemPriority!=b.itemPriority)return a.itemPriority-b.itemPriority}else if(void 0!==b.itemPriority)return 1;return a.title>b.title?1:a.title<b.title?-1:0});for(var A,B=0;B<u.length;++B){var C=u[B],D=C.categoryLabel;if(A!=D){var E=m(D);E.appendTo(b),A=D}C.viewEntry.appendTo(b)}c.html(""),q.itemViews={},g();for(d in a.activeDialogs){var F=n(d),w=a.eden.root.lookup("_view_"+d+"_title").value();o=l("menubar-item-label",w+" ["+d+"]"),o.click(F.click);var G;G=a.viewInstances[d].pinned?r:s,p=l("menubar-item-pin",'<img src="'+G+'" width="18" height="18" class="menubar-item-pin-icon"/>'),p.click(j),t=l("menubar-item-close",'<div class="menubar-item-close-icon">X</div>'),t.click(i),f=k([o,p,t]),f.bind("mouseover",F.mouseover),f.bind("mouseout",F.mouseout),f[0].viewname=d,f.appendTo(c),q.itemViews[d]=f[0]}};var w=e();p(),$.ajax({url:"version.json",dataType:"json",success:function(a){var b="";a.tag&&(b+="Version "+a.tag,document.title=document.title+" "+a.tag),a.sha&&(b+=' Commit <a href="https://github.com/EMgroup/js-eden/commit/'+a.sha+'">'+a.sha+"</a>"),$('<div id="menubar-version-number"></div>').html(b).appendTo($("#menubar-main"))},cache:!1});var x=e();a.eden.root.lookup("menus").addJSObserver("updateMenus",function(a,b){
x.menuGroupWidth=0;var c=x.children();if(c.detach(),Array.isArray(b))for(var d=0;d<b.length;d++){var e=b[d];if(void 0===e.element){var g="construal-"+d;f(g,e.text,x);var h=$("#menubar-mainitem-"+g);e.generate(h)}else x.append(e.element),x.menuGroupWidth=x.menuGroupWidth+e.element.clientWidth}var i=u[0].style,j=20+w.menuGroupWidth+x.menuGroupWidth;i.left=j+"px",i.minWidth="calc(100% - "+2*j+"px)"}),this.Menu=function(a,b){this.text=a,this.items=b},this.Menu.prototype.generate=function(a){if(void 0===this.element){for(var b=0;b<this.items.length;b++){var c=this.items[b];c.generate(),a.append(c.element)}this.element=a.parent().get(0)}},this.Menu.prototype.toString=function(){return"Menu("+Eden.edenCodeForValues(this.text,this.items)+")"},this.Menu.prototype.getEdenCode=this.Menu.prototype.toString,this.SimpleMenuItem=function(a,b){this.name=a,this.text=b},this.SimpleMenuItem.prototype.generate=function(){if(void 0===this.element){var a=l("menubar-item-fullwidth",this.text),b=k([a]),d=this.name;b.bind("click",function(a){c();var b=root.lookup(d+"_clicked");b.assign(!0,root.scope),b.assign(!1,root.scope)}),this.element=b.get(0)}},this.SimpleMenuItem.prototype.toString=function(){return"MenuItem("+Eden.edenCodeForValues(this.name,this.text)+")"},this.SimpleMenuItem.prototype.getEdenCode=this.SimpleMenuItem.prototype.toString,a.eden.include("plugins/menu-bar/menu-bar.js-e",b)},EdenUI.plugins.Canvas2D=function(a,b){var c=this;this.defaultFontSizePx=13.3,this.defaultLineHeight=1.75*this.defaultFontSizePx;var d=600,e=500;canvases={},contents={};var f={},g={},h={},i=40;this.drawPictures=function(a){for(var b in g[a])this.drawPicture(b,a)},this.destroyViews=function(b){for(var c in g[b])a.destroyView(c)};var j=function(a,b){var c;for(c in b)if(b[c].togarbage)for(var d=b[c],e=0;e<d.length;e++)null!==d[e].parentElement&&a.removeChild(d[e])};this.drawPicture=function(b,d){var e=canvases[b];if(void 0!==e&&!e.drawingQueued&&(e.drawingQueued=!0,!e.drawingInProgress)){var g=function(){e.drawingInProgress=!0,e.drawingQueued=!1;var h=f[b],k={},l=root.lookup(d).value(),m=e.getContext("2d"),n=contents[b];if(void 0!==n){var o=root.lookup("_view_"+b+"_background_colour").value();void 0===o&&(o="white"),m.setTransform(1,0,0,1,0,0),c.setFillStyle(m,o),n.parentElement.style.backgroundColor=o,m.fillRect(0,0,e.width,e.height);var p=root.lookup("_view_"+b+"_scale").value();"number"!=typeof p&&(p=1);var q=root.lookup("_view_"+b+"_zoom").value();"number"!=typeof q&&(q=1);var r=p*q,s=root.lookup("_view_"+b+"_offset").value();s instanceof Point?m.translate(s.x,s.y):s=new Point(0,0),m.scale(r,r),c.configureContextDefaults(m,p);var t;for(t in h)h[t].togarbage=!0;if(Array.isArray(l))for(var u=0;u<l.length;u++)if("object"==typeof l[u]){var v=l[u].hash&&l[u].hash(),w=v&&h[v];if(w)l[u].elements=w;else{m.save();try{var x=c.configureContext(m,p,q,l[u].drawingOptions);x&&l[u].draw(m,p,d)}catch(y){if(void 0!==l[u]){console.log(y);var z=a.eden.root.lookup("debug").value();"object"==typeof z&&z.jsExceptions}}m.restore()}if(void 0!==l[u].elements){var A=l[u].elements[0].parentElement;if(A&&A!=n){for(var B=[],C=0;C<l[u].elements.length;C++)B.push($(l[u].elements[C]).clone(!0,!0).get(0));l[u].elements=B,l[u].scale(r,q,s)}else(!w||e.rescale)&&l[u].scale(r,q,s)}var D=l[u].elements;D&&(D.togarbage=!1),D&&!w&&$(n).append(D),D&&(k[v]=D)}j(n,h),f[b]=k,e.drawingInProgress=!1,e.drawingQueued&&setTimeout(g,i)}};setTimeout(g,i)}},this.configureContextDefaults=function(a,b){a.lineJoin="bevel",a.miterLimit=429496656,a.lineWidth=2/b},this.configureContext=function(a,b,c,d){if("object"!=typeof d)return!0;if(d.visible===!1)return!1;if(Array.isArray(d.dashes)&&(a.setLineDash(d.dashes),"dashOffset"in d&&(a.lineDashOffset=d.dashOffset)),"cap"in d&&(a.lineCap=d.cap),"join"in d&&(a.lineJoin=d.join),"miterLimit"in d&&(a.miterLimit=d.miterLimit),"lineWidth"in d&&(a.lineWidth=d.lineWidth/b),"opacity"in d&&(a.globalAlpha=d.opacity),"object"==typeof d.shadow)if(a.shadowColor=d.shadow.colour,d.shadow.scale){var e=c*b;a.shadowBlur=d.shadow.blur*e,a.shadowOffsetX=d.shadow.xOffset*e,a.shadowOffsetY=d.shadow.yOffset*e}else a.shadowBlur=d.shadow.blur*c,a.shadowOffsetX=d.shadow.xOffset*c,a.shadowOffsetY=d.shadow.yOffset*c;return!0},this.setFillStyle=function(a,b){b instanceof EdenUI.plugins.Canvas2D.FillStyle?a.fillStyle=b.getColour(a):a.fillStyle=b},this.findZoneHit=function(a,b,c,d){var e=root.lookup(b).value();if(!Array.isArray(e))return void 0;for(var f=canvases[a],g=f.getContext("2d"),h=root.lookup("_view_"+a+"_scale").value(),i=e.length-1;i>=0;i--){var j=e[i];if("object"==typeof j){var k=j.drawingOptions;if(void 0!==k){var l=k.name;if(void 0!==l){var m=j.isHit;if(void 0!==m){g.save();var n=j.isHit(g,h,c,d);if(g.restore(),n)return l}}}}}return void 0},this.findZoneHit2=function(a,b,c){var d,e;if(a instanceof Symbol){e=a.name.slice(1);for(var f in g[e]){d=f;break}}else d=a,e=h[d];return this.findZoneHit(d,e,b,c)},this.findAllZonesHit=function(a,b,c){var d,e,f;if(a instanceof Symbol){e=a.name.slice(1);for(var i in g[e]){d=i;break}f=a.value()}else d=a,e=h[d],f=root.lookup(e).value();if(!Array.isArray(f))return[];for(var j=canvases[d],k=j.getContext("2d"),l=root.lookup("_view_"+d+"_scale").value(),m=[],n=0;n<f.length;n++){var o=f[n];if("object"==typeof o){var p=o.drawingOptions;if(void 0!==p){var q=p.name;if(void 0!==q){var r=o.isHit;if(void 0!==r){k.save();var s=o.isHit(k,l,b,c);k.restore(),s&&m.push(q)}}}}}return m},this.mouseInfo={leftButton:!1,middleButton:!1,rightButton:!1,button4:!1,button5:!1,buttonCount:0,insideCanvas:!1,capturing:!1},this.setPictureObs=function(b,d){for(var e in g)delete g[e][b];d in g||(g[d]={}),g[d][b]=!0,h[b]=d,a.eden.root.lookup(d).addJSObserver("refreshView",function(a,b){c.drawPictures(d)})},this.createDialog=function(b,i,j){function k(){var b,d,e=v.value();e instanceof Point?(b=e.x,d=e.y):(b=0,d=0);var f=u.value(),g=w.value();void 0!==g?(g=Math.ceil(w.value()*t.value()*f+b),r.width=g):f>1?r.width=Math.ceil(y.cache.value*f):r.width=Math.floor(y.cache.value);var h;void 0!==x.value()?h=Math.ceil(x.value()*t.value()*f+d):f>1?h=Math.ceil(z.cache.value*f):(h=z.cache.value,void 0!==g&&g>Math.floor(y.cache.value)&&(h-=a.scrollBarSize),h=Math.floor(h-1)),r.height=h,r.rescale=!0,c.drawPicture(p,j)}function l(){A?(A=!1,r.rescale=!0,c.drawPicture(p,j),D||(D=!0,setTimeout(l,1e3))):(k(),D=!1)}var m,n,o,p=b.slice(0,-7),q=root.lookup("createView"),r=canvases[p];void 0===r?(m=$('<div id="'+b+'-canvascontent" class="canvashtml-content"></div>'),m.html('<canvas class="canvashtml-canvas" id="'+b+'-canvas" tabindex="1"></canvas>'),n=m.find(".canvashtml-canvas"),r=n[0],canvases[p]=r,contents[p]=m[0],f[p]={},r.drawingQueued=!1,r.drawingInProgress=!1,r.rescale=!1):(m=$("#"+b+"-canvascontent"),n=m.find(".canvashtml-canvas"));var s=root.lookup("_view_"+p+"_background_colour");void 0===s.value()&&s.assign("white",root.scope,q),s.addJSObserver("repaintView",function(a,b){c.drawPicture(p,j)});var t=root.lookup("_view_"+p+"_scale"),u=root.lookup("_view_"+p+"_zoom"),v=root.lookup("_view_"+p+"_offset"),w=root.lookup("_view_"+p+"_canvas_right"),x=root.lookup("_view_"+p+"_canvas_bottom"),y=root.lookup("_view_"+p+"_width"),z=root.lookup("_view_"+p+"_height"),A=!1,B=t.value();void 0===B&&(t.assign(1,root.scope,q),B=1),t.addJSObserver("repaintView",k);var C=u.value();void 0===C&&(u.assign(1,root.scope,q),C=1);var D=!1;u.addJSObserver("repaintView",function(a,b){var c=Math.round(100*b);1==b?o.titleBarInfo=void 0:o.titleBarInfo=c+"%",A=!0,l()});var E,F,G=v.value();G instanceof Point?(E=G.x,F=G.y):(v.assign(new Point(0,0),root.scope,q),E=0,F=0),v.addJSObserver("repaintView",k),w.addJSObserver("repaintView",k),x.addJSObserver("repaintView",k);var H=w.value();H=void 0===H?d:H*B+E;var I=x.value();return I=void 0===I?e:I*B+F,n.on("mousedown",function(a){var b=root.lookup("mouseFollow").value();root.beginAutocalcOff();var d=c.mouseInfo;d.insideCanvas=!0;var e;switch(a.button){case 0:d.leftButton=!0,root.lookup("mousePressed").assign(!0,root.scope,Symbol.hciAgent,b),e="Left";break;case 1:d.middleButton=!0,e="Middle";break;case 2:d.rightButton=!0,e="Right";break;case 3:d.button4=!0,e="Button4";break;case 4:d.button5=!0,e="Button5";break;default:e="Unknown"}d.buttonCount=d.leftButton+d.middleButton+d.rightButton+d.button4+d.button5;var f="|";if(d.leftButton&&(f+="Left|"),d.middleButton&&(f+="Middle|"),d.rightButton&&(f+="Right|"),d.button4&&(f+="Button4|"),d.button5&&(f+="Button5|"),root.lookup("mouseButtons").assign(f,root.scope,Symbol.hciAgent,b),root.lookup("mouseButton").assign(e+" down",root.scope,Symbol.hciAgent,b),1==d.buttonCount){var g=root.lookup("mousePosition").value();root.lookup("mouseDownWindow").assign(p,root.scope,Symbol.hciAgent,b),root.lookup("mouseDown").assign(g,root.scope,Symbol.hciAgent,b);var h=root.lookup("mouseZone").value();root.lookup("mouseDownZone").assign(h,root.scope,Symbol.hciAgent,b)}root.endAutocalcOff()}).on("mouseup",function(b){var d=root.lookup("mouseFollow").value();root.beginAutocalcOff();var e=c.mouseInfo;e.insideCanvas=!0;var f;switch(b.button){case 0:e.leftButton=!1,root.lookup("mousePressed").assign(!1,root.scope,Symbol.hciAgent,d),f="Left";break;case 1:e.middleButton=!1,f="Middle";break;case 2:e.rightButton=!1,f="Right";break;case 3:e.button4=!1,f="Button4";break;case 4:e.button5=!1,f="Button5";break;default:f="Unknown"}if(e.buttonCount=e.leftButton+e.middleButton+e.rightButton+e.button4+e.button5,root.lookup("mouseButton").assign(f+" up",root.scope,Symbol.hciAgent,d),0==e.buttonCount){var g=root.lookup("mousePosition").value();root.lookup("mouseButtons").assign("",root.scope,Symbol.hciAgent,d),root.lookup("mouseUp").assign(g,root.scope,Symbol.hciAgent,d),a.plugins.Canvas2D.endClick()}else{var h="|";e.leftButton&&(h+="Left|"),e.middleButton&&(h+="Middle|"),e.rightButton&&(h+="Right|"),e.button4&&(h+="Button4|"),e.button5&&(h+="Button5|"),root.lookup("mouseButtons").assign(h,root.scope,Symbol.hciAgent,d)}root.endAutocalcOff()}).on("contextmenu",function(a){root.lookup("mouseContextMenuEnabled").value()||(a.preventDefault(),a.stopPropagation())}).on("click",function(a){root.lookup("mouseCapture").value()&&this.requestPointerLock()}).on("dblclick",function(a){var b=root.lookup("mouseFollow").value(),c=root.lookup("mouseDoubleClicks"),d=c.value();c.assign(d+1,root.scope,Symbol.hciAgent,b)}).on("wheel",function(a){var b,d=a.originalEvent,e=z.value();b=d.deltaMode==WheelEvent.DOM_DELTA_LINE?c.defaultLineHeight:d.deltaMode==WheelEvent.DOM_DELTA_PAGE?0!=d.deltaX?w.value():e:1;var f=root.lookup("mouseFollow").value();if(0!=d.deltaY&&a.ctrlKey&&!a.altKey&&!a.metaKey&&!a.shiftKey){a.preventDefault(),a.stopPropagation(),root.beginAutocalcOff();var g=-d.deltaY*b;if(root.lookup("touchPinchEnabled").value()){var h=root.lookup("touchPinch"),i=h.value();i+=g,h.assign(i,Symbol.hciAgent,f)}else{var j=u.value();j=j*(e+2*g)/e,.05>j&&(j=.05),u.assign(j,Symbol.hciAgent,f)}return void root.endAutocalcOff()}if(root.lookup("mouseWheelEnabled").value()){if(root.beginAutocalcOff(),0!==d.deltaY&&(!a.ctrlKey||a.altKey||a.metaKey||a.shiftKey)){a.preventDefault(),a.stopPropagation();var k=root.lookup("mouseWheel"),l=k.value(),g=d.deltaY*b;l+=g,k.assign(l,root.scope,Symbol.hciAgent,f),root.lookup("mouseWheelSpeed").assign(g,root.scope,Symbol.hciAgent,f)}if(0!==d.deltaX){a.preventDefault(),a.stopPropagation();var m=root.lookup("touchPanX"),n=m.value(),o=d.deltaX*b;n+=o,m.assign(n,root.scope,Symbol.hciAgent,f),root.lookup("touchPanXSpeed").assign(o,root.scope,Symbol.hciAgent,f)}root.endAutocalcOff()}}).on("mouseout",function(a){c.mouseInfo.insideCanvas=!1;var b=root.lookup("mouseFollow").value();root.lookup("mouseZone").assign(void 0,root.scope,Symbol.hciAgent,b)}).on("mouseenter",function(a){var b=c.mouseInfo;if(!b.insideCanvas){b.insideCanvas=!0;var d;0==b.buttonCount?d="":(d="|",b.leftButton&&(d+="Left|"),b.middleButton&&(d+="Middle|"),b.rightButton&&(d+="Right|"),b.button4&&(d+="Button4|"),b.button5&&(d+="Button5|"));var e=root.lookup("mouseButtons"),f=e.value();if(d!=f){var g=root.lookup("mouseFollow").value();root.beginAutocalcOff(),e.assign(d,root.scope,Symbol.hciAgent,g),root.lookup("mouseButton").assign("Enter window",root.scope,Symbol.hciAgent,g);var h=root.lookup("mousePressed");h.value()!=b.leftButton&&h.assign(b.leftButton,root.scope,Symbol.hciAgent,g),""==f&&""!=d&&(root.lookup("mouseDown").assign(void 0,root.scope,Symbol.hciAgent,g),root.lookup("mouseDownWindow").assign(void 0,root.scope,Symbol.hciAgent,g)),root.endAutocalcOff()}}}).on("mousemove",function(a){var b=root.lookup("mouseFollow").value();root.beginAutocalcOff();var d,e,f=root.lookup("mousePosition"),g=root.lookup("_view_"+p+"_scale").value(),h=root.lookup("_view_"+p+"_zoom").value(),i=g*h;if(c.mouseInfo.capturing){var k=f.value(),l=a.originalEvent;d=k.x+l.movementX/i,e=k.y+l.movementY/i}else{var m=$(this).offset();d=(a.pageX-Math.round(m.left))/i,e=(a.pageY-Math.round(m.top))/i}var n;n=new Point(d,e),root.lookup("mouseWindow").assign(p,root.scope,Symbol.hciAgent,b),f.assign(n,root.scope,Symbol.hciAgent,b);var o=c.findZoneHit(p,j,d,e);root.lookup("mouseZone").assign(o,root.scope,Symbol.hciAgent,b),root.endAutocalcOff()}).on("keyup",function(a){var b=a.which,c=!1;if(a.altKey&&!a.shiftKey&&!a.ctrlKey){var d=root.lookup("_view_"+p+"_zoom"),e=d.value();61==b||187==b?(e=1.25*e,c=!0):173==b||189==b?(e/=1.25,c=!0):48==b&&(e=1,c=!0),d.assign(e,root.scope,Symbol.hciAgent)}c&&(a.preventDefault(),a.stopPropagation())}),$('<div id="'+b+'"></div>').html(m).dialog({title:i,width:H+a.scrollBarSize,height:I+a.titleBarHeight,minHeight:120,minWidth:230,dialogClass:"canvas-dialog unpadded-dialog"}),c.setPictureObs(p,j),o={confirmClose:!0,destroy:function(){delete canvases[p],delete contents[p],delete g[j][p],delete h[p]},resize:function(d,e){var f,g,h=v.value();h instanceof Point?(f=h.x,g=h.y):(f=0,g=0);var i,k,l=u.value(),m=document.getElementById(b+"-canvas"),n=!1,o=w.value();if(void 0===o?(i=l>1?Math.ceil(d*l):Math.floor(d),m.width!=i&&(m.width=i,n=!0)):o=Math.ceil(o*t.value()*l+f),void 0===x.value()){if(l>1)k=Math.ceil(e*l);else{k=e,void 0!==o&&o>k&&(k-=a.scrollBarSize);var k=Math.floor(k-1)}k!=m.height&&(m.height=k,n=!0)}n&&c.drawPicture(p,j)}}},root.lookup("mouseDownZone").addJSObserver("recordClick",function(a,b){eden.isValidIdentifier(b)&&root.lookup(b+"_click").assign(!0,root.scope,Symbol.hciAgent)}),this.endClick=function(){var a=root.lookup("mouseDownZone").value();eden.isValidIdentifier(a)&&root.lookup(a+"_click").assign(!1,root.scope,Symbol.hciAgent)},document.addEventListener("mouseup",function(b){var d=root.lookup("mouseFollow").value();root.beginAutocalcOff();var e=c.mouseInfo;if(!e.insideCanvas){var f;switch(b.button){case 0:e.leftButton=!1,f="Left";break;case 1:e.middleButton=!1,f="Middle";break;case 2:e.rightButton=!1,f="Right";break;case 3:e.button4=!1,f="Button4";break;case 4:e.button5=!1,f="Button5";break;default:f="Unknown"}e.buttonCount=e.leftButton+e.middleButton+e.rightButton+e.button4+e.button5;var g=root.lookup("mouseButtons");if(0==e.buttonCount&&""!=g.value()){var h=root.lookup("mousePressed"),i=h.value();root.lookup("mouseButton").assign(f+" up",root.scope,Symbol.hciAgent,d),g.assign("",root.scope,Symbol.hciAgent,d),root.lookup("mousePosition").assign(void 0,root.scope,Symbol.hciAgent,d),i&&h.assign(!1,root.scope,Symbol.hciAgent,d),root.lookup("mouseUp").assign(void 0,root.scope,Symbol.hciAgent,d),root.lookup("mouseWindow").assign(void 0,root.scope,Symbol.hciAgent,d),a.plugins.Canvas2D.endClick()}}root.endAutocalcOff()}),document.addEventListener("mousedown",function(a){var b=c.mouseInfo;if(!b.insideCanvas){switch(a.button){case 0:b.leftButton=!0;break;case 1:b.middleButton=!0;break;case 2:b.rightButton=!0;break;case 3:b.button4=!0;break;case 4:b.button5=!0}b.buttonCount=b.leftButton+b.middleButton+b.rightButton+b.button4+b.button5}}),document.addEventListener("pointerlockchange",function(a){var b=null!==document.pointerLockElement;c.mouseInfo.capturing=b;var d=root.lookup("mouseFollow").value();root.lookup("mouseCaptured").assign(b,root.scope,void 0,d)}),a.views.Canvas2D={dialog:this.createDialog,title:"Canvas 2D",category:a.viewCategories.visualization},a.eden.include("plugins/canvas-html5/jseden-canvas.min.js-e",b)},EdenUI.plugins.Canvas2D.FillStyle=function(){},EdenUI.plugins.Canvas2D.title="Canvas 2D",EdenUI.plugins.Canvas2D.description="Provides the ability to draw two-dimensional shapes, images, text and user interface controls using EDEN dependencies.";var edenfunctions={};EdenUI.plugins.SymbolViewer=function(a,b){var c=this;$.ajax({url:"library/functions.json",dataType:"json",success:function(a){edenfunctions=a},cache:!1,async:!0}),this.instances=[];var d=function(a,b){for(var c='			<div class="symbollist-search-box-outer"> 				<input type="text" class="symbollist-search symbollist-control" placeholder="search" /> 				<a class="symbollist-edit symbollist-control symbollist-rightmost-control">Edit Listed</a><br/> 				<select id="'+a+'-category-filter" class="symbollist-control"> 					<option value="user">Construal</option>',d=Eden.getSymbolCategories(b),e=0;e<d.length;e++)c=c+'<option value="'+d[e]+'">'+d[e]+"</option>";return c+='<option value="system">Complete Library</option> 					<option value="all">All Sources</option> 				</select>',"obs"==b&&(c=c+'				<select id="'+a+'-type-filter" class="symbollist-control symbollist-rightmost-control"> 					<option value="formulas">Dependencies</option>					<option value="vars">Base Observables</option>					<option value="all" selected="selected">All Kinds</option>				</select>'),c+='			</div> 			<div class="symbollist-results"></div>'};this.createDialog=function(b,e,f){var g=b.slice(0,-7),h=$('<div class="symbollist-outer"></div>');h.html(d(b,f));var i=new EdenUI.plugins.SymbolViewer.SymbolList(a.eden.root,h.find(".symbollist-results")[0],f);$dialog=$('<div id="'+b+'"></div>').append(h).dialog({title:e,width:360,height:400,minHeight:200,minWidth:200,dialogClass:"symbollist-dialog"}),c.instances.push(i),i.search(""),h.find(".symbollist-search-box-outer > .symbollist-edit").click(function(){var b="edit_"+g;a.createView(b,"ScriptInput"),a.eden.root.lookup("_view_"+b+"_title").assign("Script for "+g,Symbol.hciAgent),a.eden.root.lookup("_view_"+g+"_title").assign(e+" ("+g+")",Symbol.hciAgent),a.createView("edit_"+g,"ScriptInput");var c,d="";for(var f in i.symbols){c=a.eden.root.lookup(f);var h;h="function"==typeof c.value()&&void 0!==c.eden_definition?c.eden_definition:c.definition?c.eden_definition+";":f+" = "+Eden.edenCodeForValue(c.value())+";",d+=h+"\n"}$("#"+b+"-dialog").find("textarea").val(d)});var j=h.find(".symbollist-search-box-outer > .symbollist-search");j.keyup(function(){i.search(this.value)});var k=j.get(0);document.getElementById(b+"-category-filter").addEventListener("change",function(a){i.search(k.value,a.target.value)}),"obs"==f&&document.getElementById(b+"-type-filter").addEventListener("change",function(a){i.search(k.value,void 0,a.target.value)})},this.createObservableDialog=function(a,b){return c.createDialog(a,b,"obs")},this.createFunctionDialog=function(a,b){return c.createDialog(a,b,"func")},this.createAgentDialog=function(a,b){return c.createDialog(a,b,"agent")},this.createSymbolDialog=function(a,b){return c.createDialog(a,b,"all")};var e={},f={},g=!1;this.delay=40;var h=function(){for(x in c.instances){var a,b,d,h=c.instances[x];void 0===EdenUI.plugins.SymbolViewer.inlineEditorSymbol&&(a=$(h.symresults),b=a.parent(),d=a.scrollTop(),a.detach());for(var i in f){var j=f[i];h.addSymbol(j,i)}for(var i in e)h.updateSymbol(i);void 0===EdenUI.plugins.SymbolViewer.inlineEditorSymbol&&(a.appendTo(b),a.scrollTop(d))}e={},f={},g=!1},i=function(a,b){var d=a.name.substr(1);b?f[d]=a:e[d]=a,g||(g=!0,setTimeout(h,c.delay))};a.eden.root.addGlobal(i),a.views.ObservableList={dialog:this.createObservableDialog,title:"Observable List",category:a.viewCategories.comprehension,menuPriority:0},a.views.FunctionList={dialog:this.createFunctionDialog,title:"Function List",category:a.viewCategories.comprehension,menuPriority:0},a.views.AgentList={dialog:this.createAgentDialog,title:"Agent List",category:a.viewCategories.comprehension,menuPriority:0},a.views.SymbolList={dialog:this.createSymbolDialog,title:"Symbol List",category:a.viewCategories.comprehension,menuPriority:1},$(document).tooltip(),b()},EdenUI.plugins.SymbolViewer.title="Symbol Viewer",EdenUI.plugins.SymbolViewer.description="Provide various views of the symbol table.",EdenUI.plugins.SymbolViewer.inlineEditorSymbol=void 0,EdenUI.plugins.SymbolViewer.SymbolList=function(a,b,c){this.root=a,this.regExp=new RegExp(""),this.type=c,this.category="user",this.customCategory=!1,this.subtypes="all",this.symresults=b,this.symbols={}},EdenUI.plugins.SymbolViewer.SymbolList.prototype.search=function(a,b,c){this.regExp=new RegExp("^("+a+")","i"),void 0!==b&&(this.category=b,this.customCategory="user"!=b&&"system"!=b&&"all"!=b),void 0!==c&&(this.subtypes=c),EdenUI.closeTooltip(),this.symresults.innerHTML="",this.symbols={};var d,e;for(d in this.root.symbols)e=this.root.symbols[d],this.addSymbol(e,d)},EdenUI.plugins.SymbolViewer.SymbolList.prototype.updateSymbol=function(a){void 0!==this.symbols[a]&&this.symbols[a].update()},EdenUI.plugins.SymbolViewer.SymbolList.prototype.addSymbol=function(a,b){if(this.regExp.test(b)){if(this.customCategory){if(!Eden.isitCategory(b,this.category,this.type))return}else if(Eden.isitSystemSymbol(b)){if("user"==this.category)return}else if("system"==this.category)return;if(void 0!==a.eden_definition&&void 0!==a.definition){if("vars"==this.subtypes)return}else if("formulas"==this.subtypes)return;var c="obs";if(a.definition&&a.eden_definition){var d=a.eden_definition;c=/^proc\s/.test(d)?"agent":/^func\s/.test(d)?"func":"function"==typeof a.cache.value?/\breturn\s+([^\/;]|(\/[^*\/]))/.test(a.cache.value.toString())?"func":"agent":"obs"}else c="function"==typeof a.cache.value?/\breturn\s+([^\/;]|(\/[^*\/]))/.test(a.cache.value.toString())?"func":"agent":"obs";var e="all"==this.type||this.type==c;if(e){var f=new EdenUI.plugins.SymbolViewer.Symbol(a,b,c);f.element.appendTo(this.symresults),this.symbols[b]=f}}},EdenUI.plugins.SymbolViewer.Symbol=function(a,b,c){function d(){e.element.removeClass("symbollist-inline-editor"),e.update(),e.element.scrollLeft(0)}switch(this.symbol=a,this.name=b,this.type=c,this.element=$('<div class="symbollist-result-element"></div>'),this.details=void 0,this.update=void 0,c){case"func":this.update=this.updateFunction;break;case"agent":this.update=this.updateProcedure;break;case"obs":this.update=this.updateObservable}var e=this,f=!1;this.element.click(function(){EdenUI.plugins.SymbolViewer.inlineEditorSymbol||f||(f=!0,setTimeout(function(){if(!EdenUI.plugins.SymbolViewer.inlineEditorSymbol&&f){f=!1;var b="edit_"+e.name;edenUI.createView(b,"ScriptInput"),edenUI.eden.root.lookup("_view_"+b+"_title").assign("Script for "+e.name,Symbol.hciAgent);var c;c="function"==typeof a.value()&&void 0!==a.eden_definition?a.eden_definition:a.definition?a.eden_definition+";":e.name+" = "+Eden.edenCodeForValue(a.value())+";",$("#"+b+"-dialog").find("textarea").val(c)}},350))}),"obs"==c&&this.element.dblclick(function(){function a(){var a=l.get(0).value,b=o.value;";"!=b.slice(-1)&&(b+=";"),edenUI.plugins.ScriptInput.submitEdenCode(e.name+" "+a+" "+b),d(),EdenUI.plugins.SymbolViewer.inlineEditorSymbol=void 0}function c(b){var c=b.which;13==c?a():27==c&&(d(),EdenUI.plugins.SymbolViewer.inlineEditorSymbol=void 0)}if(f=!1,EdenUI.plugins.SymbolViewer.inlineEditorSymbol!==e){var g=e.symbol.cache.value;if(void 0!==e.symbol.eden_definition||"boolean"!=typeof g){EdenUI.plugins.SymbolViewer.inlineEditorSymbol=e,e.element.addClass("symbollist-inline-editor");var h=e.element.find(".result_value"),i=e.element.find(".result_separator");h.html("");var j,k;void 0!==e.symbol.eden_definition?(j=e.symbol.eden_definition.replace(new RegExp("^\\s*"+b+"\\s+is\\s+"),""),k="is"):(j=Eden.edenCodeForValue(g),k="=");var l=$("<select></select>");"="==k?(l.append('<option value="is">is</option>'),l.append('<option value="=" selected="selected">=</option>')):(l.append('<option value="is" selected="selected">is</option>'),l.append('<option value="=">=</option>')),i.html(" "),i.append(l);var m=Eden.htmlEscape(j,!0),n=$('<input type="text" value="'+m+'" spellcheck="false" style="width: 100%"/>'),o=n.get(0);n.on("keyup",c),n.on("blur",function(){setTimeout(function(){l.is(document.activeElement)||(d(),setTimeout(function(){EdenUI.plugins.SymbolViewer.inlineEditorSymbol===e&&(EdenUI.plugins.SymbolViewer.inlineEditorSymbol=void 0)},500))},0)}),l.on("keydown",c),l.on("blur",function(){setTimeout(function(){n.is(document.activeElement)||(d(),setTimeout(function(){EdenUI.plugins.SymbolViewer.inlineEditorSymbol===e&&(EdenUI.plugins.SymbolViewer.inlineEditorSymbol=void 0)},500))},0)}),h.append(n);var p=e.element.find(".symbollist-result-inner");p.length>0&&(p.get(0).onmouseenter=void 0),EdenUI.closeTooltip(),o.focus(),o.select();var q=j.slice(0,1);('"'==q||"'"==q||"["==q||"{"==q)&&(o.selectionStart=1,o.selectionEnd=j.length-1)}else g===!0?e.symbol.assign(!1,Symbol.hciAgent,!0):e.symbol.assign(!0,Symbol.hciAgent,!0)}}),this.update()},EdenUI.plugins.SymbolViewer.Symbol.prototype.updateFunction=function(){var a,b,c=this.symbol.eden_definition;if(a=void 0===c||/^func\s/.test(c)?this.name:"<span class='hasdef_text'>"+this.name+"</span>",void 0!=edenfunctions.functions&&void 0!==edenfunctions.functions[this.name]){this.details=edenfunctions.functions[this.name];var d=Object.keys(this.details.parameters||{});b="<span class='result_value'> ( "+d.join(", ")+" )</span>"}else b="";var e="<span class='result_name'>"+a+"</span>"+b;if(void 0!==c&&!/^func\s/.test(this.symbol.eden_definition)){var f=Eden.htmlEscape(c,!1,!0);f=Eden.htmlEscape("<pre>"+f+";</pre>"),e="<span class='symbollist-result-inner' onmouseenter='EdenUI.showTooltip(event, \""+f+"\")' onmouseleave='EdenUI.closeTooltip()'>"+e+"</span>"}this.element.html(e)},EdenUI.plugins.SymbolViewer.Symbol.prototype.updateObservable=function(){var a,b=this.symbol.value(),c=_formatVal(b);a=void 0!==this.symbol.definition?"<span class='hasdef_text'>"+this.name+"</span>":this.name;var d="<span class='result_name'>"+a+"</span><span class='result_separator'> = </span> <span class='result_value'>"+c+"</span>";if(void 0!==this.symbol.definition){var e=Eden.htmlEscape(this.symbol.eden_definition,!1,!0);e=Eden.htmlEscape("<pre class='symbollist-tooltip'>"+e+";</pre>"),d="<span class='symbollist-result-inner' onmouseenter='EdenUI.showTooltip(event, \""+e+"\")' onmouseleave='EdenUI.closeTooltip()'>"+d+"</span>"}this.element.html(d)},EdenUI.plugins.SymbolViewer.Symbol.prototype.updateProcedure=function(){var a,b,c=this.symbol.eden_definition;if(a=void 0===c||/^proc\s/.test(c)?this.name:"<span class='hasdef_text'>"+this.name+"</span>",void 0!=edenfunctions.functions&&void 0!==edenfunctions.procedures[this.name]){this.details=edenfunctions.procedures[this.name];var d=Object.keys(this.details.parameters||{});b="<span class='result_value'> ( "+d.join(", ")+" )</span>"}else b="";var e="<span class='result_name'>"+a+"</span>"+b;if(void 0!==c&&!/^proc\s/.test(this.symbol.eden_definition)){var f=Eden.htmlEscape(c,!1,!0);f=Eden.htmlEscape("<pre>"+f+";</pre>"),e="<span class='symbollist-result-inner' onmouseenter='EdenUI.showTooltip(event, \""+f+"\")' onmouseleave='EdenUI.closeTooltip()'>"+e+"</span>"}this.element.html(e)},EdenUI.plugins.HTMLContent=function(a,b){this.html=function(b,c){b in a.viewInstances||a.createView(b,"HTMLContent"),$("#"+b+"-dialog-content").html(c)},this.createDialog=function(a,b){var c=$('<div id="'+a+'-content" class="htmlviews-content"></div>');return $('<div id="'+a+'"></div>').html(c).dialog({title:b,width:600,height:450,minHeight:120,minWidth:230}),{confirmClose:!0}},a.views.HTMLContent={dialog:this.createDialog,title:"HTML Content",category:a.viewCategories.visualization},a.eden.include("plugins/html-views/html.js-e",b)},EdenUI.plugins.HTMLContent.title="HTML Content",EdenUI.plugins.HTMLContent.description="Provides construals with the ability to create windows dedicated to displaying HTML content created using EDEN code.",EdenUI.plugins.ExpressionTree=function(a,b){var c=this;this.createDialog=function(a,b){var c='<div style="width: 300px; height: 450px" class="etdiv"><div id="infovis" style="width: 300px; height: 450px"></div></div>';$dialog=$('<div id="'+a+'"></div>').html(c).dialog({title:b,width:300,height:450,minHeight:120,minWidth:230})};var d=function(a,b,c,d,e){var f=function(g,h,i){if(!g.hasOwnProperty("children"))return g.name;var j,k,l,m=g.name,n=g.children;if(b.hasOwnProperty(m)&&2==n.length){j=b[m],k=j.precedence;var o=j.associativity,p=f(n[0],k,j.text),q=f(n[1],k,j.text);if("left"==o){var r=n[1].name;n[1].hasOwnProperty("children")&&2==n[1].children.length&&b.hasOwnProperty(r)&&k==b[r].precedence&&(q="("+q+")")}else{var s=n[0].name;n[0].hasOwnProperty("children")&&2==n[0].children.length&&b.hasOwnProperty(s)&&k==b[s].precedence&&(p="("+p+")")}l=j.whitespace?p+" "+j.text+" "+q:p+j.text+q}else if(a.hasOwnProperty(m))j=a[m],k=j.precedence,l=j.text+f(n[0],k,j.text);else if(c.hasOwnProperty(m))j=c[m],k=j.precedence,l=f(n[0],k,j.text)+j.text;else if(d.hasOwnProperty(m))j=d[m],this.precedence=j.precedence,l=j.code(n,i);else{k=e;for(var t=[],u=0;u<n.length;u++)t.push(f(n[u],0,void 0));l=m+"("+t.join(", ")+")"}return h>k&&(l="("+l+")"),l};return function(a){return f(a,0,void 0)}},e={};e["="]={precedence:1,associativity:"right",text:"=",whitespace:!0},e["+="]={precedence:1,associativity:"right",text:"+=",whitespace:!0},e["-="]={precedence:1,associativity:"right",text:"-=",whitespace:!0},e["||"]={precedence:3,associativity:"left",text:"||",whitespace:!0},e.or={precedence:3,associativity:"left",text:"or",whitespace:!0},e["&&"]={precedence:4,associativity:"left",text:"&&",whitespace:!0},e.and={precedence:4,associativity:"left",text:"and",whitespace:!0},e["=="]={precedence:5,associativity:"left",text:"==",whitespace:!0},e["!="]={precedence:5,associativity:"left",text:"!=",whitespace:!0},e["<"]={precedence:6,associativity:"left",text:"<",whitespace:!0},e["<="]={precedence:6,associativity:"left",text:"<=",whitespace:!0},e[">"]={precedence:6,associativity:"left",text:">=",whitespace:!0},e[">="]={precedence:6,associativity:"left",text:">",whitespace:!0},e["=~"]={precedence:6,associativity:"left",text:"=~",whitespace:!0},e["!~"]={precedence:6,associativity:"left",text:"!=",whitespace:!0},e["//"]={precedence:7,associativity:"left",text:"//",whitespace:!0},e["+"]={precedence:8,associativity:"left",text:"+",whitespace:!0},e["-"]={precedence:8,associativity:"left",text:"-",whitespace:!0},e["*"]={precedence:9,associativity:"left",text:"*",whitespace:!0},e["/"]={precedence:9,associativity:"left",text:"/",whitespace:!0},e["%"]={precedence:9,associativity:"left",text:"%",whitespace:!0},e["^"]={precedence:11,associativity:"right",text:".",whitespace:!1},e["."]={precedence:14,associativity:"left",text:".",whitespace:!1};var f={};f["-"]={precedence:10,text:"-"},f["!"]={precedence:10,text:"!"},f["&"]={precedence:10,text:"&"},f.not={precedence:10,text:"!"},f["++."]={precedence:11,text:"++"},f["--."]={precedence:11,text:"--"},f["*"]={precedence:12,text:"*"};var g={};g["#"]={precedence:11,text:"#"},g[".++"]={precedence:11,text:"++"},g[".--"]={precedence:11,text:"--"};var h={},i=13;this.convertTreeToEden=d(f,e,g,h,i),h["?"]={precedence:2,code:function(a){var b=c.convertTreeToEden(a[0]),d=c.convertTreeToEden(a[1]),e=c.convertTreeToEden(a[2]);return b+"? "+d+" : "+e}},h["`...`"]={precedence:13,code:function(a){var b=c.convertTreeToEden(a[0]);return"`"+b+"`"}},h["${{...}}$"]={precedence:13,code:function(a){var b=a[0].name;return"${{ "+b+" }}$"}},h["(...)"]={precedence:13,code:function(a){for(var b=c.convertTreeToEden(a[0]),d=[],e=1;e<a.length;e++)d.push(c.convertTreeToEden(a[e]));return"("+b+")("+d.join(", ")+")"}},h["[...]"]={precedence:13,code:function(a){for(var b=[],d=0;d<a.length;d++)b.push(c.convertTreeToEden(a[d]));
return"["+b.join(", ")+"]"}},h["[n]"]={precedence:13,code:function(a){var b=c.convertTreeToEden(a[0]),d=c.convertTreeToEden(a[1]);return b+"["+d+"]"}},h["{...}"]={precedence:13,code:function(a){for(var b=[],d=0;d<a.length-1;d+=2)b.push(a[d].name+": "+c.convertTreeToEden(a[d+1]));return"{"+b.join(", ")+"}"}},h.Point={precedence:13,code:function(a,b){if("."==b){for(var d=[],e=0;e<a.length;e++)d.push(c.convertTreeToEden(a[e]));return"Point("+d.join(", ")+")"}var f=c.convertTreeToEden(a[0]),g=c.convertTreeToEden(a[1]);return"{"+f+", "+g+"}"}},a.views.ExpressionTree={dialog:this.createDialog,title:"Expression Tree",category:a.viewCategories.interpretation,menuPriority:0}},EdenUI.plugins.ExpressionTree.title="Expression Tree",EdenUI.plugins.ExpressionTree.description="Provides a graphical user interface for creating dependencies.",Eden.initiallyDefined=["_view_picture_background_colour","_view_picture_offset","_view_picture_scale","edenclocks","edenclocks_paused","menus","mouseCapture","mouseContextMenuEnabled","mouseFollow","mouseWheelEnabled","picture","px","radiansPerUnit","randomGenerator","randomSeed","touchPinchEnabled"],Eden.systemObservableNames={_authoringMode:!0,_menubar_status:!0,PI:!0,autocalc:!0,debug:!0,mouseButton:!0,mouseButtons:!0,mouseCaptured:!0,mouseDoubleClicks:!0,mouseDown:!0,mouseDownWindow:!0,mouseDownZone:!0,mousePosition:!0,mousePressed:!0,mouseUp:!0,mouseWheel:!0,mouseWheelSpeed:!0,mouseWindow:!0,mouseX:!0,mouseY:!0,mouseZone:!0,px:!0,randomGeneratorState:!0,randomIndex:!0,screenHeight:!0,screenWidth:!0,touchPanX:!0,touchPanXSpeed:!0,touchPinch:!0,_views_frame_width:!0,_views_frame_height:!0,_views_list:!0,_views_number_created:!0,_views_unit_x:!0,_views_unit_y:!0},Eden.systemAgentNames={alias:!0,arrangeWindows:!0,attemptMouseCapture:!0,bindCSSNumericProperty:!0,bindCSSProperty:!0,bindCSSRule:!0,createCanvas:!0,createHTMLView:!0,createProjectList:!0,createView:!0,destroyView:!0,eager:!0,error:!0,hideView:!0,highlightView:!0,html:!0,moveView:!0,patch:!0,removeedenclock:!0,resizeView:!0,setedenclock:!0,setProperty:!0,showObservables:!0,showView:!0,stopHighlightingView:!0,todo:!0,touch:!0,unbind:!0,withAppendedItem:!0,writeln:!0},Eden.systemFunctionNames={Arc:!0,BulletSlide:!0,Button:!0,Checkbox:!0,Circle:!0,Combobox:!0,Div:!0,Ellipse:!0,FillPattern:!0,GreyPixelList:!0,HTMLImage:!0,Image:!0,Line:!0,LinearGradient:!0,LineSequence:!0,List:!0,Menu:!0,MenuItem:!0,Pixel:!0,PixelList:!0,Point:!0,Polygon:!0,RadialGradient:!0,RadioButtons:!0,RE:!0,Rectangle:!0,RegularPolygon:!0,RoundedRectangle:!0,Sector:!0,Shadow:!0,Slide:!0,Slider:!0,Text:!0,Textbox:!0,TitledSlide:!0,TitleSlide:!0,Video:!0,abs:!0,acos:!0,apply:!0,array:!0,asin:!0,atan:!0,canvasURL:!0,ceil:!0,centroid:!0,"char":!0,charCode:!0,choose:!0,compose:!0,concat:!0,cos:!0,curry:!0,decodeHTML:!0,definitionOf:!0,definitionRHS:!0,doDefault:!0,edenCode:!0,escapeRE:!0,execute:!0,exp:!0,floor:!0,foldl:!0,foldr:!0,forget:!0,forgetAll:!0,generate_function:!0,hasProperty:!0,hsl2colour:!0,htmlBulletList:!0,htmlNumberedList:!0,imageWithZones:!0,include:!0,include_css:!0,indexOf:!0,indexOfRE:!0,"int":!0,isBoolean:!0,isCallable:!0,isChar:!0,isDefined:!0,isDependency:!0,isDependent:!0,isFunc:!0,isInt:!0,isList:!0,isNaN:!0,isNumber:!0,isObject:!0,isPoint:!0,isPointer:!0,isProc:!0,isString:!0,isValue:!0,length:!0,ln:!0,log:!0,lookup:!0,lowercase:!0,map:!0,mapPartial:!0,max:!0,min:!0,mod:!0,nameof:!0,partApply:!0,pow:!0,properties:!0,rand:!0,random:!0,randomBoolean:!0,randomFloat:!0,randomInteger:!0,replaceFirst:!0,require:!0,reverse:!0,rgb2colour:!0,rotatePoint:!0,round:!0,roundDown:!0,roundMultiple:!0,roundUp:!0,scalePoint:!0,search:!0,sequenceItoJ:!0,sequenceN:!0,sequenceArithmetic:!0,sequenceArithmeticN:!0,sequenceList:!0,sequencePrevious:!0,sin:!0,sort:!0,sqrt:!0,str:!0,sublist:!0,substitute:!0,substr:!0,sum:!0,tail:!0,tan:!0,textWidth:!0,textHeight:!0,time:!0,trim:!0,type:!0,uppercase:!0,xorshiftRandomGenerator:!0,zoneOnTopAt:!0,zonesAt:!0},Eden.symbolCategories={},Eden.symbolCategories["Canvas 2D"]={obs:{_view_picture_background_colour:!0,_view_picture_offset:!0,_view_picture_scale:!0,_view_picture_title:!0,_view_picture_width:!0,_view_picture_height:!0,menus:!0,mouseButton:!0,mouseButtons:!0,mouseCapture:!0,mouseCaptured:!0,mouseContextMenuEnabled:!0,mouseDoubleClicks:!0,mouseDown:!0,mouseDownWindow:!0,mouseDownZone:!0,mouseFollow:!0,mousePosition:!0,mousePressed:!0,mouseUp:!0,mouseWheel:!0,mouseWheelEnabled:!0,mouseWheelDir:!0,mouseWindow:!0,mouseX:!0,mouseY:!0,mouseZone:!0,picture:!0,px:!0,radiansPerUnit:!0,touchScrollX:!0,touchScrollXDir:!0},agent:{attemptMouseCapture:!0,bindCSSNumericProperty:!0,bindCSSProperty:!0,bindCSSRule:!0,createCanvas:!0,destroyView:!0,include_css:!0,unbind:!0},func:{Arc:!0,Button:!0,canvasURL:!0,centroid:!0,Checkbox:!0,Circle:!0,Combobox:!0,Div:!0,Ellipse:!0,FillPattern:!0,GreyPixelList:!0,hsl2colour:!0,HTMLImage:!0,Image:!0,imageWithZones:!0,length:!0,Line:!0,LinearGradient:!0,LineSequence:!0,Menu:!0,MenuItem:!0,Pixel:!0,PixelList:!0,Point:!0,Polygon:!0,RadialGradient:!0,RadioButtons:!0,Rectangle:!0,RegularPolygon:!0,rgb2colour:!0,rotatePoint:!0,RoundedRectangle:!0,Sector:!0,scalePoint:!0,Shadow:!0,Slider:!0,Text:!0,Textbox:!0,textWidth:!0,textHeight:!0,Video:!0,zoneOnTopAt:!0,zonesAt:!0}},Eden.symbolCategories.Math={obs:{PI:!0,radiansPerUnit:!0,randomGeneratorState:!0,randomIndex:!0,randomSeed:!0},func:{abs:!0,acos:!0,asin:!0,atan:!0,ceil:!0,cos:!0,exp:!0,floor:!0,length:!0,ln:!0,log:!0,max:!0,min:!0,mod:!0,pow:!0,random:!0,randomBoolean:!0,randomInteger:!0,randomFloat:!0,rotatePoint:!0,round:!0,roundDown:!0,roundUp:!0,roundMultiple:!0,scalePoint:!0,sin:!0,sqrt:!0,sum:!0,tan:!0}},Eden.isitSystemSymbol=function(a){return Eden.isitSystemObservable(a)||Eden.isitSystemAgent(a)||Eden.isitSystemFunction(a)},Eden.isitSystemObservable=function(a){return/^_view_/.test(a)&&!/_(background_colour|offset|scale)$/.test(a)?!0:a in Eden.systemObservableNames},Eden.isitSystemAgent=function(a){return/^_View_/.test(a)?!0:a in Eden.systemAgentNames},Eden.isitSystemFunction=function(a){return a in Eden.systemFunctionNames},Eden.isitCategory=function(a,b,c){var d=Eden.symbolCategories[b];return"all"==c?"obs"in d&&a in d.obs||"agent"in d&&a in d.agent||"func"in d&&a in d.func:c in d&&a in d[c]},Eden.getSymbolCategories=function(a){if("all"==a)return Object.keys(Eden.symbolCategories);var b=[];for(var c in Eden.symbolCategories)a in Eden.symbolCategories[c]&&b.push(c);return b},EdenUI.plugins.SymbolLookUpTable=function(a,b){this.createDialog=function(a,b){code_entry=$('<div id="'+a+'-content" class="symbol-lookup-table-content">'+c(a)+"</div>"),$dialog=$('<div id="'+a+'"></div>').html(code_entry).dialog({title:b,width:600,height:450,minHeight:120,minWidth:230})},a.views.SymbolLookUpTable={dialog:this.createDialog,title:"Symbol Look-Up Table",category:edenUI.viewCategories.comprehension,menuPriority:3},this.search=function(a){var b=document.getElementById(a+"-regexp").value;void 0!=b&&(document.getElementById(a+"-table-div").innerHTML=d(b,a))};var c=function(a){var b="<input id='"+a+"-regexp' class='SLTregex' type='text' onkeyUp=\"edenUI.plugins.SymbolLookUpTable.search('"+a+"')\" placeholder='search' onload='setFocus()' />",c="<div class='upper'>"+b+"</div><div id='"+a+"-table-div' class='lower'>"+d("",a)+"</div>";return c},d=function(a,b){var c='<tr><td class="lower"><b>Name</b></td><td class="lower"><b>Type</b></td><td class="lower"><b>Definition</b></td><td class="lower"><b>Current Value</b></td><td class="lower"><b>Watches</b></td><td class="lower"><b>Updates</b><td class="lower"><b>Backticks</b><td class="lower"><b>Last Modified By</b></td><td class="lower"><b>JavaScript Actions</b></td></tr>';tableBodyHTML="";var d,h=new RegExp("^("+a+")","i"),i=[],j={};for(var k in root.symbols)if(d=root.symbols[k],h.test(k)){var l,m,n;if(void 0===d.eden_definition)m="-",l="function"==typeof d.cache.value?"Function":"Observable",n=Eden.htmlEscape(Eden.edenCodeForValue(d.cache.value));else if(m=Eden.htmlEscape(d.eden_definition),0==m.indexOf("proc")){if(Eden.isitSystemAgent(k)&&!new RegExp("\\b"+k+"\\b").test(a))continue;l="Agent",n=""}else if(0==m.indexOf("func")){if(Eden.isitSystemFunction(k)&&!new RegExp("\\b"+k+"\\b").test(a))continue;l="Function",n=""}else l="Dependency",n=Eden.htmlEscape(Eden.edenCodeForValue(d.cache.value));i.push([d,k,l,m,n]),j[k]=!0}for(var o=0;o<i.length;o++){var p=i[o];d=p[0];var q=e(d.observees,j,b),r=e(d.dependencies,j,b),s=q;""!=q&&""!=r&&(s+=", "),s+=r;var t=e(d.observers,j,b),u=e(d.subscribers,j,b),v=t;""!=t&&""!=u&&(v+=", "),v+=u;var w=f(d.dynamicDependencyTable,j,b),x=d.last_modified_by?d.last_modified_by:"Not yet defined";x=g(x,j,b);var y=Object.keys(d.jsObservers).join(", "),z="<tr id='"+b+"-symbol-"+p[1]+'\'><td class="lower"><p>'+p[1]+'</p></td><td class="lower"><p>'+p[2]+'</p></td><td class="lower"><p>'+p[3]+'</p></td><td class="lower"><p>'+p[4]+'</p></td><td class="lower"><p>'+s+'</p></td><td class="lower"><p>'+v+'</p></td><td class="lower"><p>'+w+'</p></td><td class="lower"><p>'+x+'</p></td><td class="lower"><p>'+y+"</p></td></tr>";/^((_view_.*)|mousePosition|mouseWindow)$/.test(p[1])?tableBodyHTML+=z:tableBodyHTML=z+tableBodyHTML}return"<table>"+c+tableBodyHTML+"</table>"},e=function(a,b,c){var d=[];for(var e in a){var f=e.slice(1);d.push(g(f,b,c))}return d.join(", ")},f=function(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=a[e];void 0===f&&(f=""),d.push(g(f,b,c))}return d.join(", ")},g=function(a,b,c){return"*"==a[0]||"include"==a||"Not yet defined"==a?a:a in b?"<a href=\"javascript:edenUI.plugins.SymbolLookUpTable.jump('"+c+"-symbol-"+a+"')\">"+a+"</a>":"<a href=\"javascript:edenUI.plugins.SymbolLookUpTable.addSymbolToSearch('"+c+"', '"+a+"')\">"+a+"</a>"};this.addSymbolToSearch=function(a,b){var c=document.getElementById(a+"-regexp"),d=c.value+"|"+b+"$";c.value=d,this.search(a)},this.jump=function(a){var b=location.href;location.href="#"+a,history.replaceState(null,null,b)},b()},EdenUI.plugins.SymbolLookUpTable.title="Symbol Look-Up Table",EdenUI.plugins.SymbolLookUpTable.description="Displays detailed information about symbols.",EdenUI.plugins.SymbolLookUpTable.originalAuthor="Joe Butler";var edenfunctions={};SymbolMeta=function(a){this.symbol=a,this.interestingness=0,this.significance=.5,this.index=0,this.isinteresting=!1,this.oldstr=""},SymbolMeta.DependencyComplexityRate=.4,SymbolMeta.DependencyChangeProbability=.01,SymbolMeta.SubscriberRate=.1,SymbolMeta.DecayRate=.9999,SymbolMeta.DependencyPercentage=.5,SymbolMeta.SubscriberPercentage=.5,SymbolMeta.SigDeleteRate=.1,SymbolMeta.SigInterestingRate=1.01,SymbolMeta.prototype.dependencyInterestingness=function(a){var b=0,c=0,d=.1;for(var e in this.symbol.dependencies){b++,d+=(1-d)*SymbolMeta.DependencyComplexityRate;var f=e.substr(1);void 0!==a.meta[f]&&a.meta[f].interestingness>=a.minInteresting()&&c++}return d-=b*SymbolMeta.DependencyChangeProbability,0!=b&&(d=.5*d+.5*(c/b)),0>d?0:d},SymbolMeta.prototype.subscriberInterestingness=function(a){var b=0,c=0,d=0;for(var e in this.symbol.subscribers){b++,d+=(1-d)*SymbolMeta.SubscriberRate;var f=e.substr(1);void 0!==a.meta[f]&&a.meta[f].interestingness>=a.minInteresting()&&c++}return d=1-d,0!=b&&(d=.5*d+.5*(c/b)),d},SymbolMeta.prototype.nameInterestingness=function(){var a=this.symbol.name.substr(1);return"_"==a[0]?.5:/\d/.test(a)?.9:1},SymbolMeta.prototype.frequencyInterestingness=function(){},SymbolMeta.prototype.update=function(a){var b=0;b=this.dependencyInterestingness(a)*this.subscriberInterestingness(a)*this.nameInterestingness()*this.significance,this.interestingness=b},EdenUI.plugins.ObservableMining=function(a,b){var c=this;this.meta={},this.interesting=[],this.limitInteresting=15,this.symresults=void 0,this.symbolsui=[];var d=function(a){var b='<div class="symbolframer-results"></div>';return b};this.createDialog=function(a,b){var e=(a.slice(0,-7),$("<div></div>"));e.html(d(a)),c.symresults=e.find(".symbolframer-results")[0],$dialog=$('<div id="'+a+'"></div>').html(e).dialog({title:b,width:360,height:400,minHeight:200,minWidth:200,dialogClass:"unpadded-dialog"})},this.delay=100;var e=void 0,f=function(){if(void 0!==c.symresults){var a=$(c.symresults).parent();$(c.symresults).detach();for(var b=0;b<c.symbolsui.length;b++)if(c.symbolsui[b].meta.dodelete)c.symbolsui.splice(b,1);else if(0==c.symbolsui[b].meta.isinteresting){var d=c.symbolsui[b].element;c.symbolsui[b].element.hide("drop",{direction:"right"},"slow",function(){d.remove()}),c.symbolsui.splice(b,1)}for(var g=c.minInteresting(),h=c.maxInteresting(),b=0;b<c.interesting.length;b++){for(var i=!1,j=0;j<c.symbolsui.length;j++)if(c.symbolsui[j].meta==c.interesting[b]){i=!0;break}if(!i){var k=new EdenUI.plugins.ObservableMining.Symbol;c.symbolsui.push(k),k.element.appendTo(c.symresults),k.symbol=c.interesting[b].symbol;var l=k.symbol.name.substr(1);k.name=l,k.meta=c.interesting[b],k.outofdate=!0,k.symbolChanged=e}}for(var b=0;b<c.symbolsui.length;b++)c.symbolsui[b].update(g,h);$(c.symresults).appendTo(a)}for(var b=0;b<c.interesting.length;b++)c.interesting[b].interestingness*=SymbolMeta.DecayRate;setTimeout(f,c.delay)};f(),e=function(a,b){var d=a.name.substr(1),e=c.meta[d];if(void 0!==c.symresults){if(a.definition&&a.eden_definition){var f=a.eden_definition;if(/^proc\s/.test(f))return;if(/^func\s/.test(f))return;if("function"==typeof a.cache.value)return}else if("function"==typeof a.cache.value)return;if((b||void 0===e)&&(c.meta[d]=new SymbolMeta(a),e=c.meta[d]),e.update(c),0==e.isinteresting&&(c.interesting.sort(function(a,b){return b.interestingness-a.interestingness}),e.interestingness>=c.minInteresting())){c.interesting.length;if(c.interesting.length==c.limitInteresting){var g=c.interesting[c.interesting.length-1];g.isinteresting=!1,c.interesting.pop()}c.interesting.push(e),e.isinteresting=!0,e.significance*=SymbolMeta.SigInterestingRate,c.interesting.sort(function(a,b){return b.interestingness-a.interestingness})}}},a.eden.root.addGlobal(e),a.views.ObservableMining={dialog:this.createDialog,title:"Observable Mining",category:a.viewCategories.comprehension,menuPriority:1},$(document).tooltip(),b()},EdenUI.plugins.ObservableMining.prototype.minInteresting=function(){return this.interesting.length>0?this.interesting[this.interesting.length-1].interestingness:0},EdenUI.plugins.ObservableMining.prototype.maxInteresting=function(){return this.interesting.length>0?this.interesting[0].interestingness:0},EdenUI.plugins.ObservableMining.title="Observable Mining",EdenUI.plugins.ObservableMining.description="Automatically generate search for interesting observables",EdenUI.plugins.ObservableMining.Symbol=function(){this.symbol=void 0,this.name=void 0,this.meta=void 0,this.element=$('<div class="symbolframer-result-element"><div class="observable"></div></div>'),this.details=void 0,this.update=void 0,this.outofdate=!1,this.dodelete=!1,this.symbolChanged=void 0,this.editing=!1,this.update=this.updateObservable;var a=this;this.element.hover(function(){$(this).animate({backgroundColor:"#eaeaea"},100)},function(){$(this).animate({backgroundColor:"#fafafa"},100),1==a.editing&&(a.editing=!1,a.element.find("textarea").remove(),a.element.animate({height:"20px"},"fast"))}).click(function(){if(!a.editing){var b;b="function"==typeof a.symbol.value()&&void 0!==a.symbol.eden_definition?a.symbol.eden_definition:a.symbol.definition?a.symbol.eden_definition+";":a.name+" = "+Eden.edenCodeForValue(a.symbol.value())+";",a.element.animate({height:"60px"},{duration:200,complete:function(){var c=$('<textarea class="mine_edit_box" style="display: none"></textarea>');c.val(b),c.appendTo(a.element),c.show("fast")}}),a.editing=!0}}).draggable({distance:40,axis:"x",scroll:!1,drag:function(b,c){c.position.left>150?a.dodelete=!0:a.dodelete=!1},revert:function(b,c){return!a.dodelete},stop:function(b,c){a.dodelete&&(a.meta.significance*=SymbolMeta.SigDeleteRate,console.log("Old I: "+a.meta.interestingness),a.symbolChanged(a.symbol,!1),console.log("New I: "+a.meta.interestingness),a.element.hide("drop",{direction:"right"},"slow",function(){a.element.remove()}))}})},EdenUI.plugins.ObservableMining.Symbol.prototype.updateObservable=function(a,b){if(void 0!==this.symbol){0==b&&(b=1);var c,d=(this.meta.interestingness-a)*(1/(b-a)),e=Math.round(8+12*d),f=this.symbol.value(),g=_formatFramerVal(f);c=void 0!==this.symbol.definition?"<span class='hasdef_text'>"+this.name+"</span>":this.name;var h="<span>"+c+"</span><span class='result_separator'> = </span> <span class='result_value'>"+g+"</span>";if(void 0!==this.symbol.definition){var i=Eden.htmlEscape(this.symbol.eden_definition,!1,!0);i=Eden.htmlEscape("<pre class='symbollist-tooltip'>"+i+";</pre>"),h="<span onmouseenter='EdenUI.showTooltip(event, \""+i+"\")' onmouseleave='EdenUI.closeTooltip()'>"+h+"</span>"}var j=this.element.find(".observable");j.html(h),j.css({"font-size":e+"px"})}},EdenUI.plugins.ScriptGenerator=function(a,b){function c(a,b){for(var c=a.length;b>c;c++)a+=" ";return a}var d=this;this.createDialog=function(b,c){var d,f=b.slice(0,-7),g=$('<div class="script-generator"></div>'),h=$("<div></div>");g.append(h);var i=$('<div class="script-generator-controls"></div>');h.append(i);var j=$('<div class="script-generator-controls" style="float: right"></div>');h.append(j);var k=$('<textarea class="script-generator-code" readonly="readonly" spellcheck="false"></textarea>');g.append(k);var l=$("<select></select>");i.append(l);var m=$('<input placeholder="excluded symbols"/>'),n=m.get(0);i.append(m);var o=$('<input type="checkbox" />');d=$("<label>Preserve screen layout</label>"),d.prepend(o),j.append(d);var p=o.get(0),q=$("<button>Regenerate Script</button>");j.append(q);var r=function(){l.html('<option value="">Working Script</option>');for(var b=a.eden.getAllIncludedURLs(),c=0;c<b.length;c++){var d,e=b[c],f=/([^/]+)\.(js)?(-?e)?$/.exec(e);null===f&&(f=/([^/]*)\/?$/.exec(e)),d=f[1],"run"==d&&(f=/(^|\/)([^/]*)\/[^/]*$/.exec(e),null!==f&&(d=f[2]+"/run"));var g=$('<option value="'+e+'">'+d+"</option>");l.append(g)}},s=function(){k.html(e(n.value,p.checked,f))};l.on("change",function(a){var b=a.target.value;return""==b?void s():void $.ajax({url:b,dataType:"text",success:function(a){k.html(a)}})}),m.on("keyup",s),o.on("change",s),q.click(function(){r(),s()}),r(),s(),$('<div id="'+b+'"></div>').html(g).dialog({title:c,width:790,height:700,minHeight:120,minWidth:230})};var e=function(a,b,c){for(var e=d.generateScriptLines(a,b,c),f="",g=0;g<e.length;g++)f=f+Eden.htmlEscape(e[g],!0)+"\n";return f},f={header1:"## This is a JS-EDEN script automatically generated using the environment's script generator feature.",header2:"## JS-EDEN is an open source empirical modelling environment based on research, principles and work",header3:"## conducted at University of Warwick.",homePage:"## Web site: https://github.com/EMGroup/js-eden",include:"## Include Files:",autocalcOff:"## Turn off automatic calculation until the construal is fully loaded.",assignments:"## Observable Assignments:",definitions:"## Observable Definitions:",procedures:"## Action Definitions:",functions:"## Function Definitions:",picture:"## Picture Definition:",views:"## View Configuration:",autocalcOn:"## Turn on automatic calculation and execute any triggered actions pending.",impliedByExecute:"## Definitions implied by loading the original script (execute procedure):",impliedOther:"## Definitions implied by loading the original script (other):",end:"## End of automatically generated script."};this.generateScriptLines=function(a,b,d){var e=[],g=[],h=[],i=[],j=[],k=[],l=[],m="autocalc = 1;",n="autocalc = 0;",o=32,p=root.lookup("picture").eden_definition;void 0===p?p="picture is [];":p+=";";var q;void 0!==a&&""!=a&&(q=new RegExp(a));for(var r in root.symbols)if(void 0===q||!q.test(r)){var s=root.symbols[r],t=Eden.isitSystemObservable(r),u=!1;if("include"!=s.last_modified_by&&"system"!=s.last_modified_by&&"createView"!=s.last_modified_by&&!/^(autocalc|picture|randomIndex|randomGeneratorState|screenWidth|screenHeight)$/.test(r)&&(!/^(mouse|touch)[A-Z]/.test(r)||!t)&&(!/_click(ed)?$/.test(r)||void 0!==s.eden_definition)&&!/^_(View|views)_/.test(r)&&(!/^_view_/.test(r)||(u=!0,b&&-1==r.search("^_view_"+d)||!t||void 0!==s.definition))){if(r in this.baseConstrualSymbols){var v=this.baseConstrualSymbols[r];if(s.last_modified_by==v.last_modified_by){var w=void 0;if(void 0!==v.eden_definition?s.eden_definition==v.eden_definition&&void 0!==s.definition&&(w=s.eden_definition+";"):s.cached_value===v.cached_value&&(w=r+" = "+Eden.edenCodeForValue(s.cached_value)+";"),void 0!==w){"execute"==s.last_modified_by?(w="  "+w.replace(/\n/g,"\n"),j.push(w)):(w=c("  "+w.replace(/\n/g,"\n  "),o)+"  ## Set by "+s.last_modified_by+".",k.push(w));continue}}}if(void 0!==s.last_modified_by)if(u)void 0!==s.eden_definition&&void 0!==s.definition?l.push(s.eden_definition+";"):l.push(r+" = "+Eden.edenCodeForValue(s.cached_value)+";");else if(void 0!==s.eden_definition&&void 0!==s.definition)/^func\s/.test(s.eden_definition)?i.push(s.eden_definition):/^proc\s/.test(s.eden_definition)?h.push(s.eden_definition):e.push(s.eden_definition+";");else{var x,y=s.cached_value;if("string"==typeof y&&/[^ -~\t\n]/.test(y)){var z=y.replace(/[^ -~\t\n]/g,function(a){return"&#"+a.charCodeAt(0)+";"});x="decodeHTML("+Eden.edenCodeForValue(z)+")"}else x=Eden.edenCodeForValue(y);g.push(r+" = "+x+";")}else k.push(c("  "+r+" = @;",o)+"  ## Referenced but not defined.")}}void 0!==root.lookup("randomSeed").value()&&g.push("randomIndex = "+root.lookup("randomIndex").value()+";");var A=[];A.push(f.header1),A.push(""),A.push(f.header2),A.push(f.header3),A.push(f.homePage),A.push("");var B=eden.getIncludedURLs();if(B.length>0){A.push(f.include);for(var C=0;C<B.length;C++)A.push('include("'+B[C]+'");');A.push("")}A.push(f.autocalcOff),A.push(n),A.push(""),A.push(f.assignments);for(var C=0;C<g.length;C++)A.push(g[C]);A.push(""),A.push(f.definitions);for(var C=0;C<e.length;C++)A.push(e[C]);A.push(""),A.push(f.procedures);for(var C=0;C<h.length;C++)A.push(h[C]),C!==h.length-1&&A.push("");A.push(""),A.push(f.functions);for(var C=0;C<i.length;C++)A.push(i[C]),C!==i.length-1&&A.push("");if(A.push(""),A.push(f.picture),A.push(p),A.push(""),l.length>0){A.push(f.views);for(var C=0;C<l.length;C++)A.push(l[C]);A.push("")}if(A.push(f.autocalcOn),A.push(m),A.push(""),j.length>0||k.length>0){if(A.push(f.impliedByExecute),j.length>0){A.push("/*");for(var C=0;C<j.length;C++)A.push(j[C]);A.push("*/")}if(A.push(""),k.length>0){A.push(f.impliedOther),A.push("/*");for(var C=0;C<k.length;C++)A.push(k[C]);A.push("*/"),A.push("")}}return A.push(f.end),A},this.baseConstrualSymbols={},this.changeListener=function(a,b){var c=a.last_modified_by;if(!b&&"include"!=c){var e=a.name.slice(1);void 0!==a.eden_definition&&void 0!==a.definition?d.baseConstrualSymbols[e]={eden_definition:a.eden_definition,last_modified_by:c}:d.baseConstrualSymbols[e]={cached_value:a.cached_value,last_modified_by:c}}},a.eden.listenTo("executeError",EdenUI.plugins.ScriptGenerator,function(a,b){root.removeGlobal(d.changeListener)}),this.baseConstrualURL="",a.views.ScriptGenerator={dialog:this.createDialog,title:"Script Generator",category:a.viewCategories.history},b()},EdenUI.plugins.ScriptGenerator.title="Script Generator",EdenUI.plugins.ScriptGenerator.description="Generates a definitional script that can be used to recreate the current state of the environment at a later time.",EdenUI.plugins.ScriptGenerator.originalAuthor="Joe Butler",EdenUI.plugins.ScriptGenerator.loadBaseConstrual=function(a){"ScriptGenerator"in edenUI.plugins&&root.addGlobal(edenUI.plugins.ScriptGenerator.changeListener),eden.include(a,"",{name:Symbol.getInputAgentName()},function(){"ScriptGenerator"in edenUI.plugins&&(root.removeGlobal(edenUI.plugins.ScriptGenerator.changeListener),edenUI.plugins.ScriptGenerator.baseConstrualURL=a)})},function(){"use strict";var a,b=this;a="undefined"!=typeof exports?exports:b.Springy={};var c=a.Graph=function(){this.nodeSet={},this.nodes=[],this.edges=[],this.adjacency={},this.nextNodeId=0,this.nextEdgeId=0,this.eventListeners=[]},d=a.Node=function(a,b){this.id=a,this.data=void 0!==b?b:{}},e=a.Edge=function(a,b,c,d){this.id=a,this.source=b,this.target=c,this.data=void 0!==d?d:{}};c.prototype.addNode=function(a){return a.id in this.nodeSet||this.nodes.push(a),this.nodeSet[a.id]=a,this.notify(),a},c.prototype.addNodes=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a],c=new d(b,{label:b});this.addNode(c)}},c.prototype.addEdge=function(a){var b=!1;return this.edges.forEach(function(c){a.id===c.id&&(b=!0)}),b||this.edges.push(a),a.source.id in this.adjacency||(this.adjacency[a.source.id]={}),a.target.id in this.adjacency[a.source.id]||(this.adjacency[a.source.id][a.target.id]=[]),b=!1,this.adjacency[a.source.id][a.target.id].forEach(function(c){a.id===c.id&&(b=!0)}),b||this.adjacency[a.source.id][a.target.id].push(a),this.notify(),a},c.prototype.addEdges=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a],c=this.nodeSet[b[0]];if(void 0==c)throw new TypeError("invalid node name: "+b[0]);var d=this.nodeSet[b[1]];if(void 0==d)throw new TypeError("invalid node name: "+b[1]);var e=b[2];this.newEdge(c,d,e)}},c.prototype.newNode=function(a){var b=new d(this.nextNodeId++,a);return this.addNode(b),b},c.prototype.newEdge=function(a,b,c){var d=new e(this.nextEdgeId++,a,b,c);return this.addEdge(d),d},c.prototype.loadJSON=function(a){("string"==typeof a||a instanceof String)&&(a=JSON.parse(a)),("nodes"in a||"edges"in a)&&(this.addNodes.apply(this,a.nodes),this.addEdges.apply(this,a.edges))},c.prototype.getEdges=function(a,b){return a.id in this.adjacency&&b.id in this.adjacency[a.id]?this.adjacency[a.id][b.id]:[]},c.prototype.removeNode=function(a){a.id in this.nodeSet&&delete this.nodeSet[a.id];for(var b=this.nodes.length-1;b>=0;b--)this.nodes[b].id===a.id&&this.nodes.splice(b,1);this.detachNode(a)},c.prototype.detachNode=function(a){var b=this.edges.slice();b.forEach(function(b){try{(b.source.id===a.id||b.target.id===a.id)&&this.removeEdge(b)}catch(c){}},this),this.notify()},c.prototype.removeEdge=function(a){for(var b=this.edges.length-1;b>=0;b--)this.edges[b].id===a.id&&this.edges.splice(b,1);for(var c in this.adjacency){for(var d in this.adjacency[c]){for(var e=this.adjacency[c][d],f=e.length-1;f>=0;f--)this.adjacency[c][d][f].id===a.id&&this.adjacency[c][d].splice(f,1);0==this.adjacency[c][d].length&&delete this.adjacency[c][d]}j(this.adjacency[c])&&delete this.adjacency[c]}this.notify()},c.prototype.merge=function(a){var b=[];a.nodes.forEach(function(a){b.push(this.addNode(new d(a.id,a.data)))},this),a.edges.forEach(function(a){var c=b[a.from],d=b[a.to],f=a.directed?f=a.type+"-"+c.id+"-"+d.id:c.id<d.id?a.type+"-"+c.id+"-"+d.id:a.type+"-"+d.id+"-"+c.id,g=this.addEdge(new e(f,c,d,a.data));g.data.type=a.type},this)},c.prototype.filterNodes=function(a){var b=this.nodes.slice();b.forEach(function(b){a(b)||this.removeNode(b)},this)},c.prototype.filterEdges=function(a){var b=this.edges.slice();b.forEach(function(b){a(b)||this.removeEdge(b)},this)},c.prototype.addGraphListener=function(a){this.eventListeners.push(a)},c.prototype.notify=function(){this.eventListeners.forEach(function(a){a.graphChanged()})};var f=a.Layout={};f.ForceDirected=function(a,b,c,d){this.graph=a,this.stiffness=b,this.repulsion=c,this.damping=d,this.nodePoints={},this.edgeSprings={}},f.ForceDirected.prototype.point=function(a){if(!(a.id in this.nodePoints)){var b=void 0!==a.data.mass?a.data.mass:1;this.nodePoints[a.id]=new f.ForceDirected.Point(h.random(),b)}return this.nodePoints[a.id]},f.ForceDirected.prototype.spring=function(a){if(!(a.id in this.edgeSprings)){var b=void 0!==a.data.length?a.data.length:1,c=!1,d=this.graph.getEdges(a.source,a.target);if(d.forEach(function(a){c===!1&&a.id in this.edgeSprings&&(c=this.edgeSprings[a.id])},this),c!==!1)return new f.ForceDirected.Spring(c.point1,c.point2,0,0);this.graph.getEdges(a.target,a.source);if(d.forEach(function(a){c===!1&&a.id in this.edgeSprings&&(c=this.edgeSprings[a.id])},this),c!==!1)return new f.ForceDirected.Spring(c.point2,c.point1,0,0);this.edgeSprings[a.id]=new f.ForceDirected.Spring(this.point(a.source),this.point(a.target),b,this.stiffness)}return this.edgeSprings[a.id]},f.ForceDirected.prototype.eachNode=function(a){var b=this;this.graph.nodes.forEach(function(c){a.call(b,c,b.point(c))})},f.ForceDirected.prototype.eachEdge=function(a){var b=this;this.graph.edges.forEach(function(c){a.call(b,c,b.spring(c))})},f.ForceDirected.prototype.eachSpring=function(a){var b=this;this.graph.edges.forEach(function(c){a.call(b,b.spring(c))})},f.ForceDirected.prototype.applyCoulombsLaw=function(){this.eachNode(function(a,b){this.eachNode(function(a,c){if(b!==c){var d=b.p.subtract(c.p),e=d.magnitude()+.1,f=d.normalise();b.applyForce(f.multiply(this.repulsion).divide(e*e*.5)),c.applyForce(f.multiply(this.repulsion).divide(e*e*-.5))}})})},f.ForceDirected.prototype.applyHookesLaw=function(){this.eachSpring(function(a){var b=a.point2.p.subtract(a.point1.p),c=a.length-b.magnitude(),d=b.normalise();a.point1.applyForce(d.multiply(a.k*c*-.5)),a.point2.applyForce(d.multiply(a.k*c*.5))})},f.ForceDirected.prototype.attractToCentre=function(){this.eachNode(function(a,b){var c=b.p.multiply(-1);b.applyForce(c.multiply(this.repulsion/50))})},f.ForceDirected.prototype.updateVelocity=function(a){this.eachNode(function(b,c){c.v=c.v.add(c.a.multiply(a)).multiply(this.damping),c.a=new h(0,0)})},f.ForceDirected.prototype.updatePosition=function(a){this.eachNode(function(b,c){c.p=c.p.add(c.v.multiply(a))})},f.ForceDirected.prototype.totalEnergy=function(a){var b=0;return this.eachNode(function(a,c){var d=c.v.magnitude();b+=.5*c.m*d*d}),b};var g=function(a,b){return function(){return a.apply(b,arguments)}};a.requestAnimationFrame=g(b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.oRequestAnimationFrame||b.msRequestAnimationFrame||function(a,c){b.setTimeout(a,10)},b),f.ForceDirected.prototype.start=function(b,c){var d=this;this._started||(this._started=!0,this._stop=!1,a.requestAnimationFrame(function e(){d.applyCoulombsLaw(),d.applyHookesLaw(),d.attractToCentre(),d.updateVelocity(.03),d.updatePosition(.03),void 0!==b&&b(),d._stop||d.totalEnergy()<.01?(d._started=!1,void 0!==c&&c()):a.requestAnimationFrame(e)}))},f.ForceDirected.prototype.stop=function(){this._stop=!0},f.ForceDirected.prototype.nearest=function(a){var b={node:null,point:null,distance:null},c=this;return this.graph.nodes.forEach(function(d){var e=c.point(d),f=e.p.subtract(a).magnitude();(null===b.distance||f<b.distance)&&(b={node:d,point:e,distance:f})}),b},f.ForceDirected.prototype.getBoundingBox=function(){var a=new h(-2,-2),b=new h(2,2);this.eachNode(function(c,d){d.p.x<a.x&&(a.x=d.p.x),d.p.y<a.y&&(a.y=d.p.y),d.p.x>b.x&&(b.x=d.p.x),d.p.y>b.y&&(b.y=d.p.y)});var c=b.subtract(a).multiply(.07);return{bottomleft:a.subtract(c),topright:b.add(c)}};var h=a.Vector=function(a,b){this.x=a,this.y=b};h.random=function(){return new h(10*(Math.random()-.5),10*(Math.random()-.5))},h.prototype.add=function(a){return new h(this.x+a.x,this.y+a.y)},h.prototype.subtract=function(a){return new h(this.x-a.x,this.y-a.y)},h.prototype.multiply=function(a){return new h(this.x*a,this.y*a)},h.prototype.divide=function(a){return new h(this.x/a||0,this.y/a||0)},h.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},h.prototype.normal=function(){return new h(-this.y,this.x)},h.prototype.normalise=function(){return this.divide(this.magnitude())},f.ForceDirected.Point=function(a,b){this.p=a,this.m=b,this.v=new h(0,0),this.a=new h(0,0)},f.ForceDirected.Point.prototype.applyForce=function(a){this.a=this.a.add(a.divide(this.m))},f.ForceDirected.Spring=function(a,b,c,d){this.point1=a,this.point2=b,this.length=c,this.k=d};var i=a.Renderer=function(a,b,c,d){this.layout=a,this.clear=b,this.drawEdge=c,this.drawNode=d,this.layout.graph.addGraphListener(this)};i.prototype.graphChanged=function(a){
this.start()},i.prototype.start=function(){var a=this;this.layout.start(function(){a.clear(),a.layout.eachEdge(function(b,c){a.drawEdge(b,c.point1.p,c.point2.p)}),a.layout.eachNode(function(b,c){a.drawNode(b,c.p)})})},i.prototype.stop=function(){this.layout.stop()},Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(null==this)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if("[object Function]"!={}.toString.call(a))throw new TypeError(a+" is not a function");for(b&&(c=b),d=0;f>d;){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}});var j=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}}.call(this),function(){jQuery.fn.springy=function(a){function b(a,b,c,d){var e=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0===e)return!1;var f=((d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x))/e,g=((b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x))/e;return 0>f||f>1||0>g||g>1?!1:new Springy.Vector(a.x+f*(b.x-a.x),a.y+f*(b.y-a.y))}function c(a,c,d,e,f){var g,h={x:d.x,y:d.y},i={x:d.x+e,y:d.y},j={x:d.x,y:d.y+f},k={x:d.x+e,y:d.y+f};return(g=b(a,c,h,i))?g:(g=b(a,c,i,k))?g:(g=b(a,c,k,j))?g:(g=b(a,c,j,h))?g:!1}var d=this.graph=a.graph||new Springy.Graph,e=a.stiffness||100,f=a.repulsion||5e3,g=a.damping||.5,h=a.nodeSelected||null,i=this[0],j=i.getContext("2d"),k=this.layout=new Springy.Layout.ForceDirected(d,e,f,g),l=k.getBoundingBox(),m={bottomleft:new Springy.Vector(-2,-2),topright:new Springy.Vector(2,2)};Springy.requestAnimationFrame(function t(){m=k.getBoundingBox(),l={bottomleft:l.bottomleft.add(m.bottomleft.subtract(l.bottomleft).divide(10)),topright:l.topright.add(m.topright.subtract(l.topright).divide(10))},Springy.requestAnimationFrame(t)});var n=function(a){var b=l.topright.subtract(l.bottomleft),c=a.subtract(l.bottomleft).divide(b.x).x*i.width,d=a.subtract(l.bottomleft).divide(b.y).y*i.height;return new Springy.Vector(c,d)},o=function(a){var b=l.topright.subtract(l.bottomleft),c=a.x/i.width*b.x+l.bottomleft.x,d=a.y/i.height*b.y+l.bottomleft.y;return new Springy.Vector(c,d)},p=null,q=null,r=null;jQuery(i).mousedown(function(a){var b=jQuery(this).offset(),c=o({x:a.pageX-b.left,y:a.pageY-b.top});p=q=r=k.nearest(c),null!==p.node&&(r.point.m=1e4,h&&h(p.node)),s.start()}),jQuery(i).dblclick(function(a){var b=jQuery(this).offset(),c=o({x:a.pageX-b.left,y:a.pageY-b.top});p=k.nearest(c),node=p.node,node&&node.data&&node.data.ondoubleclick&&node.data.ondoubleclick()}),jQuery(i).mousemove(function(a){var b=jQuery(this).offset(),c=o({x:a.pageX-b.left,y:a.pageY-b.top});q=k.nearest(c),null!==r&&null!==r.node&&(r.point.p.x=c.x,r.point.p.y=c.y),s.start()}),jQuery(window).bind("mouseup",function(a){r=null}),Springy.Node.prototype.getWidth=function(){var a=void 0!==this.data.label?this.data.label:this.id;if(this._width&&this._width[a])return this._width[a];j.save(),j.font="16px Verdana, sans-serif";var b=j.measureText(a).width+10;return j.restore(),this._width||(this._width={}),this._width[a]=b,b},Springy.Node.prototype.getHeight=function(){return 20};var s=this.renderer=new Springy.Renderer(k,function(){var a=i.parentNode;i.height=a.clientHeight,i.width=a.clientWidth,j.clearRect(0,0,i.width,i.height)},function(a,b,e){for(var f=n(b).x,g=n(b).y,h=n(e).x,i=n(e).y,k=new Springy.Vector(h-f,i-g),l=k.normal().normalise(),m=d.getEdges(a.source,a.target),o=d.getEdges(a.target,a.source),p=m.length+o.length,q=0,r=0;r<m.length;r++)m[r].id===a.id&&(q=r);var s=0,t=l.multiply(-((p-1)*s)/2+q*s),u=n(b).add(t),v=n(e).add(t),w=a.target.getWidth(),x=a.target.getHeight(),y=c(u,v,{x:h-w/2,y:i-x/2},w,x);y||(y=v);var z,A=void 0!==a.data.color?a.data.color:"#C0C0C0";z="dashes"in a.data?a.data.dashes:[];var B,C,D=void 0!==a.data.weight?a.data.weight:1;j.lineWidth=Math.max(3*D,.1),B=1+j.lineWidth,C=8;var E,F=void 0!==a.data.directional?a.data.directional:!0;E=F?y.subtract(k.normalise().multiply(.5*C)):v,j.strokeStyle=A,j.setLineDash(z),j.beginPath(),j.moveTo(u.x,u.y),j.lineTo(E.x,E.y),j.stroke(),F&&(j.save(),j.fillStyle=A,j.translate(y.x,y.y),j.rotate(Math.atan2(i-g,h-f)),j.beginPath(),j.moveTo(-C,B),j.lineTo(0,0),j.lineTo(-C,-B),j.lineTo(.8*-C,-0),j.closePath(),j.fill(),j.restore()),void 0!==a.data.label&&(text=a.data.label,j.save(),j.textAlign="center",j.textBaseline="top",j.font="10px Helvetica, sans-serif",j.fillStyle="#5BA6EC",j.fillText(text,(f+h)/2,(g+i)/2),j.restore())},function(a,b){var c=n(b);j.save();var e=a.getWidth();a.getHeight();j.fillStyle="#FFFFFF",j.fillRect(c.x-e/2,c.y-10,e,20),j.setLineDash([]),j.textAlign="left",j.textBaseline="top",j.font="16px Verdana, sans-serif";var f=void 0!==a.data.label?a.data.label:a.id,g=root.lookup(f).eden_definition;void 0==g?j.fillStyle="#0000FF":0==g.toString().indexOf("proc")?j.fillStyle="#FF0000":0==g.toString().indexOf("func")?j.fillStyle="#336600":j.fillStyle="#0000FF",d.re.test(f)&&(j.lineWidth=1,j.strokeStyle="#000000",j.strokeRect(c.x-e/2,c.y-10,e,20)),j.fillText(f,c.x-e/2+5,c.y-8),j.restore()});return s.start(),this}}(),EdenUI.plugins.DependencyMap=function(a,b){var c=this;this.createDialog=function(a,b){var d=void 0;d=new Springy.Graph,d.previousNodes=[],d.previousEdges=[],d.newNodes=[],d.newEdges=[],code_entry=$('<div id="'+a+'-content" class="dependency-map-content"></div>').append($('<canvas id="'+a+'-content-canvas" />').width("100%").height("100%").attr("height",500).attr("width",500)).append($('<input style="position:absolute; width:400px; z-index:10; right:30px; top:5px;" id="'+a+'-content-regex"/>').on("input",function(){c.updateGraph(this.value,d)})).on("mouseover",function(){c.updateGraph(this.children[1].value,d)}),$dialog=$('<div id="'+a+'"></div>').html(code_entry).dialog({title:b,width:600,height:450,minHeight:120,minWidth:230}),jQuery(function(){ab=jQuery("#"+a+"-content-canvas").springy({graph:d,nodeSelected:function(a){c.nodeClicked(a)}})})},this.nodeClicked=function(a){},this.updateGraph=function(a,b){try{var c=b.re=new RegExp("^("+a+")$")}catch(d){return}b.newNodes=[],b.newEdges=[];for(var e in root.symbols){var f=root.symbols[e],g=f.name.slice(1);if(c.test(g)){-1==b.newNodes.indexOf(g)&&b.newNodes.push(g);var h=f.dependencies;for(var i in h){var j=h[i].name.slice(1);-1==b.newNodes.indexOf(j)&&b.newNodes.push(j),b.newEdges.push([j,g,!1])}h=f.dynamicDependencies;for(var i in h){var j=h[i].name.slice(1);-1==b.newNodes.indexOf(j)&&b.newNodes.push(j),b.newEdges.push([j,g,!0])}h=f.observees;for(var i in h){var j=h[i].name.slice(1);-1==b.newNodes.indexOf(j)&&b.newNodes.push(j),b.newEdges.push([j,g,!1])}var k=f.subscribers;for(var i in k){var l=k[i],j=l.name.slice(1);-1==b.newNodes.indexOf(j)&&b.newNodes.push(j);var m=f.name in l.dynamicDependencies;b.newEdges.push([g,j,m])}k=f.observers;for(var i in k){var j=k[i].name.slice(1);-1==b.newNodes.indexOf(j)&&b.newNodes.push(j),b.newEdges.push([g,j,!1])}}}if(!arrayCompare(b.previousNodes,b.newNodes)||!arrayCompare(b.previousEdges,b.newEdges)){b.previousNodes=b.newNodes,b.previousEdges=b.newEdges,b.filterEdges(function(a){return!1}),b.filterNodes(function(a){return!1}),b.nodeObjectsStore={};for(var e in b.previousNodes){var n=b.previousNodes[e];b.nodeObjectsStore[n]=b.newNode({label:n},{color:"#6A4A3C"})}for(var i in b.previousEdges){var o=b.previousEdges[i][0],p=b.previousEdges[i][1],q={};b.previousEdges[i][2]&&(q.dashes=[10,10]),b.newEdge(b.nodeObjectsStore[o],b.nodeObjectsStore[p],q)}}},a.views.DependencyMap={dialog:this.createDialog,title:"Dependency Map",category:a.viewCategories.comprehension,menuPriority:2},b()},EdenUI.plugins.DependencyMap.title="Dependency Map",EdenUI.plugins.DependencyMap.description="Displays a diagram showing the relationships between observables.",EdenUI.plugins.DependencyMap.author="Joe Butler",EdenUI.plugins.StateTimeLine=function(a,b){var c=this,d="";this.html=function(b,c){"DEFAULT"==b?(""==d&&a.createView(b,"StateTimeLine"),$("#"+d+"-content").html(c).onclick):$("#"+b+"-dialog-content").html(c).onclick},this.createDialog=function(b,f){""==d&&(d=b),c.ignoreRE=new RegExp("((_view.*)|(_View.*)|(_status)|(mouse.*)|(picture))"),code_entry=$('<div id="'+b+'-content" class="st-content"></div>').append($('<input id="'+b+'-regex"></input>')).append($('<button style="margin-bottom:20px;">Generate State</button>').click(function(){c.ST.states.push(e("partial"));var d=document.getElementById(b+"-regex").value;""==d&&(d="State "+c.ST.nextBlankState),$("#"+b+"-content-states").append("<div id='stdiv"+a.plugins.StateTimeLine.ST.nextBlankState+"' class='stdiv'>"+d+": <a class='stlinkrestore' href='javascript:edenUI.plugins.StateTimeLine.changeState("+a.plugins.StateTimeLine.ST.nextBlankState+")'>Restore</a> "+(new Date).toLocaleTimeString()+" <a class='stlinkdelete' href='javascript:edenUI.plugins.StateTimeLine.deleteState("+a.plugins.StateTimeLine.ST.nextBlankState+")'> Delete</a></div>"),document.getElementById(b+"-regex").value="",a.plugins.StateTimeLine.ST.nextBlankState++})).append($('<div id="'+b+'-content-states"></div>')),$dialog=$('<div id="'+b+'"></div>').html(code_entry).dialog({title:f,width:300,height:450,minHeight:120,minWidth:230})},c.ST={},c.ST.states=[],c.ST.nextBlankState=0,this.deleteState=function(a){$(document.getElementById("stdiv"+a)).remove()},this.changeState=function(b){for(var c in root.symbols)Eden.isitSystemSymbol(root.symbols[c].name.substring(1,root.symbols[c].name.length))||a.plugins.StateTimeLine.ignoreRE.test(root.symbols[c].name.substring(1,root.symbols[c].name.length))||delete root.symbols[c];a.plugins.ScriptInput.submitEdenCode(a.plugins.StateTimeLine.ST.states[b])};var e=function(b){var c=[],d=[],e=[],f=[],g="autocalc = 1;",h="autocalc = 0;",i=root.lookup("picture").eden_definition;void 0==i?i="picture is [];":i+=";";for(var j in root.symbols){var k="@",l="",m=5,n=root.symbols[j],o=n.eden_definition;if(void 0==o&&(o=k),0==o.indexOf("proc")){if(l="(Action)",m=2,"partial"==b&&Eden.isitSystemAgent(j))continue}else if(0==o.indexOf("func")){if(l="(Function)",m=1,"partial"==b&&Eden.isitSystemFunction(j))continue}else if(l="(Observable)",m=0,"partial"==b&&Eden.isitSystemObservable(j))continue;var p=Eden.edenCodeForValue(n.cached_value);if(!a.plugins.StateTimeLine.ignoreRE.test(j))if(1==m)f.push(o);else if(0==m){if(p==k&&o==k)continue;o==k?d.push(j+" = "+p+";"):c.push(o+";")}else 2==m?e.push(o):console.log("oh dear error")}var q=[];q.push(h);for(var r=0;r<d.length;r++)q.push(d[r]);for(var r=0;r<c.length;r++)q.push(c[r]);for(var r=0;r<e.length;r++)q.push(e[r]),q.push("");for(var r=0;r<f.length;r++)q.push(f[r]),q.push("");return q.push(i),q.push(g),q.join("\n")};a.views.StateTimeLine={dialog:this.createDialog,title:"State Time Line",category:a.viewCategories.history},b()},EdenUI.plugins.StateTimeLine.title="State Time Line",EdenUI.plugins.StateTimeLine.description="Provides the ability to save the current state, keep a history of saved states and go back to a saved state later.",EdenUI.plugins.StateTimeLine.author="Joe Butler",EdenUI.plugins.StateListener=function(a,b){var c="";this.html=function(b,d){"DEFAULT"==b?(""==c&&a.createView(b,"StateListener"),$("#"+c+"-content").html(d).onclick):$("#"+b+"-dialog-content").html(d).onclick},this.createDialog=function(b,d){""==c&&(c=b);var e={confirmClose:!1},f='<div class="sldiv"><div><label for="sl-ipaddr">IP Address:</label><input type="text" id="sl-ipaddr" value="127.0.0.1"></input></div><div><label for="sl-port">Port:</label><input type="text" id="sl-port" value="8001"></input></div><div><input type="button" value="Connect" id="connectBtn"></input></div><p id="sl-status"></p>';return $dialog=$('<div id="'+b+'"></div>').html(f).dialog({title:d,width:300,height:450,minHeight:120,minWidth:230}),$("#connectBtn").click(function(){function b(b){var c=a.eden.root,e=c.lookup("definitionOf").definition(c)(b);d.send(e)}if(window.WebSocket=window.WebSocket||window.MozWebSocket,!window.WebSocket)return void console.log("WebSockets not supported");var c="ws://"+$("#sl-ipaddr").val()+":"+$("#sl-port").val()+"/",d=new WebSocket(c);eden.listenTo("executeBegin",this,function(a,b){"net"!=a&&d.send(b)}),eden.listenTo("beforeAssign",this,function(a,b,c){"net"!=c&&d.send(a.name.slice(1)+"="+Eden.edenCodeForValue(b)+";")}),$("#sl-status").html("<p>Connected to: "+c+"</p>"),d.onerror=function(a){$("#sl-status").html("<p>Error connecting to server - please verify server is running at "+c+". For usage instructions please read the comments in the <a href='plugins/state-listener/state-listener-server.js'>state-listener-server.js</a> file.</p>"),e.confirmClose=!1},d.onmessage=function(a){$("#sl-status").html("<p>Received: "+Eden.htmlEscape(a.data)+"</p>"),eden.execute(a.data,"net","",{name:"/execute"},noop)},d.onopen=function(){e.confirmClose=!0,randomSeedSym=a.eden.root.lookup("randomSeed"),randomSeed=randomSeedSym.value(),void 0===randomSeed?randomSeedSym.assign((new Date).getTime(),void 0,!0):b("randomSeed"),b("randomGenerator")}}),e},a.views.StateListener={dialog:this.createDialog,title:"State Listener",category:a.viewCategories.extension},a.eden.include("plugins/state-listener/state-listener.js-e",b)},EdenUI.plugins.StateListener.title="State Listener",EdenUI.plugins.StateListener.description="Provides the ability to synchronize observables over the internet.",EdenUI.plugins.StateListener.author="Jonny Foss",EdenUI.plugins.NetworkRemote=function(a,b){var c,d=this,e="",f=!1,g=!1;this.html=function(b,c){"DEFAULT"==b?(""==e&&a.createView(b,"NetworkRemote"),$("#"+e+"-content").html(c).onclick):$("#"+b+"-dialog-content").html(c).onclick},this.createDialog=function(b,d){function f(){g=!1,$("#connectBtn").attr("value","Connect"),$("#nr-ipaddr").removeAttr("disabled"),$("#nr-port").removeAttr("disabled"),$("#nr-key").removeAttr("disabled")}function h(){function b(b){var c=a.eden.root,d=c.lookup("definitionOf").definition(c)(b);e.send(d)}if(window.WebSocket=window.WebSocket||window.MozWebSocket,!window.WebSocket)return void console.log("WebSockets not supported");var d="ws://"+$("#nr-ipaddr").val()+":"+$("#nr-port").val()+"/",e=new WebSocket(d);eden.listenTo("executeBegin",this,function(a,b){"net"!=a&&e.send(b)}),eden.listenTo("beforeAssign",this,function(a,b,c){"net"!=c&&e.send(a.name.slice(1)+"="+Eden.edenCodeForValue(b)+";")}),$("#nr-status").html("<p>Connected to: "+d+"</p>"),e.onopen=function(c){e.send($("#nr-key").val()),i.confirmClose=!0,randomSeedSym=a.eden.root.lookup("randomSeed"),randomSeed=randomSeedSym.value(),void 0===randomSeed?randomSeedSym.assign((new Date).getTime(),void 0,!0):b("randomSeed"),b("randomGenerator"),g=!0,$("#connectBtn").attr("value","Disconnect"),$("#nr-ipaddr").attr("disabled","disabled"),$("#nr-port").attr("disabled","disabled"),$("#nr-key").attr("disabled","disabled")},e.onerror=function(a){g=!1,$("#nr-ipaddr").removeAttr("disabled"),$("#nr-port").removeAttr("disabled"),$("#nr-key").removeAttr("disabled"),$("#connectBtn").attr("value","Connect"),$("#nr-status").html("<p>Error connecting to server - please verify server is running at "+d+". For usage instructions please read the comments in the <a href='plugins/network-remote/network-remote-server.js'>network-remote-server.js</a> file.</p>")},e.onmessage=function(a){c=JSON.parse(a.data);for(var b=0;b<c.length;b++)line=c[b].code,$("#nr-status").html("<p>Received: "+line+"</p>"),eden.execute(line,"net","",{name:"/execute"},noop)}}""==e&&(e=b);var i={confirmClose:!1},j='<div class="nrdiv"><div><label for="nr-ipaddr">IP Address:</label><input type="text" name="nr-ipaddr" id="nr-ipaddr" value="127.0.0.1"></input></div><div><label for="nr-port">Port:</label><input type="text" name="nr-port" id="nr-port" value="8001"></input></div><div><label for="nr-key">Session Key:</label><input type="text" name="nr-key" id="nr-key" value="abcde"></input></div><div><input type="button" value="Connect" name="connectBtn" id="connectBtn"></input></div><div><label for="speedrange">Speed:</label><input type="range" name="speedrange" id="nr-speedrange" step="0.5" min="0.1" max="8" value="1"/></div><p id="nr-status"></p>';return $dialog=$('<div id="'+b+'"></div>').html(j).dialog({title:d,width:300,height:450,minHeight:120,minWidth:230}),$("#connectBtn").click(function(){g?f():h()}),i},this.playCode=function(a){if(void 0===c[a])return void $("#nr-status").html("<p>Replay finished</p>");var b=c[a].time/$("#nr-speedrange").val();b>1e3?($("#nr-status").html("<p>Next line in "+b+" milliseconds</p>"),f=!0):f&&$("#nr-status").html("<p>Replaying...</p>"),setTimeout(function(){eden.execute(c[a].code,"net","",{name:"/execute"},noop),d.playCode(a+1)},b)},a.views.NetworkRemote={dialog:this.createDialog,title:"Network Remote",category:a.viewCategories.extension},a.eden.include("plugins/network-remote/network-remote.js-e",b)},EdenUI.plugins.NetworkRemote.title="Network Remote",EdenUI.plugins.NetworkRemote.description="Method of syncronizing observables via TCP, and playing back scripts",EdenUI.plugins.NetworkRemote.author="Jonny Foss",EdenUI.plugins.WindowLayoutTool=function(a,b){var c="";$.getScript("plugins/view-layout/gridster/jquery.gridster.min.js");var d=$("<link rel='stylesheet' type='text/css' href='plugins/view-layout/gridster/jquery.gridster.min.css'>");$("head").append(d);var d=$("<link rel='stylesheet' type='text/css' href='plugins/view-layout/view-layout.css'>");$("head").append(d),this.name="window_name",this.createDialog=function(b,d){""==c&&(c=b);var e=[];viewlayoutstr="View Layout";var f=5*a.gridSizeY,g=3*a.gridSizeX,h=[],i=root.lookup("_views_list").value(),j=this.name;i.forEach(function(b){if(b!=j){var c=root.lookup("_view_"+b+"_x").value(),d=root.lookup("_view_"+b+"_y").value();c="undefined"!=typeof c?c:0,d="undefined"!=typeof d?d:0,h=[b,c,d,root.lookup("_view_"+b+"_width").value()+a.scrollBarSize,root.lookup("_view_"+b+"_height").value()+a.titleBarHeight,root.lookup("_view_"+b+"_title").value()],console.log(h),e.push(h)}});var k="";e.forEach(function(a,b){k+='<li data-row="'+Math.round(a[2]/f)+'" data-col="'+Math.round(a[1]/g)+'" data-sizex="'+Math.round(a[3]/(1*g))+'" data-sizey="'+Math.round(a[4]/(1*f))+'" data-name="'+a[0]+'" data-num="'+b+'">'+a[5]+" ["+a[0]+"]</li>"});var l='<a class="vl-update">Update</a><div class="gridster"><ul>'+k+"</ul></div>";$dialog=$('<div id="'+b+'"></div>').html(l).dialog({title:d,width:$(window).width()/2,height:$(window).height()/2,minHeight:120,minWidth:230}),gridster=$(".gridster ul").gridster({widget_base_dimensions:[g,f],widget_margins:[0,0],min_cols:Math.round($(window).width()/g),max_cols:Math.round($(window).width()/g),helper:"clone",resize:{enabled:!0},serialize_params:function(a,b){return{col:b.col,row:b.row,size_x:b.size_x,size_y:b.size_y,name:b.name,name:$(b.el.context).attr("data-name")}}}).data("gridster"),$(".vl-update").click(function(){var b=gridster.serialize(),c=1,d=1;b.forEach(function(a,b){a.col<c&&(c=a.col),a.row<d&&(d=a.row)}),b.forEach(function(b,e){var h="_view_"+b.name+"_y = "+(b.row-d)*f+";_view_"+b.name+"_x = "+(b.col-c)*g+";_view_"+b.name+"_width = "+(b.size_x*g-a.dialogFrameWidth)+";_view_"+b.name+"_height = "+(b.size_y*f-a.dialogFrameHeight)+";";console.log(h),eden.execute(h)})})},a.views.WindowLayoutTool={dialog:this.createDialog,title:"Window Layout",category:a.viewCategories.environment},b()},EdenUI.plugins.WindowLayoutTool.title="Window Layout Tool",EdenUI.plugins.WindowLayoutTool.description="Provides assistance with rearranging windows.",EdenUI.plugins.WindowLayoutTool.author="Jonny Foss",EdenUI.plugins.ADM=function(a,b){function c(a,b,c){this.edenVar=a,this.guard=b,this.actions=c}function d(a,b,c,d){this.name=a,this.parameters=b,this.definitions=c,this.actionsArr=d}function e(a,b,c){this.name=a,this.definitions=b,this.actionsArr=c,this.queuedActions=new Array}var f=this;this.selectedActions=new Array,this.selectedEntities=new Array,this.templates=new Array,this.entities=new Array,this.definitions=new Array,this.currIndex=-1,this.actionLists,this.templateList,this.entityList,eden.polyglot.register("adm",{execute:function(a,b,c,d,e){G(a)}}),c.prototype.toString=function(){return this.guard+" --> "+this.actions},d.prototype.toString=function(){return this.name+"("+this.parameters.join(",")+")\nDefinitions:\n"+this.definitions+"\nActions:\n"+this.actionsArr};var g=function(a,b){for(var d=new Array,e=0;e<b.length;e++){var f=new String(b[e]),g=f.split("-->");if(2==g.length){var h="this_g"+d.length;d.push(new c(h,g[0],g[1]))}}return d},h=function(a){var b,c=new Array;a.split("(").length<2?b=a:(c=a.split("(")[1].split(")")[0].split(","),b=a.split("(")[0]);var d=document.getElementById("adm-definitions"),e=[];d.value.length>0&&(e=d.value.split("\n"));var d=document.getElementById("adm-actions"),f=d.value.split("\n"),h=g(b,f);return F(b,c,e,h),0},i=function(){for(var a=document.getElementById("adm-name"),b=a.value.split("(")[0],c=!0,d=0;d<f.templates.length;d++){var e=f.templates[d];e.name==b&&(c=!1)}if(b&&c){var g=h(a.value);-1!=g&&(alert("Template was successfully added!"),document.getElementById("adm-name").value="",document.getElementById("adm-definitions").value="",document.getElementById("adm-actions").value="",f.currIndex=-1)}else alert("Please enter a unique name for this template."),a.focus()},j=function(a){if(-1>a?a=f.templates.length-1:a>=f.templates.length&&(a=-1),-1==a)document.getElementById("adm-name").value="",document.getElementById("adm-definitions").value="",document.getElementById("adm-actions").value="";else{var b=f.templates[a];document.getElementById("adm-name").value=b.name,document.getElementById("adm-definitions").value=b.definitions.join("\n"),document.getElementById("adm-actions").value=b.actionsArr.join("\n")}f.currIndex=a},k=function(a){a>-1&&(alert("Deleting template "+f.templates[a].name),f.templates.splice(a),f.currIndex=a-1,j(f.currIndex))},l=function(a){return'<div id="'+a+'-input" class="adm-input-code">			<div>Name:</div>			<div><textarea id="adm-name" type="text" class="adm-name"></textarea></div>			<div>Definitions:</div>			<div><textarea id="adm-definitions" class="adm-definitions"></textarea></div>			<div>Actions:</div>			<div><textarea id="adm-actions" class="adm-actions"></textarea></div>		</div>		<div id="adm-results" class="entitylist-results">			<ul id="results"> </ul>		</div>'};this.createTemplateCreator=function(a,b){var c=$("<div></div>");c.html(l(a)),$dialog=$('<div id="'+a+'"></div>').html(c).dialog({title:b,width:360,height:400,minHeight:200,minWidth:360,buttons:[{id:"btn-add",text:"Add Template",click:function(){i()}},{id:"btn-delete",text:"Delete Template",click:function(){k(f.currIndex)}},{text:"Previous",click:function(){j(f.currIndex-1)}},{text:"Next",click:function(){j(f.currIndex+1)}}]}),input_dialog=$dialog,$("#btn-submit").css("margin-right","30px")};var m=function(a,b){var c=new Array;for(x in b){var d=b[x];c.push(d.replace(/this/g,a))}return c},n=function(a,b){var d=new Array;for(x in b){var e=b[x],f=e.guard.replace(/this/g,a),g=e.actions.replace(/this/g,a),h=e.edenVar.replace(/this/g,a);d.push(new c(h,f,g))}return d},o=function(a,b){a.value="";for(x in b)b[x].value=""},p=function(a){var b;for(x in f.templates)if(f.templates[x].name==a){b=f.templates[x];break}return b},q=function(){for(var a=document.getElementById("template-menu"),b=a.options[a.selectedIndex].value,c=p(b),d=document.getElementById("entity-name"),e=d.value,g=!0,h=0;h<f.entities.length;h++){var i=f.entities[h];i.name==e&&(g=!1)}if(0==g)return void alert("please enter a unique name for this instantiation");var j=$("#instantiate-params"),k=j.find("input"),l=0,n=new Array;for(x in k){var q=k[x];if("text"==q.type){var s=D(c.parameters[l]),t=D(q.value);n.push(q),eden.executeEden(e+"_"+s+" is "+t+";"),l++}}var v=m(e,c.definitions),w=r(e,v);-1!=w&&(u(e,v,c.actionsArr),alert("Successfully added instantiation of "+b+" as "+e),o(d,n))},r=function(a,b){a=D(a);for(var c=0;c<b.length;c++){var d=D(b[c]);eden.executeEden(a+"_"+d),f.definitions.push(a+"_"+d)}};this.createInstantiator=function(a,b){var c=$("<div></div>");c=$('<div id="template-instantiator">					<div>Templates:</div>					<div>						<select id="template-menu">						</select>					</div>					<div>Entity name:</div>					<div>						<textarea id="entity-name"></textarea>					</div>					<div>Parameters:</div>					<div id="instantiate-params"></div>				</div>'),$dialog=$('<div id="'+a+'"></div>').html(c).dialog({title:b,width:360,height:400,minHeight:200,minWidth:360,buttons:[{id:"btn-instantiate",text:"Instantiate",click:function(){q()}}]}),f.templateList=new EdenUI.plugins.ADM.TemplateList;for(x in f.templates){var d=f.templates[x];f.templateList.addTemplate(d.name,d.parameters)}};var s=function(a){var b,c;for(x in f.entities)if(f.entities[x].name==a){b=f.entities[x],c=x;break}if(null==b)return void alert(a+" doesn't exist to delete.");f.entities.splice(c,1);for(x in f.actionLists)if(f.actionLists[x].entityName==a){c=x,f.actionLists[x].remove();break}null!=f.actionLists&&f.actionLists.splice(c,1),null!=f.entityList&&f.entityList.removeEntity(a)},t=function(a,b,c){var d=p(a);if(null==d)return alert("no template with name "+a),-1;for(x in f.entities)if(f.entities[x].name==c)return alert("Please enter a unique entity name"),-1;if(""==b)var e=[];else if(-1==b.indexOf(","))var e=[b];else var e=b.split(",");if(e.length!=d.parameters.length)return alert("not enough parameters to instantiate "+d),-1;for(x in e){var g=D(d.parameters[x]),h=D(e[x]);eden.executeEden(c+"_"+g+" is "+h+";")}var i=m(c,d.definitions),j=r(c,i);return-1!=j&&u(c,i,d.actionsArr),j},u=function(a,b,c){var d=n(a,c),g=new e(a,b,d);f.entities.push(g);for(x in d){var h=d[x],i=h.edenVar+" is "+h.guard+";";eden.executeEden(i)}if(null!=f.actionLists){var j=new EdenUI.plugins.ADM.ActionsList(a);f.actionLists.push(j),w(g,j)}null!=f.entityList&&f.entityList.addEntity(a,b,d)},v=function(){for(x in f.selectedActions){var b=f.selectedActions[x];if(b=D(b),945==b.charCodeAt(0))if("r"==b[2]){var c=b.split("(")[1];c=c.substring(0,c.length-1),s(c)}else if("i"==b[2]){var d=b.split("(")[1],e=b.split("(")[2].split(")")[0],c=b.split("as")[1],g=t(d,e,c);if(-1==g)break}else alert("Action on another entity must one of _remove(entity_name), _r, _instantiate(template(param_value) as entity_name) or _i");else eden.executeEden(b+";")}f.selectedActions=new Array,a.plugins.ADM.refreshHumanPerspective()};this.actionPush=function(a){f.selectedActions.push(a)},this.actionRemove=function(a){var b=new Array;for(x in f.selectedActions){var c=f.selectedActions[x];c!=a&&b.push(c)}f.selectedActions=b},this.refreshHumanPerspective=function(){for(x in f.entities){var a,b=f.entities[x];for(y in f.actionLists){var c=f.actionLists[y];if(c.entityName==b.name){a=c;break}}a.clear();var d=[];for(x in b.queuedActions){var e=b.queuedActions[x].split(";"),g=e[0];if(g.length>0){e.splice(0,1);var h=!0;e[0].length>0&&(d.push(e.join(";")),h=!1),a.addAction(g,h)}}b.queuedActions=d,w(b,a)}};var w=function(a,b){for(var c=0;c<a.actionsArr.length;c++){var d=a.actionsArr[c],e=eden.root.lookup(d.edenVar).value();if(e===!0){var f=d.actions.split(";"),g=f[0],h=!0;f.splice(0,1),f[0].length>0&&(a.queuedActions.push(f.join(";")),h=!1),b.addAction(g,h)}}};this.createHumanPerspective=function(b,c){var d=$("<div></div>");d=$('<div id="human-perspective" class="actionlist"></div>'),$dialog=$('<div id="'+b+'"></div>').html(d).dialog({title:c,width:360,height:400,minHeight:200,minWidth:360,buttons:[{id:"btn-refresh",text:"Refresh actions",click:function(){a.plugins.ADM.refreshHumanPerspective()}},{id:"btn-step",text:"Step",click:function(){v()}}]}),f.actionLists=new Array;for(x in f.entities){var b=f.entities[x].name;f.actionLists.push(new EdenUI.plugins.ADM.ActionsList(b))}a.plugins.ADM.refreshHumanPerspective()};var z=function(){for(x in f.selectedEntities)s(f.selectedEntities[x]);alert("Entities successfully deleted."),f.selectedEntities=new Array};this.entityPush=function(a){f.selectedEntities.push(a)},this.entityRemove=function(a){var b=new Array;for(x in f.selectedEntities){var c=f.selectedEntities[x];c!=a&&b.push(c)}f.selectedEntities=b};var A=function(){return'<div id="entity-list" class="instance-list"></div>'};this.createInstanceList=function(a,b){var c=$("<div></div>");c.html(A()),$dialog=$('<div id="'+a+'"></div>').html(c).dialog({title:b,width:360,height:400,minHeight:200,minWidth:360,buttons:[{id:"btn-delete-entity",text:"Delete selected",click:function(){z()}}]}),f.entityList=new EdenUI.plugins.ADM.EntityList;for(x in f.entities){var d=f.entities[x];f.entityList.addEntity(d.name,d.definitions.join("\n"),d.actionsArr.join("\n"))}};var B=function(a){var b=a.split(":")[1];return D(b.split("(")[0])},C=function(a){var b=a.split(":")[1].split("(")[1];return b.length>1?b.split(")")[0].split(","):[]},D=function(a){for(;32==a.charCodeAt(0)||9==a.charCodeAt(0);)a=a.substring(1,a.length);for(;32==a.charCodeAt(a.length-1)||9==a.charCodeAt(a.length-1);)a=E(a);return a},E=function(a){return a.substring(0,a.length-1)},F=function(a,b,c,e){for(x in f.templates)if(f.templates[x].name==a)return alert("Templates must have unique names."),-1;var h=g(a,e),i=new d(a,b,c,h);return f.templates.push(i),null!=f.templateList&&f.templateList.addTemplate(a,b),1},G=function(a){var b,c=a.split("\n"),d=new Array,e=new Array,f=new Array,g=!1,h=!1,i=!1;for(x in c){var j=c[x];if(j=D(j),""!=j)if(0==i)if("{"==j[0])i=!0,-1!=j.indexOf("name:")&&(b=B(j),d=C(j));else{var k=j.split("(")[0],l=j.split("(")[1].split(")")[0],m=E(D(j.split("as")[1])),n=t(k,l,m);if(-1==n)break}else if(1==g){var o=j.indexOf("}");-1!=o&&(j=E(j),g=!1),j.length>0&&e.push(j)}else if(1==h){var o=j.indexOf("}");-1!=o&&(j=E(j),h=!1),j.length>0&&f.push(j)}else if("}"==j[0]){i=!1;var n=F(b,d,e,f);if(b="",d=new Array,e=new Array,f=new Array,-1==n)return}else if(-1!=j.indexOf("name:"))b=B(j),d=C(j);else if(-1!=j.indexOf("definitions:")||-1!=j.indexOf("defs:")){if(g=!0,j=D(j),j.split("{").length>1){var p=D(j.split("{")[1]);-1!=p.indexOf("}")&&(p=E(p),g=!1),p.length>0&&e.push(p)}}else if(-1!=j.indexOf("actions:")&&(h=!0,j=D(j),j.split("{").length>1)){var p=D(j.split("{")[1]),o=p.indexOf("}");-1!=o&&(p=E(p),h=!1),p.length>0&&f.push(p)}}};this.createAdvancedInput=function(a,b){var c=document.createElement("textarea");c.style.boxSizing="border-box",c.style.width="100%",c.style.height="100%",$code_entry=$('<div id="advanced-input" class="adm-input-code" style="height: 100%"></div>'),$code_entry.append(c),$dialog=$('<div id="'+a+'"></div>').html($code_entry).dialog({title:b,width:360,height:400,minHeight:200,minWidth:360,buttons:[{id:"btn-submit-advanced",text:"Submit",click:function(){var a=c.value;G(a),c.value=""}}]}),input_dialog=$dialog,$("#btn-submit-advanced").css("margin-right","30px")},a.addViewCategory("adm","Abstract Definitive Machine"),a.views.AdmTemplateCreator={dialog:this.createTemplateCreator,title:"ADM Template Creator",category:a.viewCategories.adm},a.views.AdmInstantiator={dialog:this.createInstantiator,title:"ADM Template Instantiator",category:a.viewCategories.adm},a.views.AdmHumanPerspective={dialog:this.createHumanPerspective,title:"ADM Human Perspective",category:a.viewCategories.adm},a.views.AdmEntityList={dialog:this.createInstanceList,title:"ADM Entity List",category:a.viewCategories.adm},a.views.AdmAdvancedInput={dialog:this.createAdvancedInput,title:"ADM Advanced Input",category:a.viewCategories.adm},b()},EdenUI.plugins.ADM.TemplateList=function(){this.templateList=document.getElementById("template-menu"),this.templateList.style.minWidth="100px",this.templates=new Array},EdenUI.plugins.ADM.TemplateList.prototype.addTemplate=function(a,b){var c=new EdenUI.plugins.ADM.Template(a,b);c.element.appendTo(this.templateList),this.templates.push(c)},EdenUI.plugins.ADM.Template=function(a,b){this.template=a,this.element=$("<option value="+a+">"+a+"</option>");var c=this.showParamInput;this.element.click(function(){c(b)});var d=document.getElementById("instantiate-params");""==d.innerHTML&&c(b)},EdenUI.plugins.ADM.Template.prototype.showParamInput=function(a){var b=document.getElementById("instantiate-params");b.innerHTML="";for(x in a){var c=a[x],d=document.createElement("label");
d.innerHTML=c+":",b.appendChild(d);var e=document.createElement("input");e.type="text",b.appendChild(e);var f=document.createElement("br");b.appendChild(f)}},EdenUI.plugins.ADM.ActionsList=function(a){var b=document.getElementById("human-perspective");this.actionresults=document.createElement("div"),this.actionresults.setAttribute("id","actions_"+a),this.actionresults.innerHTML="<label><b>Actions for "+a+":</b></label>",b.appendChild(this.actionresults),this.actions=new Array,this.entityName=a},EdenUI.plugins.ADM.ActionsList.prototype.addAction=function(a,b){var c=new EdenUI.plugins.ADM.Action(a,b);c.element.appendTo(this.actionresults),this.actions.push(c)},EdenUI.plugins.ADM.ActionsList.prototype.clear=function(){this.actions=new Array,this.actionresults.innerHTML="<label><b>Actions for "+this.entityName+"</b></label>"},EdenUI.plugins.ADM.ActionsList.prototype.remove=function(){var a=document.getElementById("human-perspective");a.removeChild(document.getElementById("actions_"+this.entityName))},EdenUI.plugins.ADM.Action=function(a,b){var a=a;this.action=a,this.element=$('<div class="entitylist-element"></div>'),this.update=this.updateAction;var c=!1;this.element.hover(function(){0==c?$(this).animate({backgroundColor:"#eaeaea"},100):$(this).animate({backgroundColor:"#66CCCC"},100)},function(){0==c?$(this).animate({backgroundColor:"white"},100):$(this).animate({backgroundColor:"#6666CC"},100)}).click(function(){0==c?(edenUI.plugins.ADM.actionPush(a),$(this).css("backgroundColor","#6666CC"),c=!0):(edenUI.plugins.ADM.actionRemove(a),$(this).css("backgroundColor","white"),c=!1)}),this.update(b)},EdenUI.plugins.ADM.Action.prototype.updateAction=function(a){var b='<li class="type-function"><span class="result_name">';b=1==a?b+this.action+"</span></li>":b+this.action+" ... </span></li>",this.element.html(b)},EdenUI.plugins.ADM.EntityList=function(){this.entityList=document.getElementById("entity-list"),this.entities=new Array},EdenUI.plugins.ADM.EntityList.prototype.addEntity=function(a,b,c){var d=new EdenUI.plugins.ADM.Entity(a,b,c);d.element.appendTo(this.entityList),this.entities.push(d)},EdenUI.plugins.ADM.EntityList.prototype.removeEntity=function(a){var b;for(x in this.entities)if(this.entities[x].entity==a){b=x;break}this.entities.splice(b,1);var c=document.getElementById("element-"+a);this.entityList.removeChild(c)},EdenUI.plugins.ADM.EntityList.prototype.unselectAll=function(){for(x in this.entities)this.entities[x].unselect()},EdenUI.plugins.ADM.Entity=function(a,b,c){this.entity=a,this.element=$('<div class="entitylist-element" id=element-'+a+"></div>");var d='<li class="type-function"><span class="result_name">'+this.entity+"</span></li>";this.element.html(d);var b=b,c=c,e=!1;this.element.hover(function(){0==e?$(this).animate({backgroundColor:"#eaeaea"},100):$(this).animate({backgroundColor:"#66CCCC"},100)},function(){0==e?$(this).animate({backgroundColor:"white"},100):$(this).animate({backgroundColor:"#6666CC"},100)}).click(function(){if(this.innerHTML==d){var f=document.createElement("div");f.innerHTML="<label>Definitions:</label><br>					<textarea disabled>"+b+"</textarea><br>					<label>Actions:</label><br>					<textarea disabled>"+c+"</textarea><br>",this.appendChild(f),edenUI.plugins.ADM.entityPush(a),$(this).css("backgroundColor","#6666CC"),e=!0}else this.innerHTML=d,edenUI.plugins.ADM.entityRemove(a),$(this).css("backgroundColor","white"),e=!1})},EdenUI.plugins.ADM.Entity.prototype.unselect=function(){var a='<li class="type-function"><span class="result_name">'+this.entity+"</span></li>";this.element.html(a)},EdenUI.plugins.ADM.title="Abstract Definitive Machine",EdenUI.plugins.ADM.description="Abstract Definitive Machine",EdenUI.plugins.ADM.author="Ruth King",EdenUI.plugins.SpeechSynthesis=function(a,b){function c(){var a=window.speechSynthesis.paused;window.speechSynthesis.cancel(),a&&window.speechSynthesis.pause()}function d(a,b){if(f)return void(f=!1);var e,g=root.lookup("speak"),h=root.lookup("speakingList"),i=root.lookup("speakingIndex"),j=root.lookup("speaking"),k=root.lookup("speakingID"),l=root.lookup("speakingText"),m=root.lookup("speakingSpeech"),n=root.lookup("speakingCharIndex"),o=h.value(),p=i.value();if(c(),p||(p=1),""!=a){if("finished"==a){var q=l.value();"string"==typeof q&&n.assign(q.length+1,g)}else"interrupted"==a&&(f=!0);e=k.value(),eden.isValidIdentifier(e)&&root.lookup(e+"_status").assign(a,g)}if(b&&p++,n.assign(1,g),root.lookup("speakingTime").assign(0,g),Array.isArray(o)&&p<=o.length){j.value()||j.assign(!0,g);var r=o[p-1];if(!(r instanceof SpeakingWords)||r.cancelled)return void d("",!0);r.prepareUtterance();var s=r.utterance;e=r.id,k.assign(e,g),eden.isValidIdentifier(e)&&root.lookup(e+"_status").assign("speaking",g),l.assign(s.text,g),m.assign(r,g),b&&i.assign(p,g),r.hasBeenSpoken=!0,window.speechSynthesis.speak(s)}else j.assign(!1,g),k.assign("",g),l.assign("",g),m.assign(void 0,g),Array.isArray(o)&&i.assign(o.length+1,g)}function e(a,b){var c,d,e,f,g=window.speechSynthesis.getVoices();a&&(a=a.toLowerCase(),d=a.indexOf("-"),-1!=d?(e=a.slice(0,d),f=!0):(e=a,f=!1)),b&&(c=new RegExp("\\b"+b+"\\b","i"));for(var h=void 0,i=!1,j=!1,k=!1,l=!1,m=0;m<g.length;m++){var n=g[m],o=n.lang,p=!1,q=!1,r=!1;if(a&&o&&(o=o.toLowerCase(),a==o?(p=!0,q=!0):e==o?p=!0:(d=o.indexOf("-"),-1!=d&&o.slice(0,d)==e&&(p=!0))),b&&c.test(n.name)&&(r=!0),(!j&&!o&&!i||!j&&(!o||!a)&&n["default"]||p&&!j||f&&q&&!k||p&&!f&&n["default"]||q&&n["default"]||r&&!l&&(!a||!o&&!j||p))&&(!l||r||p&&!j)){if(i=!p,j=p,k=q,l=r,(!b||l)&&(k||j&&!f)&&n["default"])return n;h=n}}return void 0===h&&(h=g[0]),h}var f=!1;root.lookup("speakingList").addJSObserver("sendToTTS",function(a,b){var c=root.lookup("speak");if(Array.isArray(b)){var e=root.lookup("speakingIndex"),f=e.value();if(f>b.length+1)e.assign(b.length+1,c);else if(f<=b.length){for(var g=1>f?0:f-1;g<b.length;g++){var h=b[g];if(h instanceof SpeakingWords){h.prepareUtterance();var i=h.id;eden.isValidIdentifier(i)&&root.lookup(i+"_status").assign("waiting",c)}}root.lookup("speaking").value()?b[f-1]!==root.lookup("speakingSpeech").value()&&d("interrupted",!1):d("",!1)}}}),root.lookup("speakingIndex").addJSObserver("runTTS",function(a,b){if("speak"!=a.last_modified_by){var c=root.lookup("speakingList").value();if(Array.isArray(c)&&b<=c.length){root.lookup("speaking").value()?d("interrupted",!1):d("",!1);for(var e=b;e<c.length;e++)c[e]instanceof SpeakingWords&&c[e].prepareUtterance()}}}),root.lookup("speakingPaused").addJSObserver("controlTTS",function(a,b){b?window.speechSynthesis.pause():(window.speechSynthesis.resume(),window.speechSynthesis.resume())}),SpeakingWords=function(b,c,f,g,h,i,j){this.id=b,this.utterance=new window.SpeechSynthesisUtterance(String(c));var k,l,m,n,o,p,q;this.hasBeenSpoken=!1,void 0===g?(p=a.getOptionValue("speechSynthDefaultGender"),"chrome"in window&&null===p&&(p="native"),m=!0):(p=g,m=!1),this.utterance.volume=h,void 0===i?(k=a.getOptionValue("speechSynthDefaultRate"),null!==k&&(this.utterance.rate=parseFloat(k)),n=!0):(this.utterance.rate=i,n=!1),void 0===j?(k=a.getOptionValue("speechSynthDefaultPitch"),null!==k&&(this.utterance.pitch=parseFloat(k)),o=!0):(this.utterance.pitch=j,o=!1);var r=this;if(Object.defineProperty(this,"text",{get:function(){return r.utterance.text},set:function(a){r.utterance.text=a},enumerable:!0}),Object.defineProperty(this,"lang",{get:function(){return r.utterance.lang},set:function(a){if(a){var b=a.indexOf("-");-1!=b&&(a=a.slice(0,b+1)+a.slice(b+1).toUpperCase()),r.utterance.lang=a}else r.utterance.lang="";l=!1;var c=e(a,p);r.utterance.voiceURI=c.voiceURI,r.utterance.voice=c},enumerable:!0}),Object.defineProperty(this,"gender",{get:function(){return p},set:function(a){p=a,m=!1;var b=e(this.utterance.lang,p);r.utterance.voiceURI=b.voiceURI,r.utterance.voice=b},enumerable:!0}),Object.defineProperty(this,"volume",{get:function(){return r.utterance.volume},set:function(a){r.utterance.volume=a},enumerable:!0}),Object.defineProperty(this,"rate",{get:function(){return r.utterance.rate},set:function(a){r.utterance.rate=a,n=!1},enumerable:!0}),Object.defineProperty(this,"pitch",{get:function(){return r.utterance.pitch},set:function(a){r.utterance.text=a,o=!1},enumerable:!0}),Object.defineProperty(this,"cancelled",{get:function(){return q},set:function(a){q=a,q&&r.id&&root.lookup(r.id+"_status").assign("cancelled",{name:"/SpeakingWords"})},enumerable:!0}),this.toString=function(){var a="SpeakingWords("+Eden.edenCodeForValue(b)+', "'+r.utterance.text+'", ';return l?a+="@, ":a=a+'"'+r.utterance.lang+'", ',m?a+="@, ":a=a+Eden.edenCodeForValue(p)+", ",a=a+r.utterance.volume+", ",n?a+="@, ":a=a+this.utterance.rate+", ",o?a+="@)":a=a+this.utterance.pitch+")",a},void 0===f?(this.lang=a.getOptionValue("speechSynthDefaultLanguage"),l=!0):this.lang=f,eden.isValidIdentifier(b)){var s=root.lookup(b+"_status");void 0===s.value()&&s.assign("not queued",{name:"/speakingWords"})}this.prepareUtterance=function(){if(r.hasBeenSpoken&&!("chrome"in window)){var a=new window.SpeechSynthesisUtterance(r.utterance.text);a.lang=r.utterance.lang,a.volume=r.utterance.volume,a.rate=r.utterance.rate,a.pitch=r.utterance.pitch,a.voiceURI=r.utterance.voiceURI,a.voice=r.utterance.voice,a.onboundary=r.utterance.onboundary,a.onend=r.utterance.onend,a.onerror=r.utterance.onerror,r.utterance=a,r.hasBeenSpoken=!1}},this.utterance.onboundary=function(a){var b={name:"/speak"};root.lookup("speakingCharIndex").assign(a.charIndex+1,b);var c=a.elapsedTime;1e7>=c&&root.lookup("speakingTime").assign(c,b)},this.utterance.onend=function(){d("finished",!0)},this.utterance.onerror=function(){d("error",!0)}},a.eden.include("plugins/speech-synthesis/speech-synthesis.js-e",b)},EdenUI.plugins.SpeechSynthesis.title="Speech Synthesis",EdenUI.plugins.SpeechSynthesis.description="Gives JS-EDEN the ability to speak sentences out loud!";